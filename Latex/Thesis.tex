\documentclass[a4paper,12pt,oneside]{report}
\usepackage[T1]{fontenc}
\usepackage{setspace}
\usepackage[utf8]{inputenc} 
\usepackage[english]{babel}
\usepackage{url}
\usepackage{tikz}
\usepackage{ctable}
\usepackage{layaureo}
\usepackage[english]{varioref}
\usepackage{mathtools}
\usepackage{siunitx}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{microtype}
\usepackage{booktabs}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{subfig}
\usepackage{appendix}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage[autostyle,italian=guillemets]{csquotes}
\usepackage{listings,xcolor}
\DeclareMathOperator{\Tr}{Tr}
\usetikzlibrary{decorations.text}
\usetikzlibrary{arrows.meta}
\tikzset{>={Latex[width=2mm,length=2mm]}}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[R]{\thepage}
\renewcommand{\chaptermark}[1]{\markboth{#1}{#1}}
\fancyhead[L]{\scshape{\chaptername} \thechapter\ --\ \leftmark}
\newlength{\mylen}
\setbox1=\hbox{$\bullet$}\setbox2=\hbox{\tiny$\bullet$}
\setlength{\mylen}{\dimexpr0.5\ht1-0.5\ht2}
\renewcommand\labelitemi{\raisebox{\mylen}{\tiny$\bullet$}}
\onehalfspacing
%\usepackage[backend=biber,style=numeric-comp]{biblatex}
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
\DeclarePairedDelimiter{\norma}{\lVert}{\rVert}
%\addbibresource{Bibliografia.bib}
\graphicspath{{./Images/}}
\usepackage{hyperref}
\hypersetup{hidelinks}
%\pagestyle{headings}
\newcommand{\Hline}{\specialrule{.1em}{0em}{0em}}
\begin{document}
\begin{titlepage}

\begin{figure}
\centering
\includegraphics[scale=0.25]{sigillo2}
\end{figure}

\begin{center}
\LARGE{\textbf{Università degli Studi di Trento\\ Department of Industrial Engineering}}\\
\vspace{10mm}
\Large{Master Degree in\\ Mechatronics Engineering}\\
\vspace{7mm}
\uppercase{Final Dissertation}
\vspace{7mm}\\
\huge{Titolo}
\end{center}

\vspace{8mm}
\begin{flushleft}
\large{\textbf{Supervisor:}\\ Daniele Bortoluzzi}\\
\vspace{5mm}
\large{\textbf{Co-supervisor:}\\ Edoardo Dalla Ricca}\\
\vspace{5mm}
\large{\textbf{Student:}\\ Simone Manfredi 239337}\\
\end{flushleft}

\vspace{15mm}
\begin{center}
\Large{Academic Year 2023/2024}
\end{center}

\end{titlepage}

\newpage

\begin{abstract}


\end{abstract}

\newpage

\pagenumbering{roman}
\addcontentsline{toc}{chapter}{Contents}

\tableofcontents

\chapter*{Introduction}
\addcontentsline{toc}{chapter}{Introduction}
We live in a society overwhelmed by such technology, autonomous systems, industrial manipulators, AI and, very soon, services' humanoid robots, that we forget to look up in the sky. Most of the major progress in robotics and the scientific field is done in space, where human curiosity is pushing our abilities beyond any imaginable scenario.\\
This thesis was born due to my curiosity in the field of robotics merged with the need to face space and modern problems, such as the berthing and docking of external objects by a manipulator or the tumbling of a spinning satellite. This dissertation aims to analyse the dynamic of a space manipulator after the impact with an external satellite/meteorite to retrieve its kinetic properties before the impact.\\
\clearpage
\pagenumbering{arabic}
\chapter{Space Manipulators: an Overview}
Space Robotics is important to human's overall ability to explore or operate in space. Autonomous systems can reduce the cognitive load on humans and improve human and systems' safety.\\
Space robots can be split into two main categories: orbital robots and planetary robots. The formers can be used for repairing satellites, assembling large space telescopes, capturing and returning asteroids, etc; the latter play a key role in surveying, observations, extraction, working on planetary surfaces for subsequential human arrival, etc.\\
Furthermore, spacecraft are classified as space robots when two attributes are satisfied: locomotion and autonomy. Depending on its application, a space robot is designed to possess locomotion to manipulate, grip, rove, drill and/or sample; at the same time, it is expected to possess varying levels of autonomy, ranging from teleoperation by humans to fully autonomous operation by the robot itself [3].\\
Another classification of robotic devices in space could be represented by mobile robots, flying robots, and manipulators. Manipulators are used on board spacecraft (Space Shuttle) or space stations [5].
According to [1], a very loose definition calls every unmanned space probe a robotic spacecraft, referring to the challenges of largely autonomous operation in a complex mission. But even discarding this and focussing on space robotics elements in a more narrow sense (systems involving arms for manipulation or some kind of locomotion device for mobility and having the flexibility to perform varying tasks), there is a wide array of uses in the scope of space missions, giving rise to challenging problems and ingenious solution.\\
Robots and manipulators in space are designed to perform the following operations:
\begin{itemize}
\item capture
\item maneuvring
\item berthing/unberthing
\item support of Extra-Vehicular-Activities (EVA)
\item positioning and release
\end{itemize}
One of the most important features of all robots deployed in space is their flexibility. Robots and manipulators used in space are built out of light materials, and very often, their links deflect.\\
There are quite a number of on-orbit applications requiring advanced robotics capabilities, which
are envisaged to take place in the 2025-2035 timeframe. The operators for these missions may
range from space administrations to national governments to businesses. The following mission
foci are envisaged: space debris removal, rescue mission, planned orbit raising,
inspection/support to deployment, deployment/assembly aid, repair, refuelling and orbit
maintenance, mission evolution/adaptation, lifetime extension, and re/de-orbiting. The
International Space Station (ISS) continues to represent an excellent opportunity for scientific
experiments to be conducted in space amid the unique characteristics, constraints and pressures that the environment brings [3].\\
But what is so special about a space robot? In many ways, robot systems for space applications are very different from the more familiar terrestrial robots, be they industrial robots in production automation or the newer kind of "service robots". One of the main and simplest differences is the high development and manufacturing costs and the missing "economy of scale" due to the experimental prototype nature of these developments.\\
This thesis will investigate space manipulators' dynamics, whose tasks involve berthing and docking satellites or managing tumbling meteorites; thus, a historical summary of their evolution and the actual state-of-art of this field will be briefly exposed.
\newpage
\section{Historical background}
The first robot used in space was the Remote Manipulator System (RMS), also called \textit{Canadarm}, developed by the Canadian Space Agency and mounted on the Space Shuttle. This robot was used for the first time on 12th November 1981 in the Columbia Shuttle and it was retired in July 2011. It is 15 meters long and has three hinged joints for pitch and three others for yaw and roll, which makes a total of six degrees of freedom (DOF).\\
There were numerous problems related to the use of the RMS in space. One of the most important was related to its positioning: since it is built out of light materials to minimise the launch cost, its links deflect substantially. When the arm is accelerated and stopped, large vibrations occur.\\
There are two main methods of improving the positioning accuracy of the RMS: passive and active. The passive methods focus on redesigning the manipulator and applying different materials. The active ones refer to a preshape input and to the usage of position, velocity or force feedback.\\
Eventually, some lessons have been learnt during the RMS' lifetime: the speed of manipulation should be drastically improved; the positioning accuracy is one of the most important issues in day-to-day operations; the new manipulators should be designed to include passive vibration control capabilities; active vibration control should be added in order to improve the positioning accuracy and shorten the settling time; the force loop could add significantly to the capabilities of the manipulator [5].\\
It is interesting to note that the actuators are not powerful enough to lift even the weight of the arm itself when on Earth. The Canadarm has been used for over 100 operations and is normally used for repairing, retrieving, and deploying satellites; assisting humans during extravehicular activi- ties; and for remote inspection tasks [6].\\
Another early mission including a robotic arm in space was the MIR space station. This Soviet Union/Russian space station was the first modular space station and was in operation from 1986 to 2001. MIR was a microgravity research laboratory which conducted research in biology, astronomy, meteorology, and physics, to name a few. Four of the modules were equipped with the Lyappa robotic arm used for assembling the modules of the space station.\\
In 1997 the National Space Development Agency of Japan (NASDA) launched the Engineering Test Satellite No. 7 (ETS-VII), the first ever satellite to be equipped with a robotic arm. The ETS-VII performed several successful docking operations using the manipulator arm. The main objectives of the project were performance evaluation of a satellite-mounted robotic system; coordinated control of the satellite attitude and robot arm; teleoperation of the robot arm; demonstration of in-orbit satellite servicing.\\
The project demonstrated the successful execution of experiments which gained insight into operations such as docking, fuel transfer, assembling, and berthing. Several successful docking operations were performed with the chaser and target satellite.\\
The Japanese also developed a robotic arm which was mounted on the Japanese Experiment Module at the International Space Station (ISS), the JEMRMS, in March 2008. The Small Fine Arm (SFA) was added in July 2009 (see Section~\ref{state_of_art}).\\
A larger and more advanced version of the SRMS arm is the MSS arm (Mobile Servicing System), which is mounted on the International Space Station. The MSS arm consists of a mobile base, a more advanced version of the Canadarm, called the \textit{Canadarm2}, or SSRMS, and dexterous manipulator hand [6]. It has seven DOF, unlike the RMS, making it a redundant manipulator to avoid singularities in some specific but important positions. Its properties will be discussed in the next Section. [5]\\
In March 2008 the last part of the Mobile Servicing System was added to the International Space Station. The Canada Hand, or the Special Purpose Dexterous Manipulator (SPDM), is a two-armed robot but is often referred to as a hand be- cause it can be attached to the Canadarm2 robotic arm and taken to any location on the space station [6].\\
The last manipulator in space was launched in July 2021: the Europian Robotic Arm (ERA) serves as main manipulator on the Russian part of the Space Station.\\
Clearly, the usage of manipulator in space involves recent activities, hence a lot of research and experiments are still in development. This research field offers numerous starting points in analysis and technologic progress.
\newpage
\section{Main characteristics}
Orbiting robotic systems consist of a free-floating base, typically a satellite or a space station, with a robotic manipulator attached to it.\\
The main difference between space manipulators and Earth-based robots is the lack of a fixed base on which the robot is mounted.\\
Depending on whether or not actuation is utilized to control the spacecraft position and orientation, we can divide these systems into \textit{free-flying} and \textit{free-floating} space manipulators. \\
In a free-flying robotic system the position and orientation of the base, in this case the spacecraft, is actively controlled by the spacecraft’s actuators. This allows to completely control both the base configuration and the manipulator arm.\\ 
Due to the dynamic coupling between the manipulator and the spacecraft, the motion of the manipulator arm will constantly affect the motion of the base. The main concern with these systems is therefore the excessive fuel consumption required to compensate for the dynamic coupling between the manipulator and the base while maintaining a constant base attitude [6].\\
This mode is employed during the final approach of a manipulator to its target, so that the target is within the manipulator workspace [2].\\
A free-floating robotic system, on the other hand, does not use spacecraft actuation to compensate for the manipulator motion. The spacecraft motion is therefore not controlled directly, but arises as a result of the dynamic coupling between the manipulator and the base. In this case one can either choose not to control the spacecraft motion at all, or to use the manipulator arm to obtain the required motion also for the spacecraft. In many cases it is necessary to generate a manipulator motion which guarantees that the spacecraft orientation remains almost constant so that antennas and other instruments point in the right direction [6].\\
In this mode, the spacecraft attitude is controlled actively with momentum control devices (MCD), such as reaction wheels or momentum gyros, while the system CoM does not translate. The free-floating or the partial free-floating modes are preferred during grasping, since they eliminate sudden motions due to thrusters, and conserve propellant and power [2].\\
Even though space exploration is challenging compared to Earth-based systems, space manipulator design also benefits from the free-fall environment in some areas. It is, for example, possible to construct robots with extremely high redundancy and with several joints. This type of robots, are able to support their own weight in space due to the small gravitational forces. On Earth, however, such robots would collapse due to their own weight when the number of joints becomes too large. This allows for more redundant robots in space than on Earth, and also more fault tolerant robots because the robots can continue operation even after several joint failures. Similarly, the free-fall environment allows for effective control with very small actuators. In fact, most space manipulators are able to handle very high payloads in space, while they cannot even withstand the weight of the manipulator arm itself if they were to be placed in the Earth’s gravity field [6].\\
\textcolor{red}{WHICH ONES ARE CONSIDERED IN THIS WORK?}\\

To execute on-orbit tasks being inaccessible to, or too dangerous for humans, robotic on-orbit servicing (OOS) can be employed, with tasks to be performed by space manipulator systems (SMSs), also called chasers or servicers in the literature. An SMS consists of a satellite base equipped with one or more robotic manipulators (arms) with grappling devices on them and driven by a vision system which allows them to capture a target (client) satellite, or another object. An SMS also can be a large servicing manipulator mounted on a space facility.\\
Targets for capture may be cooperative, i.e., a stable and safe target due to its operational Attitude and Orbit Control Subsystem (AOCS), or non-cooperative i.e., an unknown or tumbling target with a varying axis of rotation. They can also be collaborative, i.e., designed for capture or servicing, equipped with visual markers and grapple fixtures, or non-collaborative, as most of today’s satellites. In many cases in the literature, the term cooperative stands for collaborative, too.
As often revealed by ground observations, many on-orbit objects are tumbling in an uncontrolled way (non-cooperative targets), making the robotic capture a very challenging task. This is the case analysed in this thesis.\\
Clearly, only after a manipulator has successfully captured and stabilized a tumbling target, can a service operation be started. Therefore, a common robotic capture task for on-orbit servicing consists of four operational phases: 
\begin{enumerate}
  \item observation and planning phase;
  \item final approach phase;
  \item impact and grasping/capture phase;
  \item post-capture stabilization phase.
\end{enumerate}
\textcolor{red}{WHICH ONES ARE CONSIDERED IN THIS WORK?}\\
With a target locally stationary, the approach phase can be achieved by point-to-point planning and depending on the actuation mode, by simple on-off thruster control, and attitude fine-tuning using momentum exchange devices. Capturing a tumbling, non-cooperative target is more challenging, as here velocity matching between the SMS end-effector and the capture point is required.\\
In fact, to avoid impacts during the grasping phase, the difference between the velocities of the target and the end-effector should be zero. In practise, this never happens, thus small impacts and vibrations have to be taken into account. Research on this topic is still going on, some focusing on bio-inspired isolation systems ([2018], [2020]).\\
In deploying a SMS for target capture, a manipulator trajectory is needed to achieve the goal. Several secondary optimization goals, such as obstacle and singularities avoidance, fuel consumption, and base disturbance minimization [1999] can be sought, too. E.g. [2009] focuses on the optimal time needed to reach the target [2].
\newpage
\section{State-of-art}\label{state_of_art}
The Low Earth Orbit (LEO), a whole band of orbits between 300 and 700 km altitude, is the main of today's manned space missions. This class belongs to the US Skylab, the Space Shuttle, the Russian Space Station Mir, and the International Space Station (ISS). The orbits are just high enough to be practically free of destabilising dynamic disturbances but as low as possible to minimise launch costs.\\
Apart from human physiology interest (to investigate the effects of weightlessness on astronauts), the main application field has always been a microgravity research. The term "microgravity" refers to the typical level of "weightlessness" on such manned missions: due to various disturbances (remaining atmospheric drag, moving machinery, but most of all man motion), some 10e-6 g acceleration will continue to act on every mass [1].\\
Nowadays, as already mentioned, on the ISS there are three main SMSs:
\begin{enumerate}
  \item SSRMS: Space Station Remote Manipulator System
  \item SPDM: Special Purpose Dexterous Manipulator
  \item JEMRMS: Japanese Experiment Module Remote Manipulator System
  \item ERA: European Robotic Arm
\end{enumerate}
The ISS assembly, maintenance and scientific research tasks depend on the three robotic manipulators carrying out their intended operations. Each manipulator has a specific purpose and each has been designed to successfully complete its assigned mission.\\
All three ISS robotic manipulators are designed to resemble the human arm. They are mechanically and electrically connected to the ISS at the shoulder, which is comprised of a set of revolute mechanical joints. A boom segment and then an elbow joint follow the shoulder. After the elbow there is another boom segment followed by a set of wrist joints and an end effector through which the operational grappling is carried out.[2]
\subsection{SSRMS}
The SSRMS, or Canadarm2, is primarily used for ISS assembly. This involves acquiring an assembly payload, either directly from the Shuttle Payload Bay or handed off from the Shuttle Remote Manipulator System (SRMS). The SSRMS is also used to manoeuvre astronauts and whatever they are holding from point to point as they complete their tasks during the EVA.\\
The 16.9m SSRMS has 7 offset joints and is symmetric about the elbow with identical 3DOF shoulder and wrist clusters (Figure \ref{SSRMS_dim}). The shoulder/wrist clusters contain three mechanical joints with perpendicular rotation axes: pitch, yaw and roll. One joint cluster acts as the shoulder while the other acts as the wrist of the manipulator. All of the SSRMS joints are functionally identical with the same performance capabilities and angular range of $\pm 270$ degrees. \\
The three pitch and two roll joints are identical and interchangeable. The two yaw joints are identical and interchangeable (the difference between the yaw and pitch/roll joints being that the yaw joints have a 5.25 inch extension non one end). Each of the joints is an ORU and each contains two identical joint electronics units and motor modules.\\
Attached to the roll joint on each cluster is a Latching End Effector (LEE) which provides a mechanical and electrical connection to a payload, SPDM or the ISS when grappling an SSRMS grapple fixture. In this way, it is possible for the robotic arm to move around the station's exterior. Each LEE also includes a Force Moment Sensor (FMS) and two identical LEE Electronics Units (LEUs). This symmetric configuration allows either end of the SSRMS to be attached to a Power and Data Grapple Fixture (PDGF) and to function as the base of the arm.\\
\begin{figure}[t]
  \centering
  \includegraphics[scale=0.3]{SSRMS_dimensions.png}
  \caption{SSRMS Dimensions [4].}
  \label{SSRMS_dim}
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.4]{SSRMS_orbit.png}
  \caption{The SSRMS on orbit [7].}
  \label{SSRMS_orbit}
\end{figure}
\subsection{SPDM}
The SPD is a highly dexterous dual-armed robot, with two shoulders that provide support for the arms.\\
Each arm has seven joints, terminating with an Orbit Replacement Unit/Tool Changeout Mechanism (OTCM), the mechanism through which the SPDM arm interfaces with payloads and tools. The SPDM is also equipped with lights, video equipment, a tool platform and four tool holders.\\
The SPDM's primary role is to carry out delicate maintenance and servicing tasks on the International Space Station. Tasks include installing and removing small payloads such as batteries, power supplies and computers; operate robotic tools such as specialized wrenches and socket extensions; provide power and data connectivity to payloads; manipulate, install, remove and inspect scientific payloads.\\
It works near the Canadarm2 and can be grapped by it to be moved around.\\
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.6]{SPDM.png}
  \caption{The SPDM on orbit.}
  \label{SPDM_orbit}
\end{figure}
\subsection{JEMRMS}
The JEMRMS system is used primarily for experiment payload handling. It consists of three major subsystems, the
Console, Main Arm (MA), and Small Fine Arm (SFA).\\
The Main Arm (MA) is a 10m, six-degree-of-freedom robot arm. It consists of three booms, six joints, an end effector on the tip, and two vision systems (one on the shoulder, the other on the tip).\\
The Small Fine Arm (SFA) is also asix-degree-of-freedom robot arm. It can perform more dexterous tasks than the MA. During operation, the SFA is grappled by the MA and receives power and data from the MA. The 2m SFA consists of two booms, six joints, and an end effector on the tip called the “tool,” and a camera on the tool. The tool has a force and torque sensor inside it for compliance operation [8].\\
\begin{figure}[h]
  \centering
  \subfloat[][\emph{Main Arm (MA).}]
  {\includegraphics[scale=0.35]{MA.png}\label{unitary}} \quad
\subfloat[][\emph{Small Fine Arm (SFA).}]
  {\includegraphics[scale=0.35]{SFA.png}\label{normal}} 
  \caption{The JEMRMS components. [8]}
  \label{JEMRMS_components}
\end{figure}
The JEM RMS end effector was designed based on the Shuttle RMS (SRMS) end effector. The grapple fixtures compatible with the JEMRMS MA can also be grappled by the SSRMS [4].\\
\subsection{ERA}
The ERA is used on the Russian segment (RS) of the ISS. Specific tasks for the ERA include: installing, removing or replacing experiment payloads
and large Station elements; transferring small payloads in and out of the Station through the Russian airlock; transporting crew members from one external working site
to another; freeing cosmonauts to do other work during spacewalks; using its cameras to inspect the outside of the Space Station.
The ERA manipulator arm spans 11.3m and has 7 inline joints in a symmetric configuration with respect to the elbowjoint (Figure 2). It has a shoulder with 3 DOFs, an elbow with 1 DOF and a wrist with 3 DOFs. Both the shoulder andwrist contain three functionally identical joints with mutually perpendicular rotation axes.\\
The ERA has two end effectors (EE) which can act as a base, enabling either end of the ERA to be used as the shoulder. Thus the wrist and shoulder are operationally interchangeable, just as in the SSRMS design. The identical EE’s are able to grapple and ungrapple an ERA grapple fixture, transferring power or data to an external device/load. The EE also has an Integrated Service Tool (IST) which is a built-in motorized "screwdriver" that can provide mechanical torque
actuation.\\
The ERA is equipped with four Camera and Lighting Units (CLU) one on each EE and one on either side of the elbow. The CLU will be used to provide video images of operational tasks and, if necessary, to illuminate the scene and to act as an optical sensor to enable proximity control of a target during approach of a basepoint or grapple fixture in closed loop. The proximity control function enables ERA to approach grapple fixtures automatically and smoothly [4].
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.45]{ERA.png}
  \caption{ERA's components.} \label{ERA}
\end{figure}
\subsection{RMSs Comparison}
To conlcude, The 7DOF design of the European and Canadian arms provide an extra degree of freedom that will enable both manipulators to access tight workspaces and avoid ISS structure during operations. This is particularly important when working in areas that have exposed station structure. The 7th DOF also allows for Arm Pitch Plane Change manoeuvres to avoid structure without changing the end effector position.\\
The maximum handling payloads the manipulators can capacity also dictates the type of grasp. The SSRMS is capable of handling payloads that have an equivalent mass to the Orbiter. The ERA is designed for slightly smaller payloads such as solar panels.\\
The ERA and the JEMRMS provide much finer position accuracy than the SSRMS: smaller payloads require more precise alignment. Also, the force moment sensor is always used for ERA and JEM operations and is optional for SSRMS operations. This FMS capability facilitates “peg in the hole” type of operations.
In the Table \ref{SRMs_comparison} the specifications of the SSRMS, ERA and JEMRMS are reported [4].
% \begin{table}[h]
%   \caption{SSRMS, ERA and JEMRMS specifications [4].}
%   \label{SRMs_comparison}
%   \begin{center}
%   \begin{tabular}{|l|c|c|c|}
%   \hline
%   & \textbf{SSRMS} & \textbf{ERA} & \textbf{JEMRMS (MA)}\\
%   \hline
%   Span&\SI{14.22}{\metre}&\SI{11.3}{\metre}&\SI{9.91}{\metre}\\
%   \hline
%   Boom Span&\SI{7.11}{\metre}&\SI{7.77}{\metre}&\SI{3.93}{\metre}\\
%   \hline
%   DOFs&7&7&6\\
%   \hline
%   Joints&Offset&Inline&Offset\\
%   \hline
%   Base&Relocatable&Relocatable&Fixed\\
%   \hline
%   Positioning Accuracy&\SI{65}{\milli\metre}, \SI{0.71}{\degree}&\SI{40}{\milli\metre}, \SI{1}{\degree}&\SI{50}{\milli\metre}, \SI{1.8}{\degree}\\
%   \hline
%   Mass&\SI{1336}{\kilogram}&\SI{630}{\kilogram}&\SI{757}{\kilogram}\\
%   \hline
%   Max Handling Capacity&\SI{116}{\mega\gram}&\SI{8}{\mega\gram}&\SI{7}{\mega\gram}\\\hline

%   Power Consumption&\SI{1360}{\watt} (average)&>\SI{800}{\watt}&\SI{2.3}{\kilo\watt}\\
%   \hline
%   \end{tabular}
%   \end{center}
%   \end{table}

  \begin{table}[h]
    \caption{SSRMS, ERA and JEMRMS specifications [4].}
    \label{SRMs_comparison}
    \begin{center}
    \begin{tabular}{lccc}
      \toprule
    & \textbf{SSRMS} & \textbf{ERA} & \textbf{JEMRMS (MA)}\\
    \midrule
    Span&\SI{14.22}{\metre}&\SI{11.3}{\metre}&\SI{9.91}{\metre}\\
    Boom Span&\SI{7.11}{\metre}&\SI{7.77}{\metre}&\SI{3.93}{\metre}\\
    DOFs&7&7&6\\
    Joints&Offset&Inline&Offset\\
    Base&Relocatable&Relocatable&Fixed\\
    Positioning Accuracy&\SI{65}{\milli\metre}, \SI{0.71}{\degree}&\SI{40}{\milli\metre}, \SI{1}{\degree}&\SI{50}{\milli\metre}, \SI{1.8}{\degree}\\
    Mass&\SI{1336}{\kilogram}&\SI{630}{\kilogram}&\SI{757}{\kilogram}\\
    Max Handling Capacity&\SI{116}{\mega\gram}&\SI{8}{\mega\gram}&\SI{7}{\mega\gram}\\
    Power Consumption&\SI{1360}{\watt} (average)&>\SI{800}{\watt}&\SI{2.3}{\kilo\watt}\\
    \bottomrule
    \end{tabular}
    \end{center}
    \end{table}

\chapter{Kinematics}\label{kinematics}
What is a robot, then? In the previous chapter we have seen an overview of the actual reality of the space robotics field, but a proper definition of a what a robot is has not been given. A robot is a re-programmable machine for manipulation, positioning, orientation, machining of bodies able to interact with the environment, with a certain level of autonomy.\\
A robot is not just an automated machine, it is something more: takes decisions autonomously, can do different things at different times, is flexible.\\
According to [11] there are two main families of robots:
\begin{itemize}
  \item serial robots: a set of bodies rigidally connected by joints in an open kinematic chain.
  \item parallel robots: a set of bodies connected in a closed kinematic chain. They can withstand/produce a larger force.
\end{itemize}
A kinematic chain is therefore the concatenation of single degree of freedom (i.e. the minimum amount of indipendent coordinates that define the configuration of the robot) links. The joints can be revolute, prismatic or spherical, depending on the movement allowed by them (plane rotational, translational or 3D rotatonal respectively).\\
Grubler equation for palanar mechanisms gives the overall DoFs of a multibody system:
\begin{equation}
  n = 3(m-1)-2c_1-c_2
  \label{grubler}
\end{equation}
where $m$ is the number of rigid bodies attached to the base, $c_1$ and $c_2$ are class 1 and class 2 joints respectively, depending on how many DoFs do they allow (one or two). Revolute joints allows one DoF, i.e. rotation around their axes.\\
Whenever $n<n_j$, where $n_J$ is the number of joints, a redundancy occurs, meaning that the system has more joints than the dimension of the task space [11].\\
A very important definition for serial robots is the end defector (EE), i.e the point of the chain dedicated to the programmed task, as shown in Figure \ref{end_defector} in red.\\
Studying the kinematics of a mechanical system (such as a robot) refers to the calculation of the position and orientation of its end-eﬀector frame from its joint coordinates [11].\\
\begin{figure}[!]
  \centering
  \input{tikz/EE.tikz}
  \caption{2D RR (revolute-revolute) manipulator.}
  \label{end_defector}
\end{figure}
We will now analyze the forward kinematics of a manipulator mounted on top of a mobile base, to form a vehicle-manipulator system (VMS) that can be controlled as a whole.\\
Starting from a simple model of the VMS, it will be possible to analyze its behaviour before and after the impact with an external object (i.e. meteorite or satellite).
\newpage
\section{Fundamental of Kinematics}\label{Homogeneous}
In this thesis, the kinematics chain have been evaluated by means of the "Homogeneous Matrix Approach" shown in [9,10]. For such approach, a briefly summary of notation is here presented.
\subsection{Roto-Translation Matrix}
Given two vectors in an $xy$ plane, only rotated without distortion, as in Figure~\ref{rotation_vectors}, the relationship between them can be found in the following way:
\begin{equation}
  v_2=\begin{bmatrix}
    v_{x_2}\\
    v_{y_2}
  \end{bmatrix}=\begin{bmatrix}
    v_{x_1}\cos{\theta}-v_{y_1}\sin{\theta}\\
    v_{x_1}\sin{\theta}+v_{y_1}\cos{\theta}
  \end{bmatrix}=\begin{bmatrix}
    \cos{\theta} & -\sin{\theta}\\
    \sin{\theta} & \cos{\theta}
  \end{bmatrix}\begin{bmatrix}
    v_{x_1}\\
    v_{y_1}
  \end{bmatrix}=R(\theta)v_1
  \label{rotation_matrix}
\end{equation}
\begin{figure}[h]
  \centering
  \input{tikz/rotation_vectors.tikz}
  \caption{Vecors $v_2$ is rotate by $\theta$ withh respect to $v_1$.}
  \label{rotation_vectors}
\end{figure}
where $R_{\theta}$ is the rotation matrix.\\
We can use the same matrix to describe another transformation, i.e. to find the coordinated of a point initially defined with respect to a mobile frame, with respect to another frame, such as a fixed one (Figure~\ref{rotation_point}):
\begin{equation}
  \prescript{f}{}{P}=\prescript{f}{m}{R(\theta)}\prescript{m}{}{P}
\end{equation}
\begin{figure}[h]
  \centering
  \input{tikz/rotation_point.tikz}
  \caption{The same point can be described with respect to both a fixed and a rotated mobile frame (in red).}
  \label{rotation_point}
\end{figure}
The notation used here is the following: the left superscript indicates the reference frame in which the point or the vector is referred to: $\prescript{m}{}{P}$ referes to the point $P$ with coordinate written with respect to the mobile frame. The matrix $\prescript{f}{m}{R(\theta)}$ "translates" a point described in the mobile frame to the fixed frame.\\
An important property of the rotation matrix is that it is orthogonal, hence its inverse is equal to its transpose.\\
We can concatenate the rotational matrices such that we can describe a point in a given reference frame to another one if we know all the relative rotational matrices of the frames between the two we are interested in:
\begin{equation}
  \prescript{0}{}{P}=\prescript{0}{1}{R(\theta)}\prescript{1}{2}{R(\theta)}\prescript{2}{}{P}
  \label{concatenate}
\end{equation}
This concept can be expanded easily in the 3D case, noticing that the columns of $R(\theta)$ in (\ref{rotation_matrix}) are the unit vectors of the moving (new) frame written in the fixed (old) frame. In this way, rotation matrices along the x, y and z axis are found [6]:
\begin{equation}
  \begin{array}{c}
  R_x(\phi)=\begin{bmatrix}
    1&0&0\\
    0&\cos{\phi}&-\sin{\phi}\\
    0&\sin{\phi}&\cos{\phi}
  \end{bmatrix} \quad R_y(\psi)=\begin{bmatrix}
    \cos{\psi}&0&\sin{\psi}\\
    0&1&0\\
    -\sin{\psi}&0&\cos{\psi}
  \end{bmatrix} \\
  R_z(\theta)=\begin{bmatrix}
    \cos{\theta}&-\sin{\theta}&0\\
    \sin{\theta}&\cos{\theta}&0\\
    0&0&1
  \end{bmatrix} 
\end{array}
\label{rotation_matrices}
\end{equation}
When a translation occurs, as shown in Figure~\ref{translation}, the transformation becomes:
\begin{equation}
  \prescript{f}{}{\{O_fP\}}=\prescript{f}{}{\{O_fO_m\}}+\prescript{f}{}{\{O_mP\}}=\prescript{f}{}{\{O_fO_m\}}+\prescript{m}{f}{R}\prescript{m}{}{\{O_mP\}}
\end{equation}
which can be written as follows:
\begin{equation}
  \prescript{f}{}{\begin{bmatrix}
    O_fP_x\\
    O_fP_y\\
    O_fP_z\\
    1
  \end{bmatrix}}=\begin{bmatrix}
    \prescript{f}{m}{R}&\prescript{f}{}{\begin{bmatrix}
      O_fO_mx\\
      O_fO_my\\
      O_fO_mz\\
    \end{bmatrix}}\\
    \mathbf{0}&1
  \end{bmatrix}\prescript{m}{}{\begin{bmatrix}
      O_mP_x\\
      O_mP_y\\
      O_mP_z\\
      1
    \end{bmatrix}}=\prescript{f}{m}{M}\prescript{m}{}{\begin{bmatrix}
      O_mP_x\\
      O_mP_y\\
      O_mP_z\\
      1
    \end{bmatrix}}
\label{roto_translation}
\end{equation}
where $\mathbf{0} \in \mathbb{R}^{3\times1}$ and $\prescript{m}{f}{M} \in \mathbb{R}^{4\times4}$ is called the \textit{Roto-Translational Matrix} or \textit{Homogeneous Transformation Matrix}, for which the same properties seen in equation~(\ref{concatenate}) hold. A fourth component has been appended at the end of the vectors, which is 1, since the Homogeneous Matrix would have had three rows but four columns otherwise. In this way it is squared and invertible, and $\prescript{0}{1}{M}^{-1}=\prescript{1}{0}{M}$.
\begin{figure}[h]
  \centering
  \input{tikz/translation_point.tikz}
  \caption{Definition of a point in a rotated and translated frame with respect to the fixed one. The position of $P$ with respect to the fixed frame (red arrow) can be seen as the sum of the position of the moving frame $O_m$ with respect of $O_f$ and the relative position of $P$ in the moving frame, both in blue.}
  \label{translation}
\end{figure}
\subsection{Velocity Matrix}\label{velocity_section}
Given the same point in Figure~\ref{translation} is is possible to find the velocity of the point with respect to the fixed frame. By derivation of equation (\ref{roto_translation}) one can get:
\begin{equation}
  \prescript{f}{}{\{\dot{O_fP}\}}=\prescript{f}{m}{\dot{M}}\prescript{m}{}{\{O_mP\}}+\prescript{f}{m}{M}\prescript{m}{}{\{\dot{O_mP}\}}
\end{equation}
and since $\prescript{m}{}{\{\dot{O_mP}\}}=0$, assuming the point fixed in the mobile frame, and $\prescript{m}{}{\{O_mP\}}=\prescript{m}{f}{M}\prescript{f}{}{\{O_fP\}}$:
\begin{equation}
  \prescript{f}{}{\{\dot{O_fP}\}}=\prescript{f}{m}{\dot{M}}\prescript{m}{f}{M}\prescript{f}{}{\{O_fP\}}=\prescript{f}{}{W}\prescript{f}{}{\{O_fP\}}
  \label{velocity_matrix}
\end{equation}
with $\prescript{f}{}{W}$ the \textit{Velocity Matrix}.\\
The Velocity Matrix can be generalized as follows [9]:
\begin{equation}
  W=\begin{bmatrix}
    0&-\omega_z&\omega_y&v_x\\
    \omega_z&0&-\omega_x&v_y\\
    -\omega_y&\omega_x&0&v_z\\
    0&0&0&0
  \end{bmatrix}
\end{equation}
where $\omega$ indicates the angular velocity of the body and $v$ is the velocity of the point, considered belonging to the body that in a considered instant is passing through the origin of the reference frame.\\
The composition of the Velocity Matrix follows the Rival's Theorem (see Figure~\ref{rival}):
\begin{equation}
  \prescript{n}{}{W_{02}}=\prescript{n}{}{W_{01}}+\prescript{n}{}{W_{12}}
  \label{composition}
\end{equation}
\begin{figure}[h]
  \centering
  \input{tikz/rivals_theorem.tikz}
  \caption{Rival's Theorem for velocities composition. The three transformation $W_{01}$, $W_{12}$ and $W_{02}$ are also called \textit{Drag Motion}, \textit{Relative Motion} and \textit{Absolute Motion} respectively.}
  \label{rival}
\end{figure}
which is true only when all the matrices are projected in the same frame $n$.\\
The notation used in equation (\ref{composition}) has to be read in the following way: $\prescript{n}{}{W}_{02}$ is the Velocity Matrix of frame two with respect to frame zero, projected in frame $n$.\\
Is is also possible to change the frame in which the matrix is projected:
\begin{equation}
  \prescript{m}{}{W}=\prescript{m}{n}{M}\prescript{n}{}{W}\prescript{n}{m}{M}
  \label{change_frame}
\end{equation}

Some attention must be given also to the matrix representing a "boolean" interpretation of the rotation: the $L$ matrix. For the aim of this thesis, and as it is introduced in [10], this matrix can be easily obtained from its Velocity Matrix dividing it by the module of its angular (or linear, when there is translation) velocity:
\begin{equation}
  L=\frac{W}{|\omega|}
  \label{L_matrix}
\end{equation}
where $|\omega|=\sqrt{\omega_x^2+\omega_y^2+\omega_z^2}$.\\
Given the robotic focus of this work, these calculations will be quite straightforward once defined the axis of rotation of a link. For a revolute joint, for example, the Velocity Matrix with respect of the joint frame will be:
\begin{equation}
  W=\begin{bmatrix}
    0&-\dot{\alpha}&0&0\\
    \dot{\alpha}&0&0&0\\
    0&0&0&0\\
    0&0&0&0
  \end{bmatrix}
\end{equation}
with $\dot{\alpha}=\omega_z$, and the "logic" of the rotation is thus given by $L$:
\begin{equation}
  L=\frac{W}{\dot{\alpha}}=\begin{bmatrix}
    0&1&0&0\\
    1&0&0&0\\
    0&0&0&0\\
    0&0&0&0
  \end{bmatrix}
  \label{L_matrix}
\end{equation}
\subsection{Danavit-Hartenberg Method}
To define the reference frames fixed to the links of a serial manipulator, one can follow the Danavit-Hartenberg algorithm, which guarantees a coherent and functional mehod through all the calculations. It has been thought for robots with revolute joints.\\
It follows this ordered procedures:
\begin{enumerate}
  \item $z_i$ axis: axis of the revolute joint which connects the link to the following.
  \item $x_i$ axis: line of minimum distance between $z_{i-1}$ and $z_i$, oriented from $z_{i-1}$ to $z_i$.
  \item $y_i$ axis: obtained by the vectorial product of the other two axes.
\end{enumerate}
In Figure~\ref{DH}, a DH convention for a planar serial manipulator has been used for configuration shown in Figure~\ref{end_defector}.
\begin{figure}[h]
  \centering
  \input{tikz/DH.tikz}
  \caption{The Danavit-Hartenberg rule has been used to place the local joints' frame (in red) in a planar RR manipulator, with arms length $l_1$ and $l_2$, mounted on top of a disk-shaped base (in green). The rotated frame of the base of the angle $\theta_o$ has been plotted in blue. Following the hand rule, the z axis is orthogonal to the plane.}
  \label{DH}
\end{figure}
\subsection{Jacobian Matrix}
Another important matrix in the analysis if a manipulator is the so called \textit{Jacobian Matrix}.\\
To study the direct kinematics of a manipulator, as already said, means to find the relationship between the end-defector position and orientation and its joints. When writing the position of the EE (denoted by S), we obtain a function of the robot's joints:
\begin{equation}
  S=f(q_1,q_2,\dots,q_n)
  \label{EE_position}
\end{equation}
where $q_i$ are the manipulators DoFs.\\
By derivation of (\ref{EE_position}) one can obtain:
\begin{equation}
  \dot{S}=J_a\dot{Q}
\end{equation}
where $J_a$ is the \textit{Analytical Jacobian Matrix} and $Q=\{q_1,q_2,\dots,q_n\}$.\\
Its dimension are very important, since kinematic singularities, which are configurations in which the end-eﬀector frame loses the ability to move or rotate in one or more directions, correspond to those configurations at which the Jacobian matrix fails to have maximal rank [11], where the rank is defined as the number of indipendent rows or couloumn of the matrix.\\
Singularities happen if the open-chain robot is kinematically redundant, meaning, as already mentioned, that it has more joints than the dimension of the task space; then the inverse of the jacobian doesn't exist anymore, since the inversion requires a squared full rank matrix. When this occurs, the pseudoinverse or \textit{Moore-Penrose Inverse} matrix, denoted by $J^+$, must be used:
\begin{equation}
  \begin{cases}
    J^+=(J^TJ)^{-1}J^T \quad \text{when J has linearly indipendent comlumns}\\
    J^+=J^T(JJ^T)^{-1} \quad \text{when J has linearly indipendent rows}
  \end{cases}
  \label{pseudoinverse}
\end{equation}
In robotics, the most common case is the one with a Jacobian with linearly indipendent columns, since it's common to have more links than dimensions in the task space.
\newpage
\section{Planar Vehicle-Manipulator System}\label{planar_VMS}
It will be now presented a simple case of Vehicle-Manipulator System, consisting in a base approximated with a disk and a planar serial manipulator whose revolute joints move around their z axis, orthoginal to the plane (as the one shown in Figure~\ref{DH}).\\
Since the aim of this work is to study the dynamics of the system after the catching of a tumbling object, its kinematics will be analyzed too, by considering it as a disk. The calculations will be shown as a reference for future more complex model, for which the matrices and joint positions will be omitted.\\
Firstly, let's define the DoFs of the VMS, which will be:
\begin{equation}
  p=\{x_b,y_b,\theta_b,q_1,q_2\}
\end{equation}
It is already clear that, being in the 2D case, the number of DoFs is greater than the dimension of the task space (i.e. $5>2$). In fact, from (\ref{grubler}), given $m=3$ (base and two arms) and $c_1=2$ (two revolute joints), we have $n=2$, while $p\in\mathbb{R} ^5$.\\ 
This means that a redundancy occurs and the pseudoinverse jacobian must be used instead of the inverse one, when needed.\\
The generalized coordinate of the tumbling object are the following:
\begin{equation}
  \psi=\{x_O,y_O,\theta_O\}
  \label{object_coordinates}
\end{equation}
Since the links rotate only aorund the local z-axis, given equations (\ref{rotation_matrices}) and (\ref{roto_translation}), the roto-translation matrices of the manipulator chain have the following form:
\begin{equation}
  \prescript{a}{f}{M}=
  \begin{bmatrix}
    \cos{\alpha}&-\sin{\alpha}&0&p_1\\
    \sin{\alpha}&\cos{\alpha}&0&p_2\\
    0&0&1&p_3\\
    0&0&0&1
  \end{bmatrix}
\end{equation}
where $p_1,p_2,p_3$ are the coordinates of the following moving frame in the chain projected in the actual frame.\\
Following the notation of Figure~\ref{DH}, the matrices are then given:
\begin{equation}
  \begin{array}{c}
    \prescript{f}{b}{M}=\begin{bmatrix}
      0&0&0&x_b\\
    0&0&0&y_b\\
    0&0&1&0\\
    0&0&0&1
    \end{bmatrix}\quad
    \prescript{b}{0}{M}=\begin{bmatrix}
      \cos{\theta_0}&-\sin{\theta_0}&0&0\\
      \sin{\theta_0}&\cos{\theta_0}&0&0\\
      0&0&1&0\\
      0&0&0&1
    \end{bmatrix}\\ \\
    \prescript{0}{1}{M}=\begin{bmatrix}
      \cos{q_1}&-\sin{q_1}&0&l_1\cos{q_1}\\
      \sin{q_1}&\cos{q_1}&0&l_1\sin{q_1}\\
      0&0&1&0\\
      0&0&0&1
    \end{bmatrix}\quad
    \prescript{1}{2}{M}=\begin{bmatrix}
      \cos{q_2}&-\sin{q_2}&0&l_2\cos{q_2}\\
      \sin{q_2}&\cos{q_2}&0&l_2\sin{q_2}\\
      0&0&1&0\\
      0&0&0&1
    \end{bmatrix}
  \end{array}
\end{equation}
with $l_1$ and $l_2$ the lenghts of the two arms.\\
The origin of the frames written in the fixed one can be found by multiplying the Homogeneous Matrix by $O_3=\{0,0,0,1\}$. Thus, the end-defector position is:
\begin{equation}
  p_{EE}=\prescript{0}{2}{M}O_3= \begin{bmatrix}
    l_1\cos{(\theta_0+q_1)}+l_2\cos{(\theta_0+q_1+q_2)}+x_b\\
    l_1\sin{(\theta_0+q_1)}+l_2\sin{(\theta_0+q_1+q_2)}+y_b\\0\\1
   \end{bmatrix}
   \label{EE_position}
\end{equation}
with $\prescript{0}{3}{M}=\prescript{f}{b}{M}\prescript{b}{0}{M}\prescript{0}{1}{M}\prescript{1}{2}{M}$ for the chain rule (\ref{concatenate}).\\
The Jacobian Matrix is then obtained by deriviation of $p_{EE}$ with respect to the VMS DoFs $p$ such that $\dot{p}_{EE}=J\dot{p}$:

\begin{equation}
  \begin{tiny}
  J=\begin{bmatrix}
    1&0&-l_1\sin{(\theta_0+q_1)}-l_2\sin{(\theta_0+q_1+q_2)}&-l_1\sin{(\theta_0+q_1)}-l_2\sin{(\theta_0+q_1+q_2)}&-l_2\sin{(\theta_0+q_1+q_2)}\\
    0&1&l_1\cos{(\theta_0+q_1)}+l_2\cos{(\theta_0+q_1+q_2)}&l_1\cos{(\theta_0+q_1)}+l_2\cos{(\theta_0+q_1+q_2)}&l_2\cos{(\theta_0+q_1+q_2)}
  \end{bmatrix}
\end{tiny}
\end{equation}
As already forecasted, the Jacobian Matrix is rectangular, i.e. $J\in \mathbb{R}^{2\times5}$, thus not invertibile.\\

Following equation (\ref{velocity_matrix}), the Velocity Matrices can be found as $\prescript{f}{}{W}=\prescript{f}{m}{\dot{M}}\prescript{m}{f}{M}$:
\begin{equation}
  \begin{array}{c}
    \prescript{f}{}{W_{fb}}=\prescript{f}{b}{\dot{M}}\prescript{b}{f}{M}=\begin{bmatrix}
      0&0&0&\dot{x_b}\\
      0&0&0&\dot{y_b}\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix} \quad
    \prescript{b}{}{W_{b0}}=\prescript{b}{0}{\dot{M}}\prescript{0}{b}{M}=\begin{bmatrix}
      0&-\theta_0&0&0\\
      \theta_0&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}\\ \\
    \prescript{1}{}{W_{01}}=\begin{bmatrix}
      0&-q_1&0&0\\
      q_1&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix} \quad
    \prescript{2}{}{W_{12}}=\begin{bmatrix}
      0&-q_2&0&0\\
      q_2&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
  \end{array}
\end{equation}
where the notation is the same of equation (\ref{composition}).\\
Since it is of our interest (see Chapter \ref{dynamics}) to write all the velociti matrices projected in the fixed frame, following equation (\ref{change_frame}) it is possible to write:
\begin{equation}
    \prescript{f}{}{W_{b0}}=\prescript{f}{b}{M}\prescript{b}{}{W_{b0}}\prescript{b}{f}{M}=\begin{bmatrix}
      0&-\theta_0&0&y_b \dot{\theta_0}\\
      \theta_0&0&0&-x_b \dot{\theta_0}\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
  \label{W_bo}
\end{equation}
Finally, now that both $\prescript{f}{}{W_{fb}}$ and $\prescript{f}{}{W_{b0}}$ are projected in the same frame, following equation (\ref{concatenate}):
\begin{equation}
    \prescript{f}{}{W_{f0}}=\prescript{f}{}{W_{fb}}+\prescript{f}{}{W_{b0}}=\begin{bmatrix}
      0&-\theta_0&0&\dot{x_b}+y_b \dot{\theta_0}\\
      \theta_0&0&0&\dot{y_b}-x_b \dot{\theta_0}\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
    \label{arm_1_vel}
\end{equation}
and the same holds for $\prescript{f}{}{W_{f1}}$ and $\prescript{f}{}{W_{f2}}$, whose $3\times 3$ submatrices, related to the angular velocity, are:
  \begin{equation}
    \begin{array}{c}
      \prescript{f}{}{W_{{f1}_{1:3,1:3}}}=\begin{bmatrix}
        0&-\theta_0-q_1&0\\
        \theta_0+q_1&0&0\\
        0&0&0
      \end{bmatrix} \quad
      \prescript{f}{}{W_{{f1}_{1:3,1:3}}}=\begin{bmatrix}
        0&-\theta_0-q_1-q_2&0\\
        \theta_0+q_1+q_2&0&0\\
        0&0&0
      \end{bmatrix}
    \end{array}
    \label{arms_velocity}
  \end{equation}
\\
We could have calculated $\prescript{f}{}{W_{f0}}$ using equation (\ref{velocity_matrix}) as well ($\prescript{f}{}{W_{f0}}=\prescript{f}{0}{\dot{M}}\prescript{0}{f}{M}$). However, it is useful to have also the relative velocity matrices to calculate the corresponding $L$ matrices (see equation (\ref{L_matrix})):
\begin{equation}
  \begin{array}{c}
    \prescript{f}{}{L_{{fb}_x}}=\begin{bmatrix}
      0&0&0&1\\
      0&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix} \quad
    \prescript{f}{}{L_{{fb}_y}}=\begin{bmatrix}
      0&0&0&0\\
      0&0&0&1\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}\\ \\
    \prescript{b}{}{L_{b0}}=\prescript{0}{}{L_{01}}=\prescript{1}{}{L_{12}}=\begin{bmatrix}
      0&-1&0&0\\
      1&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
  \end{array}
  \label{L_matrices}
\end{equation}
where $\prescript{f}{}{L_{{fb}_x}}$ and $\prescript{f}{}{L_{{fb}_y}}$ have been found such that $\prescript{f}{}{L_{fb}}=\prescript{f}{}{L_{{fb}_x}}+\prescript{f}{}{L_{{fb}_y}}$.\\
By projecting in the fixed frame:
\begin{equation}
  \prescript{f}{}{L_{b0}}=\begin{bmatrix}
    0&-1&0&y_b\\
    1&0&0&-x_b\\
    0&0&0&0\\
    0&0&0&0
  \end{bmatrix}
\end{equation}
which is $\prescript{f}{}{W_{b0}}/ \dot{\theta_0}$ from equation (\ref{W_bo}).
\subsection{Object's Kinematics}
For the planar case, the object to be captured (might it be a satellite or a micro-meteorite) is approximated with a  disk, in the same way we did for the base of the VMS.\\
The goal of the object's kinematics is to find the relationshipt between the velocity of its centre and the velocity of the contact point ($c_p$), as suggested in [12].\\
Hence, the Homogeneous Matrices related to the tumbling object are the following:
\begin{equation}
  \begin{array}{c}
    \prescript{f}{O_0}{M}=\begin{bmatrix}
      1&0&0&x_O\\
    0&1&0&y_O\\
    0&0&1&0\\
    0&0&0&1
    \end{bmatrix}\quad
    \prescript{O_0}{O_1}{M}=\begin{bmatrix}
      \cos{\theta_O}&-\sin{\theta_O}&0&0\\
      \sin{\theta_O}&\cos{\theta_O}&0&0\\
      0&0&1&0\\
      0&0&0&1
    \end{bmatrix}\\
    \\
    \prescript{O_1}{O_2}{M}=\begin{bmatrix}
      \cos{\gamma}&-\sin{\gamma}&0&r \cos{\gamma}\\
      \sin{\gamma}&\cos{\gamma}&0&r \sin{\gamma}\\
      0&0&1&0\\
      0&0&0&1
    \end{bmatrix}
  \end{array}
\end{equation}
with the coordinates of the object as in (\ref{object_coordinates}), $\gamma$ the angle between the the object local frame and the position of the contact point (see Figure~\ref{contact_point}) and $r$ the radius of the disk.\\
\begin{figure}
  \centering
  \input{tikz/disk.tikz}
  \caption{Tumbling object disk approximation.}
  \label{contact_point}
\end{figure}
As for the previous case, the position of the contact point with respect to the fixed frame is found with the chain rule:
\begin{equation}
  \prescript{f}{}{c_p}=\prescript{f}{O_0}{M}\prescript{O_0}{O_1}{M}\prescript{O_1}{O_2}{M}\prescript{O_1}{}{c_p}=\begin{bmatrix}
    x_O + r \cos{(\theta_O+\gamma)}\\
    y_O + r \sin{(\theta_O+\gamma)}
  \end{bmatrix}
\end{equation}
By deriving the position of the contact point with respect to the object coordinates $\psi$, we obtain the object Jacobian Matrix:
\begin{equation}
  J_O=\begin{bmatrix}
    1&0&-r\sin{(\theta_O+\gamma)}\\
    0&1&r\cos{(\theta_O+\gamma)}
  \end{bmatrix}
  \label{object_jacobian}
\end{equation}
which is still not squared ($J_O \in \mathbb{R}^{2 \times 3}$), thus not invertible.\\

Regarding the velocity matrix, we are not intersted in $\prescript{f}{}{W_{fO_2}}$, since we can find the velocity of the contact point by just derivation with respect of time. Instead, it will be useful in the next chapter to have $\prescript{f}{}{W_{O_0O_1}}$, which is the velocity of frame one with respect to frame zero, projected in the fixed frame:
\begin{equation}
  \prescript{f}{}{W_{O_0O_1}}=\begin{bmatrix}
    0&-\theta_O&0&y_O \dot{\theta_O}\\
    \theta_O&0&0&-x_O \dot{\theta_O}\\
    0&0&0&0\\
    0&0&0&0
  \end{bmatrix}
\end{equation}
which is very similar to (\ref{W_bo}). Hence, in the same way we did in the previous section, we can retrive the following matrices:
\begin{equation}
  \begin{array}{c}
    \prescript{f}{}{L_{{fO}_x}}=\begin{bmatrix}
      0&0&0&1\\
      0&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix} \quad
    \prescript{f}{}{L_{{fO}_y}}=\begin{bmatrix}
      0&0&0&0\\
      0&0&0&1\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}\\ \\
    \prescript{f}{}{L_{O_0O_1}}=\begin{bmatrix}
      0&-1&0&y_O\\
      1&0&0&-x_O\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
  \end{array}
\end{equation}
\chapter{Dynamics}\label{dynamics}
The dynamics analysis of a mechanical system consists in studying how the system evloves according to the present actions, given by motors and/or external world. If the kinematics analyisis is used to describe the motion, the dynamics one studies its causes. For a robotic system, the forces involves are usually the torques applied at the joints and, in this case, also the forces applied to the base.\\
The analyisis can be:
\begin{itemize}
  \item direct: from the torques applied by the motors, the motion is calculated.
  \item inverse: given the motion we calculate the forces and torques that produce that motion
\end{itemize}
The former problem requires differential calculation, while the latter algebraic.\\
In this thesis, both problems will be studied: given the impact of the tumbling object with the VMS, we want to analyse the motion of the system after the impact; however, we also want to find a control algorith to be applied at the torques to stabilize the system after the impact.\\
The dynamic equations, also referred to as the equations of motion, are a set of second-order differential equations of the form:
\begin{equation}
  M(q)\ddot{q}+c(q,\dot{q})=u
  \label{equation_motion}
\end{equation}
where $q \in \mathbb{R}^n$ is the vector of joint variables, $\tau \in \mathbb{R}^n$ is the vector of joint forces and torques, $M(q) \in \mathbb{R}^{n \times n}$ is a symmetric positive-definite \textit{Mass Matrix}, and $c(q,\dot{q}) \in \mathbb{R}^n$ are forces that lumped together centripetal, Coriolis, gravity and friction terms that depend solely on $q$ and $\dot{q}$ [11].\\
By solving these equation, given the nature of the problem (direct or inverse), we can find the motion or the torques respectively.\\
There are different methods to find the equations of motion, such as Newton-Euler method and the lagrangian one. In this thesis the latter will be used, both in a "classic" scalar approach and in the Homogeneous Matrix approach shown in [10].\\
The dynamic analysis will be performed considering plastic bodies.
\newpage
\section{Classic Approach}
The lagrangian approach is an energy-based one, which allows to find the dynamic equations in a symbolic closed form. Particularly, the method involes the calculation of the kinetic and potential energy of the system.\\
For a point mass in $\mathbb{R} ^3$, the kinetic energy is expressed as:
\begin{equation}
  T=\frac{1}{2}mv^Tv
\end{equation}
and for a system of point masses:
\begin{equation}
  T=\frac{1}{2}\sum_{i=1}^N m_iv_i^Tv_i
\end{equation}
A rigid body that moves in space has:
\begin{itemize}
  \item $v_c \in \mathbb{R} ^3$: linear velocity (of the centre of mass).
  \item $\omega_c \in \mathbb{R} ^3$: angular velocity (all points of the body).
\end{itemize}
Hence, the kinetic energy of a rigid body of volume $V$ is:
\begin{equation}
  \begin{split}
  T&=\frac{1}{2}\int_{V}v^Tv\,dm=\frac{1}{2}\int_{V}(v_c+\omega\times P)^T(v_c+\omega \times P)\,dm\\
  & =\frac{1}{2}\int_{V}v_c^Tv_c\,dm+\frac{1}{2}\int_{V}v_c^T[\omega]_{\times}P\,dm+\frac{1}{2}\int_{V}(\omega \times P)^T(\omega \times P)\,dm
\end{split}
\label{kinetic_body}
\end{equation}
where $P$ is the position of the infinitesimal mass $\,dm$ with respect to the centre of mass.\\
From the first term of equation (\ref{kinetic_body}) the velocity vectors can be taken out of the integral; from the second term the velocity vector and the skew matrix of the angular velocity can be taken out and the integral becomes zero, because of the centre of mass theroem (i.e. $\int_{V}P\,dm=0$). Hence, the kinetic energy becomes:
\begin{equation}
  \begin{split}
    T&=\frac{1}{2}v_c^Tmv_c+\frac{1}{2}\int_{V}(-[P]_{\times}\omega)^T(-[P]_{\times}\omega)\,dm\\
    &=\frac{1}{2}v_c^Tmv_c+\frac{1}{2}\int_{V}-\omega^T[P]_{\times}[P]_{\times}\omega\,dm\\
    &=\frac{1}{2}v_c^Tmv_c+\frac{1}{2}\omega^T\int_{V}-[P]_{\times}[P]_{\times}\,dm \ \omega\\
    &=\frac{1}{2}v_c^Tmv_c+\frac{1}{2}\omega^T I \omega
  \end{split}
  \label{final_kinetic_body}
\end{equation}
since $(-[P]_{\times}\omega)^T=\omega^T-[P]_{\times}^T=\omega^T[P]_{\times}$.\\
The first term of equation (\ref{final_kinetic_body}) refers to the translational part (i.e. the kinetic energy of the point mass at the centre of mass), while the second to the rotational kinetic energy of the whole body, which takes into account the inertial distribution through the \textit{Tensor of Inertia} with respect to the centre of mass: $I \in \mathbb{R}^{3\times 3}$.\\

The potential energy, on the other hand, will not be take into consideration in this Chapter, since in outer space there is no gravity and we are assuming the system to be composed only with rigid bodies: no elastic deformation is taken in account.\\

Finally, it is possible to write the lagrangian formulation:
\begin{equation}
  \mathcal{L} (q,\dot{q}) \triangleq \sum_{i=1}^NT_i-U_i
\label{energy_sum}
\end{equation}
where $N$ is the number of bodies and $L$ is the \textit{Lagrangian Function}.\\
The equations of motion can now be expressed in terms of the Lagrangian as follows [11]:
\begin{equation}
  \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_i}-\frac{\partial \mathcal{L} }{\partial q_i}=f_i
  \label{lagrangian} 
\end{equation}
with $f_i$ the non lagrangian, non conservative forces (external/dissipative) performing work on $q_i$. The number of equations obtained is equal to the number of DoFs of the system $i$.\\

Regarding the planar VMS seen in Section~\ref{planar_VMS} it is possible to write the position of the centre of mass of each body using the same approach of equation (\ref{EE_position}): $p_{c_b}=O_b=\prescript{f}{b}{M}\{0,0,0,1\}^T$, $p_{c_1}=\prescript{b}{1}{M}\{-\frac{l_1}{2},0,0,1\}^T$ and $p_{c_2}=\prescript{1}{2}{M}\{-\frac{l_2}{2},0,0,1\}^T$, since the position of the centre of mass of each arm is located in its middlee point and the local frame is located at the end of the arm.\\
Now, $v_{c_b}$, $v_{c_1}$ and $v_{c_2}$ can be found by derivation of the position vectors and the translational part of the kinetic energy (\ref{final_kinetic_body}) can be computed.\\
In order to find the rotational part, the tensors of inertia of the disk and the two arms are needed. Table~\ref{inertia_moments} reports the moments of inertia.\\
\begin{table}
  \caption{Moments of inertia of the planar VMS' bodies, with respect to their centre of mass (in the centre of the base and the arms), with $i=\{1,2\}$.}
  \label{inertia_moments}
  \begin{center}
  \begin{tabular}{lccc}
    \toprule
  \textbf{Body} & \textbf{Tensor of Inertia}\\
  \midrule
  Base&$\begin{bmatrix}
    \frac{1}{4}m_br^2&0&0\\
    0&\frac{1}{4}m_br^2&0\\
    0&0&\frac{1}{2}m_br^2
  \end{bmatrix}$\\
  \\
  Arms&$\begin{bmatrix}
    0&0&0\\
    0&\frac{1}{12}m_il_i^2&0\\
    0&0&\frac{1}{12}m_il_i^2
  \end{bmatrix}$\\
  \bottomrule
  \end{tabular}
  \end{center}
  \end{table}
Since the rotation happens to be only around the orthogonal axis of the plane (following the Denavit-Hartenberg formulation, the z-axis), we will use only $I_z$:
\begin{equation}
  \begin{array}{l}
  T_b=v_{c_b}m_bv_{c_b}^T+\frac{1}{2}I_{b_z}\omega_{b_z}^2\\
  T_1=v_{c_1}m_1v_{c_1}^T+\frac{1}{2}I_{1_z}\omega_{1_z}^2\\
  T_2=v_{c_2}m_2v_{c_2}^T+\frac{1}{2}I_{2_z}\omega_{2_z}^2
  \end{array}
  \label{kin_energy}
\end{equation}
with $\omega_{b_z}$, $\omega_{1_z}$ and $\omega_{2_z}$ the angular velocities extrapolated from the Velocity Matrices in equations (\ref{arm_1_vel}, \ref{arms_velocity}).\\
As already said, $L$ is only the sum of the three contribution of equation (\ref{kin_energy}) and, since we have five DoFs ($p \in \mathbb{R} ^5$), there will be five lagrangian equations, one for each genralized coordinate.\\
The non lagrangian are called this way because they are not captured by the Lagrange equation: if the conservative part of the forces is captured by $\mathcal{L}$, the non lagrangian's are the ones which are not capured by any energy.\\ 
\begin{figure}
  \centering
  \input{tikz/forces.tikz}
  \caption{Forces and torques applied to the base ($F_x,F_y,\tau_0$) and to the links ($\tau_1,\tau_2$). Note that the torque of the first arm affects the base and the torque of the second arm affects the first arm.}
  \label{forces}
\end{figure}
In this case they are the torques and forces applied to the base and the manipulator's links (see Figure~\ref{forces}):
\begin{equation}
  \begin{array}{l}
  f_1=F_x\cos{\theta_0}-F_y\sin{\theta_0}\\
  f_2=F_x\sin{\theta_0}+F_y\cos{\theta_0}\\
  f_3=\tau_0\\
  f_4=\tau_1\\
  f_5=\tau_2
  \end{array}
  \label{non_lagrangian}
\end{equation}
Since the kinetic energy is written with respect to the fixed frame, the forces are projected too in that frame through $\theta_0$.\\
Equation (\ref{lagrangian}) can now be written as:
\begin{equation}
  \begin{cases}
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{x}_b}-\frac{\partial \mathcal{L} }{\partial x_b}=F_x\cos{\theta_0}-F_y\sin{\theta_0}\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{y}_b}-\frac{\partial \mathcal{L} }{\partial y_b}=F_x\sin{\theta_0}+F_y\cos{\theta_0}\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{\theta}_0}-\frac{\partial \mathcal{L} }{\partial \theta_0}=\tau_0\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_1}-\frac{\partial \mathcal{L} }{\partial q_1}=\tau_1\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_2}-\frac{\partial \mathcal{L} }{\partial q_2}=\tau_2
  \end{cases}
\end{equation}
After having solved these five equations, it is possible to gather them together in a vectorial form, such as in (\ref{equation_motion}), with $M\in\mathbb{R}^{5\times 5}$, $c\in \mathbb{R}^5$ and $u\in\mathbb{R}^{5\times 5}$.\textcolor{red}{MATRICES IN THE APPENDIX?}
\subsection{Object's Dynamics}\label{object_dynamics}
The same approach can be implemented for the object to be captured: since it is approximated as a disk too, its moment of inertia is equal to the base's one.\\
The kinetic energy is then:
\begin{equation}
  T_O=v_Om_Ov_O^T+\frac{1}{2}I_{O_z}\theta_O^2
\end{equation}
and the non lagrangian components:
\begin{equation}
  \begin{array}{l}
  f_{O_1}=F_{O_x}\cos{\theta_O}-F_{O_y}\sin{\theta_O}\\
  f_{O_2}=F_{O_x}\sin{\theta_O}+F_{O_y}\cos{\theta_O}\\
  f_{O_3}=\tau_O
  \end{array}
\end{equation}
supposing to have, as the VMS' base, two translational forces acting on the centre of mass and a torque around its inertial frame. However, since we are not really interested in the control of the external object, these are not necessary and we will use only the mass and Coriolis matrices.\\
By solving equation (\ref{lagrangian}), we get the mass, Coriolis' and torques matrices:
\begin{equation}
  \begin{array}{c}
    M_O=\begin{bmatrix}
      m_O&0&0\\
      0&m_O&0\\
      0&0&\frac{m_Or^2}{2}
    \end{bmatrix}\quad
    c_O=\begin{bmatrix}
      0\\0\\0
    \end{bmatrix}\\
    \\
    u_O=\begin{bmatrix}
      \cos{\theta_O}&-\sin{\theta_0}&0\\
      \sin{\theta_O}&\cos{\theta_0}&0\\
      0&0&1
    \end{bmatrix}
  \end{array}
  \label{object_matrices}
\end{equation}
\newpage
\section{Homogeneous Matrices Approach}
The Homogeneous Matrices Approach introduced in [9,10] offers a quick, intuitive and scalable (for higher DoFs) method for robotic's dynamics.\\
It is base, as the name suggests, on the Homogeneous Matrices shown in Section~\ref{Homogeneous} and on other characteristic matrices that will be here presented.\\
The goal of this approach is to write the lagrangian in a matrix form and, to do so, we need to define matrices for the inertia of the system, for the non-lagrangian actions present in the system and the velocity of the bodies.\\
The latter ones have already been discussed in Section~\ref{velocity_section}, while the inertia and non-lagrangian forces need to be introduced.\\

The mass distribution of a body $k$, projected in the frame $i$, can be described through the \textit{Pseudo Inertia Tensor} $J$:
\begin{equation}
  \prescript{i}{}{J_k}=\begin{bmatrix}
    J_{xx}&J_{xy}&J_{xz}&mx_G\\
    J_{yx}&J_{yy}&J_{yz}&my_G\\
    J_{zx}&J_{zy}&J_{zz}&mz_G\\
    mx_G&my_G&mz_G&m
  \end{bmatrix}
\end{equation}
where $m$ is the mass of the body, $\{x_G,y_G,z_G\}$ is the position of the centre of mass and the pseudo moments of inertia are defined as:
\begin{equation}
  \begin{array}{c}
    J_{xx}=\int x^2\,dm\quad J_{yy}=\int y^2\,dm\quad J_{zz}=\int z^2\,dm\\
    J_{xy}=\int xy\,dm\quad J_{xz}=\int xz\,dm\quad J_{yz}=\int yz\,dm
  \end{array}
  \label{pseudo_moments}
\end{equation}
These are differents from the well known moments of inertia ($I_{xx},I_{yy},I_{zz},I_{xy},I_{xz},I_{yz}$) and their relation is shown in equation (\ref{moments_convertion}):
\begin{equation}
  \begin{array}{c}
    \begin{cases}
      J_{xx}=\frac{-I_{xx}+I_{yy}+I_{zz}}{2}\\
      J_{yy}=\frac{-I_{yy}+I_{xx}+I_{zz}}{2}\\
      J_{zz}=\frac{-I_{zz}+I_{xx}+I_{yy}}{2}
    \end{cases}
    \quad
    \begin{cases}
      J_{xy}=-I_{xy}\\
      J_{yz}=-I_{yz}\\
      J_{zz}=-I_{zx}
    \end{cases}
  \end{array}
\label{moments_convertion}
\end{equation}
\\
In order to evaluate the non lagrangian components of equation (\ref{lagrangian}), [9] introduces the \textit{Action Matrix}:
\begin{equation}
  \prescript{i}{}{\phi}_k=\begin{bmatrix}
    0&-c_z&c_y&f_x\\
    c_z&0&-c_x&f_y\\
    -c_y&c_x&0&f_z\\
    -f_x&-f_y&-f_z&0
  \end{bmatrix}
  \label{action_matrix}
\end{equation}
where $\{f_x,f_y,f_z\}$ is the resultant of the forces applied to a body $k$, $\{c_x,c_y,c_z\}$ holds the torques calculated with respect to the origin of the frame $i$.\\
The pseudo-scalar product (see \ref{appendix}) between the action matrix of a body and its velocity matrix, gives the power developed by the actions included in $\phi$ as the object moves according to the velocities described by $W$:
\begin{equation}
  P=\prescript{f}{}{\phi}\otimes \prescript{f}{}{W}
\end{equation}
Notice that both the action and velocity matrix have been projected in the fixed frame.\\
A manipulator with two revolute links will have two contribution to the overall power, one for each link:
\begin{equation}
  \begin{split}
  P&=\prescript{f}{}{\phi_1}\otimes \prescript{f}{}{W_{f1}}+\prescript{f}{}{\phi_2}\otimes \prescript{f}{}{W_{f2}}\\
   &=\prescript{f}{}{\phi_1}\otimes \prescript{f}{}{L_{f1}}\dot{\theta_1}+\prescript{f}{}{\phi_2}\otimes \Big(\prescript{f}{}{W_{f1}}+\prescript{f}{}{W_{12}}\Big)\\
   &=\Big(\prescript{f}{}{\phi_1}+\prescript{f}{}{\phi_2}\Big)\otimes\prescript{f}{}{L_{f1}}\dot{\theta_1}+\prescript{f}{}{\phi_2}\otimes \prescript{f}{}{L_{12}}\dot{\theta_2}\\
   &=f_{\theta_1}\dot{\theta_1}+f_{\theta_2}\dot{\theta_2}
  \end{split}
\end{equation}
whith $f_{\theta_1}$ and $f_{\theta_2}$ the non-lagrangian components of links one and two, respectively.\\
It is now clear the importance of the $L$ matrix, introduced in Section~\ref{velocity_section}: we can write the non-lagrangian components as a pseudo-scalr product between the overall set of action applied to the system downstream and the relative motion permitted by the joint $i$:
\begin{equation}
  f_{q_i}=\Big(\sum_{j=1}^N\prescript{f}{}{\phi_j}\Big)\otimes \prescript{f}{}{L_{q_i}}
\label{non_lagrangian_matrix}
\end{equation}
It can be proved that ideal constraints between links don't affect the Lagrange equation: we can neglet the constraint forces in $\phi$.\\

Finally, we can write the kinetic energy of the body $j$ as follows:
\begin{equation}
  T_j=\frac{1}{2}\Tr{\Big(\prescript{f}{}{W_{fj}}\prescript{f}{}{J_j}\prescript{f}{}{W_{fj}^T}\Big)}
  \label{kinetic_matrix}
\end{equation}
and, from equation (\ref{energy_sum}), we still get (\ref{lagrangian}).\\

Regarding the planar VMS system, it is useful to write the pseudo inertial tensor starting from the local frame: since the body is rigid, the mass is supposed to remain in the same position with respect to the local frame.\\
The pseudo moments of inertia are found starting from the moments of inertia (Table \ref{inertia_moments}) and following equation (\ref{moments_convertion}), as shown in Table~\ref{pseudo_moments_table}. Thus:
\begin{equation}
  \begin{array}{c}
  \prescript{0}{}{J_b}=\begin{bmatrix}
    \frac{m_br^2}{4}&0&0&0\\
    0&\frac{m_br^2}{4}&0&0\\
    0&0&0&0\\
    0&0&0&m_b
  \end{bmatrix} \quad
    \prescript{1}{}{J_1}=\begin{bmatrix}
    \frac{l_1^2m_1}{3}&0&0&0\\
    0&0&0&-\frac{l_1m_1}{2}\\
    0&0&0&0\\
    \frac{l_1m_1}{2}&0&0&m_1
  \end{bmatrix}\\
  \\
  \prescript{2}{}{J_2}=\begin{bmatrix}
    \frac{l_2^2m_2}{3}&0&0&0\\
    0&0&0&-\frac{l_2m_2}{2}\\
    0&0&0&0\\
    \frac{l_2m_2}{2}&0&0&m_2
  \end{bmatrix}
  \end{array}
\end{equation}
\begin{table}
  \caption{Moments of inertia of the planar VMS' bodies, with respect to their centre of mass (in the centre of the base and the arms), with $i=\{1,2\}$.}
  \label{pseudo_moments_table}
  \begin{center}
  \begin{tabular}{lccc}
    \toprule
  \textbf{Body} & \textbf{Tensor of Pseudo Inertia}\\
  \midrule
  Base&$\begin{bmatrix}
    \frac{1}{4}m_br^2&0&0\\
    0&\frac{1}{4}m_br^2&0\\
    0&0&0
  \end{bmatrix}$\\
  \\
  Arms&$\begin{bmatrix}
    \frac{1}{3}m_il_i^2&0&0\\
    0&0&0\\
    0&0&0
  \end{bmatrix}$\\
  \bottomrule
  \end{tabular}
  \end{center}
  \end{table}
Then, following equation (\ref{change_frame}), we can project $\prescript{0}{}{J_b}$, $\prescript{1}{}{J_1}$ and $\prescript{2}{}{J_2}$ in the fixed frame, obtaining $\prescript{f}{}{J_b}$, $\prescript{f}{}{J_1}$ and $\prescript{f}{}{J_2}$.\\
It is already possibile to write the kinetic energy (\ref{kinetic_matrix}) for every body, since we have both the velocity matrices and the tensors of pseudo inertia projected in the fixed frame:
\begin{equation}
  \begin{array}{l}
    T_b=\frac{1}{2}\Tr{\Big(\prescript{f}{}{W_{f0}}\prescript{f}{}{J_0}\prescript{f}{}{W_{f0}^T}\Big)}\\
    T_1=\frac{1}{2}\Tr{\Big(\prescript{f}{}{W_{f1}}\prescript{f}{}{J_1}\prescript{f}{}{W_{f1}^T}\Big)}\\
    T_2=\frac{1}{2}\Tr{\Big(\prescript{f}{}{W_{f2}}\prescript{f}{}{J_2}\prescript{f}{}{W_{f2}^T}\Big)}
  \end{array}
\end{equation}
To find the non lagrangian components, the action and the $L$ matrices need to be calculated.\\
We have already found the $L$ matrices associated with the permitted motion of each body in Chapter~\ref{kinematics} (see equation (\ref{L_matrices})). The action matrices can be easily found by looking at the definition of $\phi$ (\ref{action_matrix}) and confronting it with Figure~\ref{forces}:
\begin{equation}
  \begin{array}{c}
    \prescript{0}{}{\phi_b}=\begin{bmatrix}
      0&-\tau_0+\tau_1&0&F_x\\
      \tau_0-\tau_1&0&0&F_y\\
      0&0&0&0\\
      -F_x&-F_y&0&0
    \end{bmatrix} \quad
    \prescript{1}{}{\phi_1}=\begin{bmatrix}
      0&-\tau_1+\tau_2&0&0\\
      \tau_1-\tau_2&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}\\
    \\
    \prescript{2}{}{\phi_2}=\begin{bmatrix}
      0&-\tau_3&0&0\\
      \tau_2&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
  \end{array}
\end{equation}
After the projection of the action matrices in the fixed frame, it is possible to find the non lagrangian components:
\begin{equation}
  \begin{array}{l}
  f_1=\Big(\prescript{f}{}{\phi_b}+\prescript{f}{}{\phi_1}+\prescript{f}{}{\phi_2}\Big)\otimes \prescript{f}{}{L_{fb_x}}=F_x\cos{\theta_0}-F_y\sin{\theta_0}\\
  f_2=\Big(\prescript{f}{}{\phi_b}+\prescript{f}{}{\phi_1}+\prescript{f}{}{\phi_2}\Big)\otimes \prescript{f}{}{L_{fb_y}}=F_x\sin{\theta_0}+F_y\cos{\theta_0}\\
  f_3=\Big(\prescript{f}{}{\phi_b}+\prescript{f}{}{\phi_1}+\prescript{f}{}{\phi_2}\Big)\otimes \prescript{f}{}{L_{f0}}=\tau_0\\
  f_4=\Big(\prescript{f}{}{\phi_b}+\prescript{f}{}{\phi_1}\Big)\otimes \prescript{f}{}{L_{01}}=\tau_1\\
  f_5=\prescript{f}{}{\phi_b}\otimes \prescript{f}{}{L_{12}}=\tau_2
  \end{array}
\end{equation}
which are the same of (\ref{non_lagrangian}).\\
It is now possibile to solve the Lagrange equation, 
with $\mathcal{L}=T_b+T_1+T_2$:
\begin{equation}
  \begin{cases}
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{x}_b}-\frac{\partial \mathcal{L}}{\partial x_b}=f_1\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{y}_b}-\frac{\partial \mathcal{L}}{\partial y_b}=f_2\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{\theta}_0}-\frac{\partial \mathcal{L}}{\partial \theta_0}=f_3\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_1}-\frac{\partial \mathcal{L}}{\partial q_1}=f_4\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_2}-\frac{\partial \mathcal{L}}{\partial q_2}=f_5\\
  \end{cases}
\end{equation}
\subsection{Object's Dynamics}
The object's pseudo inertia tensor follows the same structure of the base's one:
\begin{equation}
  \prescript{O_1}{}{J_{O_1}}=\begin{bmatrix}
    \frac{m_br^2}{4}&0&0&0\\
    0&\frac{m_br^2}{4}&0&0\\
    0&0&0&0\\
    0&0&0&m_b
  \end{bmatrix}
\end{equation}
and $\prescript{f}{}{J_b}=\prescript{f}{O_1}{M}\prescript{O_1}{}{J_{O_1}}\prescript{O_1}{f}{M}$.\\
The velocity and $L$ matrices have already been found in the previous chapter; the action matrix can be written with the same assimption made for the classic method approach:
\begin{equation}
  \prescript{O_1}{}{\phi_{O_1}}=\begin{bmatrix}
    0&-\tau_O&0&F_{O_x}\\
    \tau_O&0&0&F_{O_y}\\
    0&0&0&0\\
    -F_{O_x}&-F_{O_y}&0&0
  \end{bmatrix}
\end{equation}
and $\prescript{f}{}{\phi_{O_1}}=\prescript{f}{O_1}{M}\prescript{O_1}{}{\phi_{O_1}}\prescript{O_1}{f}{M}$.
Finally:
\begin{equation}
  T_O=\frac{1}{2}\Tr{\Big(\prescript{f}{}{W_{fO_1}}\prescript{f}{}{J_b}\prescript{f}{}{W_{fO_1}^T}\Big)}
\end{equation}
and:
\begin{equation}
  \begin{array}{l}
    f_{O_1}=\prescript{f}{}{\phi_{O_1}}\otimes \prescript{f}{}{L_{fO_x}}=F_{O_x}\cos{\theta_O}-F_{O_y}\sin{\theta_O}\\
    f_{O_2}=\prescript{f}{}{\phi_{O_1}}\otimes \prescript{f}{}{L_{fO_y}}=F_{O_y}\cos{\theta_O}+F_{O_x}\sin{\theta_O}\\
    f_{O_3}=\prescript{f}{}{\phi_{O_1}}\otimes \prescript{f}{}{L_{O_0O_1}}=\tau_O
  \end{array}
\end{equation}
By solving (\ref{lagrangian}), we get the same matrices in (\ref{object_matrices}).
\newpage
\chapter{Impact Analysis}
Once the Kinematics and the Dynamics of both the VMS and the external object are analysed, the impact analysis between the two is here performed.\\
In [13] and [14], two basic assumptions are made in the formulation of the impact model:
\begin{enumerate}
  \item although the generalized velocities change substantially, the generalized coordinates of the system remain the same over the impact duration. This is justified not only for the rotational coordinates but for the elastic ones as well [15]. The latter conclusion can also be implied by reasoning that since the duration of impact (approximately \SI{d-4}{\second}) is very small compared with the period of the fundamental mode of vibration of the links (several seconds), the change in deflection of a flexible beam during impact is negligible (\textcolor{red}{mettere questa info più anvanti quando/se introdurremo l'elasticità dei link}).
  \item at the contact point between the end-defector and the target there are forces but not moments. Impact occurs at a single point, which is unable to transmit a local moment.
\end{enumerate}
Another assumption that has been already done in the previous chapters is that we know in advance the inertia and dynamic properties of the payload, as well as the position of the contact point on the payload.\\
Following the second assumption, during the impact the equations of motion of the VMS and the object can be expressed in a form similar to equation (\ref{equation_motion}) except for the impact force $f_I$:
\begin{equation}
  \begin{cases}
    M\ddot{p}+c=u+J^Tf_I\\
    M_O\ddot{\psi}+c_O=-J_O^Tf_I
  \end{cases}
  \label{initial_impact}
\end{equation}
Notice that $u_O$ has been omitted in the second equation, since, as already mentioned in Section~\ref{object_dynamics}, we are not interested in controlling the object.\\
From the second equation of (\ref{initial_impact}), we can write:
\begin{equation}
  f_I=-(J_O^T)^+(M_O\ddot{\psi}_O+c_O)
  \label{impact_force}
\end{equation}
with $(J_O^T)^+$ the pseudoinverse of the transposed object's jacobian; in fact, since as found in (\ref{object_jacobian}) this jacobian is not squared, we can use the pseudoinverse to invert it and, by having linearly indipendent rows, it is defined accordingly to (\ref{pseudoinverse}).\\
By substuting (\ref{impact_force}) in the first equation of (\ref{initial_impact}), one obtaines:
\begin{equation}
  \begin{split}
  M\ddot{p}+c&=u-J^T(J_O^T)^+(M_O\ddot{\psi}_O+c_O)\\
  &=u-J^T(J_O^+)^T(M_O\ddot{\psi}_O+c_O)
  \end{split}
\end{equation}
Now, integrating the above equation over the period od impact $\pi$:
\begin{equation}
  \int_{0}^{\pi}M\ddot{p}\,dt+\int_{0}^{\pi}c\,dt =-\int_{0}^{\pi}J^T(J_O^+)^TM_O\ddot{\psi}_O\,dt+\int_{0}^{\pi}(u-J^T(J_O^+)^Tc_O)\,dt
\end{equation}
Under the first assumption of no change of the generalized coordinates during the impact (but only of their velocities), all the contributions that depend only on the velocities and positions (i.e. $c,u,J^T(J_O^+)^Tc_O$) can be ignored:
\begin{equation}
  M(\dot{p}_f-\dot{p}_i)+J^T(J_O^+)^TM_O(\dot{\psi}_f-\dot{\psi_i})=0
\end{equation}
This equation can be used for all collisions ranging from plastic to perfectly elastic~[15,16].\\

In the following sections different scenarios will be analysed:
\begin{enumerate}
  \item Rigid bodies, plastic impact
  \item Elastic bodies, plastic impact
  \item Elastic bodies, elastic impact
\end{enumerate}
\newpage
\section{Plastic Impact}
\end{document}
