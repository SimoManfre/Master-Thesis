\documentclass[a4paper,12pt,oneside]{report}
\usepackage[T1]{fontenc}
\usepackage{setspace}
\usepackage[utf8]{inputenc} 
\usepackage[english]{babel}
\usepackage{url}
\usepackage{tikz}
\usepackage{layaureo}
\usepackage[english]{varioref}
\usepackage{mathtools,trimclip}
\usepackage{siunitx}
\usepackage{amsfonts}
\usepackage{amsmath,rotating}
\usepackage{amssymb}
\usepackage[section]{placeins}
\usepackage{microtype}
\usepackage{booktabs}
\usepackage{svg}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{subfig}
\usepackage[toc,page]{appendix}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{cite}
% \usepackage[backend=biber]{biblatex}
% \addbibresource{test.bib}
\usepackage[autostyle,italian=guillemets]{csquotes}
\usepackage{listings,xcolor}
\usepackage{geometry}
\addtolength{\textheight}{1cm}
\DeclareMathOperator{\Tr}{Tr}
\usetikzlibrary{decorations.text}
\usetikzlibrary{arrows.meta}
\tikzset{>={Latex[width=2mm,length=2mm]}}
\renewcommand{\chaptermark}[1]{\markboth{#1}{#1}}
\fancypagestyle{styletoc}{
  \fancyhf{}
  \fancyhead[R]{\thepage}
  \fancyhead[L]{CONTENTS}
}
\fancypagestyle{styleint}{
  \fancyhf{}
  \fancyhead[R]{\thepage}
  \fancyhead[L]{INTRODUCTION}
}
\fancypagestyle{stylenor}{
\fancyhf{}
\fancyhead[R]{\thepage}
\fancyhead[L]{\scshape{\chaptername} \thechapter\ --\ \leftmark}
}
\newlength{\mylen}
\setbox1=\hbox{$\bullet$}\setbox2=\hbox{\tiny$\bullet$}
\setlength{\mylen}{\dimexpr0.5\ht1-0.5\ht2}
\renewcommand\labelitemi{\raisebox{\mylen}{\tiny$\bullet$}}
\onehalfspacing
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
\DeclarePairedDelimiter{\norma}{\lVert}{\rVert}
\graphicspath{{./Images/}}
\usepackage{hyperref}
\hypersetup{hidelinks}
%\pagestyle{headings}
\newcommand{\Hline}{\specialrule{.1em}{0em}{0em}}
\begin{document}
\begin{titlepage}

\begin{figure}
\centering
\includegraphics[scale=0.25]{sigillo2}
\end{figure}

\begin{center}
\LARGE{\textbf{Università degli Studi di Trento\\ Department of Industrial Engineering}}\\
\vspace{10mm}
\Large{Master Degree in\\ Mechatronics Engineering}\\
\vspace{7mm}
\uppercase{Final Dissertation}
\vspace{7mm}\\
\huge{Dynamics of a Space Robot Subjected to an Impact}
\end{center}

\vspace{8mm}
\begin{flushleft}
\large{\textbf{Supervisor:}\\ Daniele Bortoluzzi}\\
\vspace{3mm}
\large{\textbf{Co-supervisor:}\\ Edoardo Dalla Ricca}\\
\vspace{3mm}
\large{\textbf{Student:}\\ Simone Manfredi 239337}\\
\end{flushleft}

\vspace{20mm}
\begin{center}
\Large{Academic Year 2023/2024}
\end{center}

\end{titlepage}

\newpage

\begin{abstract}
This thesis aims to describe, control, and simulate a planar revolute-revolute (RR) manipulator in asbence of gravity (i.e. located in space) subjected to an impact due to the docking of a tumbling satellite.\\
The actual outputs of this work are methods to retrieve the satellite mass and initial velocities, assuming them unknown in advance. Therefore, an initial guessed mass is initially implemented in the control law.\\
This work is organized as follows: the first chapter exposes an overview of the actual state-of-art of modern space maniupalators.\\ 
The second chapter introduces the basics of robotic kinematics, and the manipulator Jacobian matrix is found.\\
In the third chapter, the system equations of motion are calculated with Lagrangian-based approaches.\\
The impact analysis is carried out in the fourth chapter, where the arms are initially modeled as rigid bodies and, afterwards, as Euler-Bernoulli beams.\\
The satellite's mass and initial velocity retrieval methods are proposed in the fifth chapter, along with the results found.\\
Methods' comparison and considerations and possible further developments are listed in the sixth and last chapter.

\end{abstract}

\newpage
\pagenumbering{roman}
\addcontentsline{toc}{chapter}{Contents}
\tableofcontents
\pagestyle{styletoc}
\chapter*{Introduction}
\pagestyle{styleint}
\addcontentsline{toc}{chapter}{Introduction}
We live in a society overwhelmed by such technology, autonomous systems, industrial manipulators, AI and, very soon, services' humanoid robots, that we forget to look up in the sky. Most of the major progress in robotics and the scientific field is done in space, where human curiosity is pushing our abilities beyond any imaginable scenario.\\
Billionaires such as Elon Musk are pushing the technology even further with Mars colonization as a goal.\\
However, this great chapter of human history is still quite hidden. When someone says that he is studying Law, Economics or Literature, nobody bats an eye. Still, when I tell people that I study Mechatronics Engineering, I always have to add some more information, key words like "mechanics", "robotics" or "programming". In my opinion, this makes clear that one the most revolutionary fields (even though I acknowledge that it is a very broad term) is not really interiorized by the people, like others faculties and studies are.\\
In their defence, I must say that when I first enrolled in the university, aiming to the Mechatronics Master's Degree, I was more pushed by the unknown around that term than by real interest or passion related to it. But with the new available technology, such as the aforementioned AI, directly in our homes (and soon maybe also humanoid robots) it will become a common topic and an everyday experience.\\
Yuval Noah, in his book "Sapiens: a Brief History of Humankind" \cite{twentyseven} claims that three were the great human revolutions that completely changed our way to live and to act as social creatures: the Cognitive Revolution (around 70.000 years ago), which allowed us to think of nonexistent concepts, such as states, ethics, legends, myths, tools; the Agricultural Revolution (about 12.000 years ago) when we started to settle and grow our own food; the Industrial Revolution (200 y.a.), which is fairly known to everybody. It is not difficult to think that the next human revolution, if there is ever going to be one, will have to do with space exploration.\\
This is to say that it is a really promising and exiting field, which will (and it is already doing) play an important role in our society.\\
Far from aiming to the moon, this thesis was born due to my curiosity in the field of robotics merged with the need to face space and modern problems, such as the berthing and docking of external objects by a manipulator or the tumbling of a spinning satellite.\\
This dissertation aims to analyse the dynamic of a space manipulator after the impact with an external satellite to retrieve its kinetic and inertial properties before the impact.\\ 
The workflow was the following: a first phase was committed to gathering information about space manipulators and to study papers regarding the useful impact equations to model the docking of the satellite.\\
Secondly, a 2D manipulator model has been implemented in Wolfram 14.2, and equations of motion for the pre-impact and post-impact phases have been calculated.\\
Finally, the results have been listed, and considerations have been made.\\
The machine on which the calculations have been done is a MacBook Air M3 with $\SI{16}{\giga\byte}$ of RAM.
\vspace{0.8cm}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.15]{sapiens.jpg}
  \caption{Yuval Noah's book cover.}
\end{figure}
\clearpage
\pagenumbering{arabic}
\chapter{Space Manipulators: an Overview}\label{overview}
\pagestyle{stylenor}
When talking about space, robots play a pivotal role. "Space Robotics is important to human's overall ability to explore or operate in space. Autonomous systems can reduce the cognitive load on humans and improve human and systems' safety"~\cite{three}.\\
Space robots can be split into two categories: orbital and planetary robots. The former can be used for "repairing satellites, assembling large space telescopes, capturing and returning asteroids," etc; the latter "play a key role in surveying, observations, extraction, working on planetary surfaces for subsequential human arrival, etc"~\cite{three}.\\
Furthermore, spacecraft are classified as space robots when two attributes are satisfied: "locomotion and autonomy" \cite{three}. Locomotion is a peculiar property of robots since to perform a task, they are asked to be movable and, sometimes, maneuverable. At the same time, autonomy requires them to act without any or partial human interference, depending on the level of independence (e.g., autonomous cars can have fully self-governing algorithms, or they can help the driver reduce the probability of accidents). \\
Another classification of robotic devices in space could be represented by "mobile robots, flying robots, and manipulators. Manipulators are used on board spacecraft (Space Shuttle) or space stations"~\cite{five}.
According to \cite{one}, "a very loose definition calls every unmanned space probe a robotic spacecraft, referring to the challenges of largely autonomous operation in a complex mission. But even discarding this and focussing on space robotics elements in a more narrow sense (systems involving arms for manipulation or some kind of locomotion device for mobility and having the flexibility to perform varying tasks), there is a wide array of uses in the scope of space missions, giving rise to challenging problems and ingenious solution".\\
Robots and manipulators in space are designed to perform the following operations:
\begin{itemize}
\item capture
\item maneuvring
\item berthing/unberthing
\item support of Extra-Vehicular-Activities (EVA)
\item positioning and release
\end{itemize}
One of the most important features of all robots deployed in space is their flexibility. Robots and manipulators used in space are built out of light materials, and very often, their links deflect.\\
Soon, advanced robotics capabilities will be required. According to~\cite{three}, "in the 2025-2035 timeframe the operators for these missions may range from space administrations to national governments to businesses".\\
But what is so special about a space robot? "In many ways, robot systems for space applications are very different from the more familiar terrestrial robots, be they industrial robots in production automation or the newer kind of service robots"~\cite{one}. One of the main and simplest differences is the "high development and manufacturing costs and the missing economy of scale due to the experimental prototype nature of these developments"~\cite{one}.\\
This thesis will investigate space manipulators' dynamics, whose tasks involve berthing and docking satellites or managing tumbling meteorites; thus, a historical summary of their evolution and the actual state-of-art of this field will be briefly exposed.
\newpage
\section{Historical background}
The first robot used in space was the Remote Manipulator System (RMS), also called \textit{Canadarm}, developed by the Canadian Space Agency and installed on the Space Shuttle. Its first usage dates back to the "12th of November 1981 in the Columbia Shuttle"~\cite{five}, while its withdrawal happened in July 2011.\\
The robotic arm was 15 meters long and was equipped with six degrees of freedom (DoF), thanks to three "hinged joints for pitch and three others for yaw and roll"~\cite{five}.\\
Using the RMS in orbit involved different challenges, among which one of the most relevant was its precise positioning: since it was built out of light materials to reduce the launch costs, the arm tended to deflect significantly. Furthermore, the arm's acceleration and braking are used to generate considerable vibrations. In order to improve its positioning, two main approaches have been developed: passive and active. The passive mediation relies on structural modifications and usage of different materials, while the active ones include preshape input techniques and control systems based on "position, velocity or force feedback"~\cite{five}.\\
Different criticalities and future improvements have been identified during the RMS's operational lifetime. In particular, the necessity of increasing the speed of manipulation and improving the positioning accuracy has emerged, a crucial factor in everyday operations. Moreover, "new manipulators should be designed to include passive vibration control capabilities"~\cite{five}. In contrast, the adoption of active control techniques would allow a reduction in the settling time and improve the accuracy. Finally, integrating a force control system could enhance the operational capabilities of the manipulator.\\
A factor, however, comes to our aid when dealing with space manipulators: the absence of gravity. Such a manipulator with huge flexible arms "is not powerful enough to lift even the weight of the arm itself when on Earth"~\cite{six}. On space, in fact, the arms do not have to deal with their own weight, which would be too much to withstand.\\
One of the first space missions to include a robotic arm "was the MIR space station"~\cite{six}. This modular space station, developed by the URSS and eventually managed by Russia, operated from 1986 to 2001. "MIR was a microgravity research laboratory which conducted research in biology, astronomy, meteorology, and physics"~\cite{six}.\\
The first satellite equipped with a robotic arm was launched in 1997 by the Nastional Space Development Agency of Japan (NASDA), the ETS-VII, which "performed several succesful docking operations"~\cite{six}.\\
Eventually, a Japanese manipulator was developed and mounted on the Japanese Experiment Module at the International Space Station (ISS), the JEMRMS, in March 2008. The Small Fine Arm (SFA) was added in July 2009 (see Section~\ref{state_of_art}).\\
The evolution of the SRMS arm is the MSS arm (Mobile Servicing System), which is mounted on the International Space Station. "The MSS arm consists of a mobile base, a more advanced version of the Canadarm, called the \textit{Canadarm2}, or SSRMS, and dexterous manipulator hand"~\cite{six}. Its properties will be discussed in the next Section.\\
The special Purpose Dexterous Manipulator (SPDM), added to the MSS in March 2008, "is a two-armed robot but is often referred to as a hand because it can be attached to the Canadarm2 robotic arm and taken to any location on the space station"~\cite{six}.\\
The last manipulator in space was launched in July 2021: the European Robotic Arm (ERA) serves as the main manipulator on the Russian part of the Space Station~\cite{esa}.\\
Clearly, using manipulators in space involves recent activities; hence, a lot of research and experiments are still being conducted. This research field offers numerous starting points in analysis and technological progress.
\newpage
\section{Main characteristics}
The main difference between space manipulators and Earth-based robots is the lack of a fixed base on which the robot is mounted.\\
In a free-flying robotic system, the spacecraft’s position and orientation are actively regulated by its own actuators. This approach ensures full control over both the base and the manipulator arm.\\
However, due to the dynamic interaction between the manipulator and the spacecraft, any arm movement directly influences the base’s motion. A key challenge in such systems is the high fuel consumption needed to counteract these effects and maintain a stable base orientation \cite{six}.\\
This operational mode is beneficial during the final phase of a manipulator’s approach to its target, ensuring that the target remains within the manipulator’s reachable workspace \cite{two}.\\
Conversely, in a free-floating robotic system, the spacecraft does not rely on its actuation to correct for manipulator-induced motion. As a result, the base’s movement is not directly controlled but instead emerges naturally from the dynamic interaction between the base and the arm. In this scenario, one can either leave the spacecraft motion entirely uncontrolled, as done in this study, or leverage the manipulator to influence the spacecraft’s movement. Often, "it is necessary to generate a manipulator motion which guarantees that the spacecraft orientation remains almost constant so that antennas and other instruments point in the right direction"~\cite{six}.\\
In this mode, "the spacecraft attitude is controlled actively with momentum control devices (MCD), such as reaction wheels or momentum gyros, while the system CoM does not translate"~\cite{two}.
Despite the inherent difficulties of operating in space compared to terrestrial environments, the weightlessness of space offers certain advantages in manipulator design. Robots can be built with a high degree of redundancy and multiple joints, as they do not have to support their weight. On Earth, "such robots would collapse under their mass" if they had too many joints \cite{six}. This makes designing more redundant and fault-tolerant robotic systems in space possible, as they can continue functioning even if multiple joints fail. Additionally, the microgravity environment allows for effective motion control with smaller actuators. Many space manipulators can handle substantial payloads in orbit, whereas, under Earth’s gravity, they would struggle to support even their structure \cite{six}.\\

To carry out on-orbit operations that are either unreachable or hazardous for humans, robotic on-orbit servicing (OOS) can be utilized. These tasks are executed by space manipulator systems (SMSs), also referred to in the literature as "chasers or servicers"~\cite{two}. An SMS comprises a satellite base equipped with one or more robotic arms, each fitted with grappling mechanisms and guided "by a vision system which allows them to capture a target (client) satellite, or another object"~\cite{two}. Additionally, an SMS can be a large servicing manipulator installed on a space facility.\\
The targets for capture can be categorized based on their behavior. Cooperative targets are stable and safe due to their Attitude and Orbit Control Subsystem (AOCS) functionality. In contrast, non-cooperative targets exhibit unpredictable motion, such as tumbling objects with shifting rotational axes. Targets may also be classified as collaborative, meaning they are specifically designed for capture or servicing and are equipped with visual markers and dedicated grapple fixtures, or non-collaborative, as is the case with the majority of existing satellites. The terms cooperative and collaborative are often used interchangeably in the literature \cite{two}.\\
Ground observations frequently reveal that numerous objects in orbit are tumbling uncontrollably, making robotic capture a highly complex challenge. A servicing operation can only begin after a robotic manipulator has successfully seized and stabilized a tumbling target. As a result, a typical robotic capture sequence for on-orbit servicing consists of four key operational phases \cite{two}:
\begin{enumerate}
  \item observation and planning phase;
  \item final approach phase;
  \item impact and grasping/capture phase;
  \item post-capture stabilization phase.
\end{enumerate}
Assuming the target "locally stationary, the approach phase can be achieved by point-to-point planning and depending on the actuation mode, by simple on-off thruster control, and attitude fine-tuning using momentum exchange devices"\cite{two}. Conversely, "capturing a tumbling, non-cooperative target is more challenging, as here velocity matching between the SMS end-effector and the capture point is required"~\cite{two}.\\
To avoid impacts during the grasping phase, the difference between the velocities of the target and the end-effector should be zero. In practice, this never happens. Thus, small impacts and vibrations have to be taken into account. Research on this topic is still ongoing, focusing on bio-inspired isolation systems \cite{twentyeight,twentynine}.\\
When deploying an SMS for target capture, planning an appropriate manipulator trajectory is essential to achieving the objective. Additionally, several secondary optimization criteria can be considered, "such as obstacle and singularities avoidance, fuel consumption, and base disturbance minimization"~\cite{two,twentythree}. For instance, \cite{twentyfour} explores the optimization of the time required to reach the target.\\
For this thesis's purpose, only the impact and captured phase, along with the post-captured stabilization phase have been considered.
\newpage
\section{State-of-art}\label{state_of_art}
Low Earth Orbit (LEO), encompassing altitudes between 300 and 700 km, is the primary zone for modern manned space missions. This category includes notable programs such as the U.S. Skylab, the Space Shuttle, the Russian space station Mir, and the International Space Station (ISS). These orbits are carefully chosen: they are high enough to avoid significant destabilizing dynamic disturbances yet low enough to keep launch costs manageable~\cite{one}.\\
Beyond human physiology research, particularly the study of weightlessness effects on astronauts, "the main application field has always been a microgravity research. The term "microgravity" refers to the typical level of "weightlessness" on such manned missions: due to various disturbances (remaining atmospheric drag, moving machinery, but most of all man motion), some $\SI{e-6}{\gram}$ acceleration will continue to act on every mass"~\cite{one}.\\
Nowadays, as already mentioned, on the ISS, there are three main SMSs:
\begin{enumerate}
  \item SSRMS: Space Station Remote Manipulator System
  \item SPDM: Special Purpose Dexterous Manipulator
  \item JEMRMS: Japanese Experiment Module Remote Manipulator System
  \item ERA: European Robotic Arm
\end{enumerate}
The assembly, maintenance, and scientific operations aboard the ISS rely on three robotic manipulators, each specifically designed to fulfill a distinct role. These robotic arms are essential for executing various tasks critical to the station’s functionality.\\
All three ISS robotic manipulators are modeled after the human arm, featuring a structure miming its articulation. They are mechanically and electrically connected to the ISS at a base point, equivalent to a shoulder consisting of a series of revolute joints. Extending from the shoulder is a boom segment, followed by an elbow joint. Beyond the elbow, another boom segment leads to a set of wrist joints, culminating in an end effector that facilitates operational grappling and manipulation tasks \cite{four}.
\newpage
\subsection{SSRMS}
According to \cite{four}, "the SSRMS, or Canadarm2, is primarily used for ISS assembly". This process includes retrieving an assembly payload, either directly from the Shuttle Payload Bay or by receiving it from the Shuttle Remote Manipulator System (SRMS). Additionally, the SSRMS plays a crucial role in moving astronauts, along with any equipment they are carrying, from one location to another as they perform tasks during extravehicular activities (EVA).\\
The authors of \textit{International Space Station Robotics: A Comparative Study of ERA, JEMRMS and MSS} offer an overview on the techcnical aspects: "The 16.9m SSRMS has 7 offset joints and is symmetric about the elbow with identical 3DOF shoulder and wrist clusters (Figure \ref{SSRMS_dim}). The shoulder/wrist clusters contain three mechanical joints with perpendicular rotation axes: pitch, yaw and roll. One joint cluster acts as the shoulder while the other acts as the wrist of the manipulator. All of the SSRMS joints are functionally identical with the same performance capabilities and angular range of $\pm 270$ degrees. \\
The three pitch and two roll joints are identical and interchangeable. The two yaw joints are identical and interchangeable (the difference between the yaw and pitch/roll joints being that the yaw joints have a 5.25 inch extension non one end). Each of the joints is an ORU and each contains two identical joint electronics units and motor modules.\\
Attached to the roll joint on each cluster is a Latching End Effector (LEE) which provides a mechanical and electrical connection to a payload, SPDM or the ISS when grappling an SSRMS grapple fixture. In this way, it is possible for the robotic arm to move around the station's exterior. Each LEE also includes a Force Moment Sensor (FMS) and two identical LEE Electronics Units (LEUs). This symmetric configuration allows either end of the SSRMS to be attached to a Power and Data Grapple Fixture (PDGF) and to function as the base of the arm"~\cite{four}.\\
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.3]{SSRMS_dimensions.png}
  \caption{SSRMS Dimensions \cite{four}.}
  \label{SSRMS_dim}
\end{figure}
\begin{figure}[b]
  \centering
  \includegraphics[scale=0.35]{SSRMS_orbit.png}
  \caption{The SSRMS on orbit \cite{seven}.}
  \label{SSRMS_orbit}
\end{figure}
\newpage
\subsection{SPDM}
The SPD is a highly dexterous dual-armed robot with two shoulders supporting the arms.\\
Each manipulator arm features seven joints and ends with an Orbit Replacement Unit/Tool Changeout Mechanism (OTCM), facilitating the interface between the SPDM arm and various payloads and tools. "The SPDM is also equipped with lights, video systems, a tool platform, and four tool holders"~\cite{sheet}.\\
The primary function of the SPDM is to perform delicate maintenance and servicing tasks on the International Space Station. These tasks include installing and removing small payloads, such as batteries, power supplies, and computers; operating robotic tools like specialized wrenches and socket extensions; providing power and data connections to payloads; and manipulating, installing, removing, and inspecting scientific payloads~\cite{sheet}.\\
The SPDM operates near the Canadarm2 and can be grasped by it for relocation as needed.
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.6]{SPDM.png}
  \caption{The SPDM on orbit~\cite{nasa}.}
  \label{SPDM_orbit}
\end{figure}
\subsection{JEMRMS}
The JEMRMS system "is used primarily for experiment payload handling"~\cite{four}. It "consists of three major subsystems, the Console, Main Arm (MA), and Small Fine Arm (SFA)"~\cite{eight}.\\
With its 10m and six DoFs, the Main Arm (MA) consists of three booms, six joints, an end effector on the tip, and two vision systems (one on the shoulder, the other on the tip)\cite{eight}.\\
The Small Fine Arm (SFA) is also a six-degree-of-freedom robot arm. It can "perform more dexterous tasks than the MA. During operation, the SFA is grappled by the MA and receives power and data from the MA. The 2m SFA consists of two booms, six joints, and an end effector on the tip called the “tool,” and a camera on the tool. The tool has a force and torque sensor inside it for compliance operation"~\cite{eight}.\\
\begin{figure}[h]
  \centering
  \subfloat[][\emph{Main Arm (MA).}]
  {\includegraphics[scale=0.35]{MA.png}\label{unitary}} \quad
\subfloat[][\emph{Small Fine Arm (SFA).}]
  {\includegraphics[scale=0.35]{SFA.png}\label{normal}} 
  \caption{The JEMRMS components \cite{eight}.}
  \label{JEMRMS_components}
\end{figure}
The JEM RMS end-effector was designed based on the Shuttle RMS (SRMS) end-effector. The grapple fixtures compatible with the JEMRMS MA can also be grappled by the SSRMS \cite{four}.
\newpage
\subsection{ERA}
The ERA is used on the ISS's Russian segment (RS). Specific tasks for the ERA include: "installing, removing or replacing experiment payloads and large Station elements; transferring small payloads in and out of the Station through the Russian airlock; transporting crew members from one external working site to another; freeing cosmonauts to do other work during spacewalks; using its cameras to inspect the outside of the Space Station"~\cite{four}.\\
The ERA manipulator arm is 11.3m long and has "7 inline joints in a symmetric configuration with respect to the elbowjoint"~\cite{four} (Figure~\ref{ERA}). The shoulder has three DoFs, the elbow one, and the wrist three.\\
The arms' tip end can act as an end-effector or as a base, depending on the situation: in this way, it can move with a warm-like movement, attaching and detaching the EE to use it as the base and vice-versa.\\
The identical EE’s "are able to grapple and ungrapple an ERA grapple fixture, transferring power or data to an external device/load. The EE also has an Integrated Service Tool (IST) which is a built-in motorized "screwdriver" that can provide mechanical torque actuation"\cite{four}.\\
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.4]{ERA.png}
  \caption{ERA's components~\cite{esa}.} 
  \label{ERA}
\end{figure}
\subsection{RMSs Comparison}
To conclude, the European and Canadian's seventh degree of freedom allows them to access more trajectories and motion-planning options. In addition, obstacle avoidance and accuracy are improved.\\
Based on the maximum handling capacity, each manipulator is aided to different payload: "the SSRMS is capable of handling payloads that have an equivalent mass to the Orbiter; the ERA is designed for slightly smaller payloads such as solar panels"~\cite{four}.\\
Furthermore, since the ERA and the JEMRMS can handle smaller payloads, their overall accuracy is higher than the SSRMS one.\\
In the Table \ref{SRMs_comparison}, the SSRMS, ERA, and JEMRMS specifications are reported \cite{four}.
  \begin{table}[h]
    \caption{SSRMS, ERA and JEMRMS specifications \cite{four}.}
    \label{SRMs_comparison}
    \begin{center}
    \begin{tabular}{lccc}
      \toprule
    & \textbf{SSRMS} & \textbf{ERA} & \textbf{JEMRMS (MA)}\\
    \midrule
    Span&\SI{14.22}{\metre}&\SI{11.3}{\metre}&\SI{9.91}{\metre}\\
    Boom Span&\SI{7.11}{\metre}&\SI{7.77}{\metre}&\SI{3.93}{\metre}\\
    DOFs&7&7&6\\
    Joints&Offset&Inline&Offset\\
    Base&Relocatable&Relocatable&Fixed\\
    Positioning Accuracy&\SI{65}{\milli\metre}, \SI{0.71}{\degree}&\SI{40}{\milli\metre}, \SI{1}{\degree}&\SI{50}{\milli\metre}, \SI{1.8}{\degree}\\
    Mass&\SI{1336}{\kilogram}&\SI{630}{\kilogram}&\SI{757}{\kilogram}\\
    Max Handling Capacity&\SI{116}{\mega\gram}&\SI{8}{\mega\gram}&\SI{7}{\mega\gram}\\
    Power Consumption&\SI{1360}{\watt} (average)&>\SI{800}{\watt}&\SI{2.3}{\kilo\watt}\\
    \bottomrule
    \end{tabular}
    \end{center}
    \end{table}
\chapter{Kinematics}\label{kinematics}
What is a robot, then? In the previous chapter, we have seen an overview of the actual reality of the space robotics field, but a proper definition of a what a robot is has not been given. A robot is a re-programmable machine for manipulation, positioning, orientation, and machining of bodies able to interact with the environment, with a certain level of autonomy.\\
A robot is not just an automated machine, it is something more: it takes decisions autonomously, can do different things at different times, and is flexible.\\
According to \cite{eleven}, there are two main families of robots:
\begin{itemize}
  \item serial robots: a set of bodies rigidally connected by joints in an open kinematic chain.
  \item parallel robots: a set of bodies connected in a closed kinematic chain. They can withstand/produce a larger force.
\end{itemize}
A kinematic chain is therefore the concatenation of single degrees of freedom (i.e. the minimum amount of independent coordinates that define the robot's configuration) links. The joints can be revolute, prismatic or spherical, depending on the movement allowed by them (plane rotational, translational, or 3D rotatonal, respectively).\\
Grubler equation for palanar mechanisms gives the overall DoFs of a multibody system:
\begin{equation}
  n = 3(m-1)-2c_1-c_2
  \label{grubler}
\end{equation}
where $m$ is the number of rigid bodies attached to the base, $c_1$ and $c_2$ are class 1 and class 2 joints, respectively, depending on how many DoFs they allow (one or two). Revolute joints allow one DoF, i.e. rotation around their axes.\\
Whenever $n<n_j$, where $n_j$ is the number of joints, a redundancy occurs, meaning that the system has more joints than the dimension of the task space.\\
An essential definition for serial robots is the end defector (EE), i.e, the point of the chain dedicated to the programmed task, as shown in red in Figure \ref{end_defector}.\\
Studying the kinematics of a mechanical system (such as a robot) "refers to the calculation of the position and orientation of its end-eﬀector frame from its joint coordinates"~\cite{eleven}.\\
\begin{figure}[!]
  \centering
  \input{tikz/EE.tikz}
  \caption{2D RR (revolute-revolute) manipulator.}
  \label{end_defector}
\end{figure}
Usually, we speak of:
\begin{itemize}
  \item Forward or Direct Kinematics when, given the joints' angles, we want to find the EE position, used to define the relation between joints and EE and determine the system jacobian (see Section~\ref{jacobian_matrix});
  \item Inverse Kinematics when we want to find the joints' angles that realize a desired position at the EE, used to define the joint's time evolution to move the EE to follow a desired trajectory or to reach a desired final position (see Chapter~\ref{impact_analysis}).
\end{itemize}
We will now analyze the forward kinematics of a manipulator mounted on top of a mobile base to form a vehicle-manipulator system (VMS) that can be controlled as a whole.\\
Starting from a simple model of the VMS, it will be possible to analyze its behaviour before and after the impact with an external object (i.e. meteorite or satellite).
\newpage
\section{Fundamental of Kinematics}\label{Homogeneous}
In this thesis, the kinematics chain has been evaluated by means of the "Homogeneous Matrix Approach" shown in \cite{nine, ten}. For such an approach, a brief summary of notation is presented here.
\subsection{Roto-Translation Matrix}
Given two vectors in an $xy$ plane, only rotated without distortion, as in Figure~\ref{rotation_vectors}, the relationship between them can be found in the following way:
\begin{equation}
  v_2=\begin{bmatrix}
    v_{x_2}\\
    v_{y_2}
  \end{bmatrix}=\begin{bmatrix}
    v_{x_1}\cos{\theta}-v_{y_1}\sin{\theta}\\
    v_{x_1}\sin{\theta}+v_{y_1}\cos{\theta}
  \end{bmatrix}=\begin{bmatrix}
    \cos{\theta} & -\sin{\theta}\\
    \sin{\theta} & \cos{\theta}
  \end{bmatrix}\begin{bmatrix}
    v_{x_1}\\
    v_{y_1}
  \end{bmatrix}=R(\theta)v_1
  \label{rotation_matrix}
\end{equation}
\begin{figure}[h]
  \centering
  \input{tikz/rotation_vectors.tikz}
  \caption{Vecors $v_2$ is rotate by $\theta$ withh respect to $v_1$.}
  \label{rotation_vectors}
\end{figure}
where $R_{\theta}$ is the rotation matrix.\\
We can use the same matrix to describe another transformation, i.e. to find the coordinates of a point initially defined with respect to a mobile frame, for another frame, such as a fixed one (Figure~\ref{rotation_point}):
\begin{equation}
  \prescript{f}{}{P}=\prescript{f}{m}{R(\theta)}\prescript{m}{}{P}
\end{equation}
\begin{figure}[h]
  \centering
  \input{tikz/rotation_point.tikz}
  \caption{The same point can be described with respect to both a fixed and a rotated mobile frame (in red).}
  \label{rotation_point}
\end{figure}
The notation used here is the following: the left superscript indicates the reference frame in which the point or the vector is referred to: $\prescript{m}{}{P}$ refers to the point $P$ with coordinate written for the mobile frame. The matrix $\prescript{f}{m}{R(\theta)}$ "translates" a point described in the mobile frame to the fixed frame.\\
An important property of the rotation matrix is that it is orthogonal, which means that its inverse is equal to its transpose.\\
We can concatenate the rotational matrices such that we can describe a point in a given reference frame to another one if we know all the relative rotational matrices of the frames between the two we are interested in:
\begin{equation}
  \prescript{0}{}{P}=\prescript{0}{1}{R(\theta)}\prescript{1}{2}{R(\theta)}\prescript{2}{}{P}
  \label{concatenate}
\end{equation}
This concept can be expanded easily in the 3D case, noticing that the columns of $R(\theta)$ in (\ref{rotation_matrix}) are the unit vectors of the moving (new) frame written in the fixed (old) frame. In this way, rotation matrices along the x, y, and z axes are found \cite{six}:
\begin{equation}
  \begin{array}{c}
  R_x(\phi)=\begin{bmatrix}
    1&0&0\\
    0&\cos{\phi}&-\sin{\phi}\\
    0&\sin{\phi}&\cos{\phi}
  \end{bmatrix} \quad R_y(\psi)=\begin{bmatrix}
    \cos{\psi}&0&\sin{\psi}\\
    0&1&0\\
    -\sin{\psi}&0&\cos{\psi}
  \end{bmatrix} \\
  R_z(\theta)=\begin{bmatrix}
    \cos{\theta}&-\sin{\theta}&0\\
    \sin{\theta}&\cos{\theta}&0\\
    0&0&1
  \end{bmatrix} 
\end{array}
\label{rotation_matrices}
\end{equation}
When a translation occurs, as shown in Figure~\ref{translation}, the transformation becomes:
\begin{equation}
  \prescript{f}{}{\{O_fP\}}=\prescript{f}{}{\{O_fO_m\}}+\prescript{f}{}{\{O_mP\}}=\prescript{f}{}{\{O_fO_m\}}+\prescript{m}{f}{R}\prescript{m}{}{\{O_mP\}}
\end{equation}
which can be written as follows:
\begin{equation}
  \prescript{f}{}{\begin{bmatrix}
    O_fP_x\\
    O_fP_y\\
    O_fP_z\\
    1
  \end{bmatrix}}=\begin{bmatrix}
    \prescript{f}{m}{R}&\prescript{f}{}{\begin{bmatrix}
      O_fO_mx\\
      O_fO_my\\
      O_fO_mz\\
    \end{bmatrix}}\\
    \mathbf{0}&1
  \end{bmatrix}\prescript{m}{}{\begin{bmatrix}
      O_mP_x\\
      O_mP_y\\
      O_mP_z\\
      1
    \end{bmatrix}}=\prescript{f}{m}{M}\prescript{m}{}{\begin{bmatrix}
      O_mP_x\\
      O_mP_y\\
      O_mP_z\\
      1
    \end{bmatrix}}
\label{roto_translation}
\end{equation}
where $\mathbf{0} \in \mathbb{R}^{3\times1}$ and $\prescript{m}{f}{M} \in \mathbb{R}^{4\times4}$ is called the \textit{Roto-Translational Matrix} or \textit{Homogeneous Transformation Matrix}, for which the same properties seen in equation~(\ref{concatenate}) hold. A fourth component has been appended at the end of the vectors, which is 1, since the Homogeneous Matrix would have had three rows but four columns otherwise. In this way it is squared and invertible, and $\prescript{0}{1}{M}^{-1}=\prescript{1}{0}{M}$.
\begin{figure}[h]
  \centering
  \input{tikz/translation_point.tikz}
  \caption{Definition of a point in a rotated and translated frame with respect to the fixed one. The position of $P$ for the fixed frame (red arrow) can be seen as the sum of the position of the moving frame $O_m$ with respect to $O_f$ and the relative position of $P$ in the moving frame, both in blue.}
  \label{translation}
\end{figure}
\newpage
\subsection{Velocity Matrix}\label{velocity_section}
Given the same point in Figure~\ref{translation} it is possible to find the velocity of the point concerning the fixed frame. By derivation of equation (\ref{roto_translation}) one can get:
\begin{equation}
  \prescript{f}{}{\{\dot{O_fP}\}}=\prescript{f}{m}{\dot{M}}\prescript{m}{}{\{O_mP\}}+\prescript{f}{m}{M}\prescript{m}{}{\{\dot{O_mP}\}}
\end{equation}
and since $\prescript{m}{}{\{\dot{O_mP}\}}=0$, assuming the point fixed in the mobile frame, and $\prescript{m}{}{\{O_mP\}}=\prescript{m}{f}{M}\prescript{f}{}{\{O_fP\}}$:
\begin{equation}
  \prescript{f}{}{\{\dot{O_fP}\}}=\prescript{f}{m}{\dot{M}}\prescript{m}{f}{M}\prescript{f}{}{\{O_fP\}}=\prescript{f}{}{W}\prescript{f}{}{\{O_fP\}}
  \label{velocity_matrix}
\end{equation}
with $\prescript{f}{}{W}$ the \textit{Velocity Matrix}.\\
The Velocity Matrix can be generalized as follows \cite{nine}:
\begin{equation}
  W=\begin{bmatrix}
    0&-\omega_z&\omega_y&v_x\\
    \omega_z&0&-\omega_x&v_y\\
    -\omega_y&\omega_x&0&v_z\\
    0&0&0&0
  \end{bmatrix}
\end{equation}
where $\omega$ indicates the angular velocity of the body and $v$ is the velocity of the point, considered belonging to the body that in a considered instant is passing through the origin of the reference frame.\\
The composition of the Velocity Matrix follows the Rival's Theorem (see Figure~\ref{rival}):
\begin{equation}
  \prescript{n}{}{W_{02}}=\prescript{n}{}{W_{01}}+\prescript{n}{}{W_{12}}
  \label{velocity_composition}
\end{equation}
\begin{figure}[h]
  \centering
  \input{tikz/rivals_theorem.tikz}
  \caption{Rival's Theorem for velocities composition. The three transformation $W_{01}$, $W_{12}$ and $W_{02}$ are also called \textit{Drag Motion}, \textit{Relative Motion} and \textit{Absolute Motion} respectively.}
  \label{rival}
\end{figure}
which is true only when all the matrices are projected in the same frame $n$.\\
The notation used in equation (\ref{velocity_composition}) has to be read in the following way: $\prescript{n}{}{W}_{02}$ is the Velocity Matrix of frame two with respect to frame zero, projected in frame $n$.\\
It is also possible to change the frame in which the matrix is projected:
\begin{equation}
  \prescript{m}{}{W}=\prescript{m}{n}{M}\prescript{n}{}{W}\prescript{n}{m}{M}
  \label{change_frame}
\end{equation}

Some attention must also be given to the matrix representing a "boolean" interpretation of the rotation: the $L$ matrix. For the aim of this thesis, and as it is introduced in \cite{ten}, this matrix can be easily obtained from its Velocity Matrix by dividing it by the module of its angular (or linear, when there is translation) velocity:
\begin{equation}
  L=\frac{W}{|\omega|}
  \label{L_matrix}
\end{equation}
where $|\omega|=\sqrt{\omega_x^2+\omega_y^2+\omega_z^2}$.\\
Given the robotic focus of this work, these calculations will be quite straightforward once the axis of rotation of a link is known. For a revolute joint, for example, the Velocity Matrix with respect to the joint frame will be:
\begin{equation}
  W=\begin{bmatrix}
    0&-\dot{\alpha}&0&0\\
    \dot{\alpha}&0&0&0\\
    0&0&0&0\\
    0&0&0&0
  \end{bmatrix}
\end{equation}
with $\dot{\alpha}=\omega_z$, and the "logic" of the rotation is thus given by $L$:
\begin{equation}
  L=\frac{W}{\dot{\alpha}}=\begin{bmatrix}
    0&-1&0&0\\
    1&0&0&0\\
    0&0&0&0\\
    0&0&0&0
  \end{bmatrix}
  \label{L_matrix}
\end{equation}
\newpage
\subsection{Danavit-Hartenberg Method}
To define the reference frames fixed to the links of a serial manipulator, one can follow the Danavit-Hartenberg algorithm, which guarantees a coherent and functional method through all the calculations. It has been thought of for robots with revolute joints.\\
It follows these ordered procedures:
\begin{enumerate}
  \item $z_i$ axis: axis of the revolute joint that connects the link to the following.
  \item $x_i$ axis: line of minimum distance between $z_{i-1}$ and $z_i$, oriented from $z_{i-1}$ to $z_i$.
  \item $y_i$ axis: obtained by the vectorial product of the other two axes.
\end{enumerate}
In Figure~\ref{DH}, a DH convention for a planar serial manipulator has been used for the configuration shown in Figure~\ref{end_defector}.
\begin{figure}[h]
  \centering
  \input{tikz/DH.tikz}
  \caption{The Danavit-Hartenberg rule has been used to place the local joints' frame (in red) in a planar RR manipulator, with arms length $l_1$ and $l_2$, mounted on top of a disk-shaped base (in green). The rotated frame of the base of the angle $\theta_o$ has been plotted in blue. Following the hand rule, the z-axis is orthogonal to the plane.}
  \label{DH}
\end{figure}
\subsection{Jacobian Matrix}\label{jacobian_matrix}
Another important matrix in the analysis of a manipulator is the so-called \textit{Jacobian Matrix}.\\
As already said, studying the direct kinematics of a manipulator means finding the relationship between the end-effector position and orientation and its joints. When writing the position of the EE (denoted by S), we obtain a function of the robot's joints:
\begin{equation}
  S=f(q_1,q_2,\dots,q_n)
  \label{EE_position}
\end{equation}
where $q_i$ are the manipulators DoFs.\\
By derivation of (\ref{EE_position}) one can obtain:
\begin{equation}
  \dot{S}=J_a\dot{Q}
  \label{task_dimension}
\end{equation}
where $J_a$ is the \textit{Analytical Jacobian Matrix} and $Q=\{q_1,q_2,\dots,q_n\}$.\\
Its dimension is significant, since kinematic singularities, which are the configurations in which the end-eﬀector frame loses the ability to move or rotate in one or more directions (i.e. it loses one or more DoFs), "correspond to those configurations at which the Jacobian matrix fails to have maximal rank"~\cite{eleven}, where the rank is defined as the number of indipendent rows or couloumn of the matrix.\\
Singularities happen if the open-chain robot is kinematically redundant, meaning, as already mentioned, that it has more joints than the dimension of the task space. The inverse of the jacobian doesn't exist anymore, since the inversion requires a squared full rank matrix, and the inverse kinematics is not possible ($\dot{Q}=J_a^{-1}\dot{S} $ and $J_a^{-1}$ does not exist in singular configuartions). When this occurs, the pseudoinverse or \textit{Moore-Penrose Inverse} matrix, denoted by $J^+$, must be used:
\begin{equation}
  \begin{cases}
    J^+=(J^TJ)^{-1}J^T \quad \text{when J has linearly indipendent comlumns}\\
    J^+=J^T(JJ^T)^{-1} \quad \text{when J has linearly indipendent rows}
  \end{cases}
  \label{pseudoinverse}
\end{equation}
In robotics, the most common case is the one with a Jacobian with linearly independent columns, since it's common to have more links than dimensions in the task space (as it is the case for the ERA and SSRMS).
\newpage
\section{Planar Vehicle-Manipulator System}\label{planar_VMS}
It will now be presented a simple case of Vehicle-Manipulator System, consisting in a base approximated with a disk and a planar serial manipulator whose revolute joints move around their z axis, orthoginal to the plane (as the one shown in Figure~\ref{DH}).\\
Since this work aims to study the system's dynamics after catching a tumbling object, its kinematics will be analyzed too, by considering it as a disk.\\
Firstly, let's define the DoFs of the VMS, which will be:
\begin{equation}
  p=\{x_b,y_b,\theta_b,q_1,q_2\}
\end{equation}
It is already clear that, being in the 2D case, the number of DoFs is greater than the dimension of the task space (i.e. $5>2$). In fact, from (\ref{grubler}), given $m=3$ (base and two arms) and $c_1=2$ (two revolute joints), we have $n=2$, while $p\in\mathbb{R} ^5$.\\ 
This means that a redundancy occurs and the pseudoinverse jacobian must be used instead of the inverse one, when needed.\\
The generalized coordinates of the tumbling object are the following:
\begin{equation}
  \psi=\{x_O,y_O,\theta_O\}
  \label{object_coordinates}
\end{equation}
Since the links rotate only around the local z-axis, given equations (\ref{rotation_matrices}) and (\ref{roto_translation}), the roto-translation matrices of the manipulator chain have the following form:
\begin{equation}
  \prescript{a}{f}{M}=
  \begin{bmatrix}
    \cos{\alpha}&-\sin{\alpha}&0&p_1\\
    \sin{\alpha}&\cos{\alpha}&0&p_2\\
    0&0&1&p_3\\
    0&0&0&1
  \end{bmatrix}
\end{equation}
where $p_1,p_2,p_3$ are the coordinates of the following moving frame in the chain projected in the actual frame.\\
Following the notation of Figure~\ref{DH}, the matrices are then given:
\begin{equation}
  \begin{array}{c}
    \prescript{f}{b}{M}=\begin{bmatrix}
      1&0&0&x_b\\
    0&1&0&y_b\\
    0&0&1&0\\
    0&0&0&1
    \end{bmatrix}\quad
    \prescript{b}{0}{M}=\begin{bmatrix}
      \cos{\theta_0}&-\sin{\theta_0}&0&0\\
      \sin{\theta_0}&\cos{\theta_0}&0&0\\
      0&0&1&0\\
      0&0&0&1
    \end{bmatrix}\\ \\
    \prescript{0}{1}{M}=\begin{bmatrix}
      \cos{q_1}&-\sin{q_1}&0&l_1\cos{q_1}\\
      \sin{q_1}&\cos{q_1}&0&l_1\sin{q_1}\\
      0&0&1&0\\
      0&0&0&1
    \end{bmatrix}\quad
    \prescript{1}{2}{M}=\begin{bmatrix}
      \cos{q_2}&-\sin{q_2}&0&l_2\cos{q_2}\\
      \sin{q_2}&\cos{q_2}&0&l_2\sin{q_2}\\
      0&0&1&0\\
      0&0&0&1
    \end{bmatrix}
  \end{array}
\end{equation}
with $l_1$ and $l_2$ the lenghts of the two arms.\\
The origin of the frames written in the fixed one can be found by multiplying the Homogeneous Matrix by $O_3=\{0,0,0,1\}$. Thus, the end-defector position is:
\begin{equation}
  p_{EE}=\prescript{0}{2}{M}O_3= \begin{bmatrix}
    l_1\cos{(\theta_0+q_1)}+l_2\cos{(\theta_0+q_1+q_2)}+x_b\\
    l_1\sin{(\theta_0+q_1)}+l_2\sin{(\theta_0+q_1+q_2)}+y_b\\0\\1
   \end{bmatrix}
   \label{EE_position}
\end{equation}
with $\prescript{0}{3}{M}=\prescript{f}{b}{M}\prescript{b}{0}{M}\prescript{0}{1}{M}\prescript{1}{2}{M}$ for the chain rule (\ref{concatenate}).\\
The Jacobian Matrix is then obtained by deriviation of $p_{EE}$ with respect to the VMS DoFs $p$ such that $\dot{p}_{EE}=J\dot{p}$:

\begin{equation}
  \begin{tiny}
  J=\begin{bmatrix}
    1&0&-l_1\sin{(\theta_0+q_1)}-l_2\sin{(\theta_0+q_1+q_2)}&-l_1\sin{(\theta_0+q_1)}-l_2\sin{(\theta_0+q_1+q_2)}&-l_2\sin{(\theta_0+q_1+q_2)}\\
    0&1&l_1\cos{(\theta_0+q_1)}+l_2\cos{(\theta_0+q_1+q_2)}&l_1\cos{(\theta_0+q_1)}+l_2\cos{(\theta_0+q_1+q_2)}&l_2\cos{(\theta_0+q_1+q_2)}
  \end{bmatrix}
\end{tiny}
\end{equation}
As already forecasted, the Jacobian Matrix is rectangular, i.e. $J\in \mathbb{R}^{2\times5}$, thus not invertible.\\
Following equation (\ref{velocity_matrix}), the Velocity Matrices can be found as $\prescript{f}{}{W}=\prescript{f}{m}{\dot{M}}\prescript{m}{f}{M}$:
\begin{equation}
  \begin{array}{c}
    \prescript{f}{}{W_{fb}}=\prescript{f}{b}{\dot{M}}\prescript{b}{f}{M}=\begin{bmatrix}
      0&0&0&\dot{x_b}\\
      0&0&0&\dot{y_b}\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix} \quad
    \prescript{b}{}{W_{b0}}=\prescript{b}{0}{\dot{M}}\prescript{0}{b}{M}=\begin{bmatrix}
      0&-\dot{\theta}_0&0&0\\
     \dot{ \theta}_0&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}\\ \\
    \prescript{1}{}{W_{01}}=\begin{bmatrix}
      0&-\dot{q}_1&0&0\\
      \dot{q}_1&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix} \quad
    \prescript{2}{}{W_{12}}=\begin{bmatrix}
      0&-\dot{q}_2&0&0\\
      \dot{q}_2&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
  \end{array}
\end{equation}
where the notation is the same as equation (\ref{composition}).\\
Since it is of our interest (see Chapter \ref{dynamics}) to write all the velocity matrices projected in the fixed frame, following equation (\ref{change_frame}), it is possible to write:
\begin{equation}
    \prescript{f}{}{W_{b0}}=\prescript{f}{b}{M}\prescript{b}{}{W_{b0}}\prescript{b}{f}{M}=\begin{bmatrix}
      0&-\dot{\theta}_0&0&y_b \dot{\theta_0}\\
      \dot{\theta}_0&0&0&-x_b \dot{\theta_0}\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
  \label{W_bo}
\end{equation}
Finally, now that both $\prescript{f}{}{W_{fb}}$ and $\prescript{f}{}{W_{b0}}$ are projected in the same frame, following equation (\ref{concatenate}):
\begin{equation}
    \prescript{f}{}{W_{f0}}=\prescript{f}{}{W_{fb}}+\prescript{f}{}{W_{b0}}=\begin{bmatrix}
      0&-\dot{\theta}_0&0&\dot{x_b}+y_b \dot{\theta_0}\\
      \dot{\theta}_0&0&0&\dot{y_b}-x_b \dot{\theta_0}\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
    \label{arm_1_vel}
\end{equation}
and the same holds for $\prescript{f}{}{W_{f1}}$ and $\prescript{f}{}{W_{f2}}$, whose $3\times 3$ submatrices, related to the angular velocity, are:
  \begin{equation}
    \begin{array}{c}
      \prescript{f}{}{W_{{f1}_{1:3,1:3}}}=\begin{bmatrix}
        0&-\dot{\theta}_0-\dot{q}_1&0\\
        \dot{\theta}_0+\dot{q}_1&0&0\\
        0&0&0
      \end{bmatrix} \quad
      \prescript{f}{}{W_{{f2}_{1:3,1:3}}}=\begin{bmatrix}
        0&-\dot{\theta}_0-\dot{q}_1-\dot{q}_2&0\\
        \dot{\theta}_0+\dot{q}_1+\dot{q}_2&0&0\\
        0&0&0
      \end{bmatrix}
    \end{array}
    \label{arms_velocity}
  \end{equation}
\\
We could have calculated $\prescript{f}{}{W_{f0}}$ using equation (\ref{velocity_matrix}) as well ($\prescript{f}{}{W_{f0}}=\prescript{f}{0}{\dot{M}}\prescript{0}{f}{M}$). However, it is also useful to have the relative velocity matrices to calculate the corresponding $L$ matrices (see equation (\ref{L_matrix})):
\begin{equation}
  \begin{array}{c}
    \prescript{f}{}{L_{{fb}_x}}=\begin{bmatrix}
      0&0&0&1\\
      0&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix} \quad
    \prescript{f}{}{L_{{fb}_y}}=\begin{bmatrix}
      0&0&0&0\\
      0&0&0&1\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}\\ \\
    \prescript{b}{}{L_{b0}}=\prescript{0}{}{L_{01}}=\prescript{1}{}{L_{12}}=\begin{bmatrix}
      0&-1&0&0\\
      1&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
  \end{array}
  \label{L_matrices}
\end{equation}
where $\prescript{f}{}{L_{{fb}_x}}$ and $\prescript{f}{}{L_{{fb}_y}}$ have been found such that $\prescript{f}{}{L_{fb}}=\prescript{f}{}{L_{{fb}_x}}+\prescript{f}{}{L_{{fb}_y}}$.\\
By projecting in the fixed frame:
\begin{equation}
  \prescript{f}{}{L_{b0}}=\begin{bmatrix}
    0&-1&0&y_b\\
    1&0&0&-x_b\\
    0&0&0&0\\
    0&0&0&0
  \end{bmatrix}
\end{equation}
which is $\prescript{f}{}{W_{b0}}/ \dot{\theta}_0$ from equation (\ref{W_bo}).
\newpage
\subsection{Object's Kinematics}
For the planar case, the object to be captured (might it be a satellite or a micro-meteorite) is approximated with a  disk, in the same way we did for the base of the VMS.\\
The goal of the object's kinematics is to find the relationship between the velocity of its center and the velocity of the contact point ($c_p$), as suggested in \cite{twelve}.\\
Hence, the Homogeneous Matrices related to the tumbling object are the following:
\begin{equation}
  \begin{array}{c}
    \prescript{f}{O_0}{M}=\begin{bmatrix}
      1&0&0&x_O\\
    0&1&0&y_O\\
    0&0&1&0\\
    0&0&0&1
    \end{bmatrix}\quad
    \prescript{O_0}{O_1}{M}=\begin{bmatrix}
      \cos{\theta_O}&-\sin{\theta_O}&0&0\\
      \sin{\theta_O}&\cos{\theta_O}&0&0\\
      0&0&1&0\\
      0&0&0&1
    \end{bmatrix}\\
    \\
    \prescript{O_1}{O_2}{M}=\begin{bmatrix}
      \cos{\gamma}&-\sin{\gamma}&0&r \cos{\gamma}\\
      \sin{\gamma}&\cos{\gamma}&0&r \sin{\gamma}\\
      0&0&1&0\\
      0&0&0&1
    \end{bmatrix}
  \end{array}
\end{equation}
with the coordinates of the object as in (\ref{object_coordinates}), $\gamma$ the angle between the object's local frame and the position of the contact point (see Figure~\ref{contact_point}), and $r$ the radius of the disk.\\
\begin{figure}[h]
  \centering
  \input{tikz/disk.tikz}
  \caption{Tumbling object disk approximation.}
  \label{contact_point}
\end{figure}
As for the previous case, the position of the contact point with respect to the fixed frame is found with the chain rule:
\begin{equation}
  \prescript{f}{}{c_p}=\prescript{f}{O_0}{M}\prescript{O_0}{O_1}{M}\prescript{O_1}{O_2}{M}\prescript{O_1}{}{c_p}=\begin{bmatrix}
    x_O + r \cos{(\theta_O+\gamma)}\\
    y_O + r \sin{(\theta_O+\gamma)}
  \end{bmatrix}
\end{equation}
By deriving the position of the contact point with respect to the object coordinates $\psi$, we obtain the object Jacobian Matrix:
\begin{equation}
  J_O=\begin{bmatrix}
    1&0&-r\sin{(\theta_O+\gamma)}\\
    0&1&r\cos{(\theta_O+\gamma)}
  \end{bmatrix}
  \label{object_jacobian}
\end{equation}
which is still not squared ($J_O \in \mathbb{R}^{2 \times 3}$), thus not invertible.\\

Regarding the velocity matrix, we are not intersted in $\prescript{f}{}{W_{fO_2}}$, since we can find the velocity of the contact point by just derivation with respect of time. Instead, it will be useful in the next chapter to have $\prescript{f}{}{W_{O_0O_1}}$, which is the velocity of frame one with respect to frame zero, projected in the fixed frame: 
\begin{equation}
  \prescript{f}{}{W_{O_0O_1}}=\begin{bmatrix}
    0&-\dot{\theta}_O&0&y_O \dot{\theta_O}\\
    \dot{\theta}_O&0&0&-x_O \dot{\theta_O}\\
    0&0&0&0\\
    0&0&0&0
  \end{bmatrix}
\end{equation}
which is very similar to (\ref{W_bo}). Hence, in the same way we did in the previous section, we can retrieve the following matrices:
\begin{equation}
  \begin{array}{c}
    \prescript{f}{}{L_{{fO}_x}}=\begin{bmatrix}
      0&0&0&1\\
      0&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix} \quad
    \prescript{f}{}{L_{{fO}_y}}=\begin{bmatrix}
      0&0&0&0\\
      0&0&0&1\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}\\ \\
    \prescript{f}{}{L_{O_0O_1}}=\begin{bmatrix}
      0&-1&0&y_O\\
      1&0&0&-x_O\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
  \end{array}
\end{equation}
\chapter{Dynamics}\label{dynamics}
The dynamics analysis of a mechanical system consists of studying how the system evolves according to the present actions, given by motors and/or the external world. If the kinematics analysis is used to describe the motion, the dynamics one studies its causes~\cite{eleven}. For a robotic system, the forces involved are usually the torques applied at the joints and, in this case, also the forces applied to the base.\\
The analysis can be:
\begin{itemize}
  \item Direct: from the torques applied by the motors, the motion is calculated;
  \item Inverse: given the motion, we calculate the forces and torques that produce that motion.
\end{itemize}
The former problem requires differential calculation, while the latter is algebraic.\\
In this thesis, both problems will be studied: given the impact of the tumbling object with the VMS, we want to analyse the motion of the system after the impact; however, we also want to find a control algorithm to be applied at the joints to stabilize the system after the impact.\\
Before writing the dynamic equations, we want to find a relationship between the forces at the end-effector and the forces at the joints, that is, given a \textit{wrench}~\textbf{w} (force~+~moment) applied at the end-effector, compute the joints' torques $\tau_w$ generated by it.\\
The power at the joints is given by:
\begin{equation}
  P_{\tau}=\tau_w^T\dot{q}
\end{equation}
where $q \in \mathbb{R}^n$ is the vector of joint variables and  $\tau_w \in \mathbb{R}^n$ is the vector of forces and torques applied to the joints because of $w$.\\
The power at the end-effector is:
\begin{equation}
  P_e=w^Tv
\end{equation}
with $v$ the velocity of the wrench. Since $P_\tau=P_e$ and given the relationship from (\ref{task_dimension}), we can write:
\begin{equation}
  \tau_w^T\dot{q}=w^Tv=w^TJ\dot{q} \quad \forall\dot{q}
\end{equation}
with $J$ the Jacobian matrix. Hence:
\begin{equation}
  \tau_w^T=w^TJ \quad \Rightarrow \quad \tau_w=J^Tw
  \label{force_jacobian}
\end{equation}
The dynamic equations, also referred to as the equations of motion, are a set of second-order differential equations of the form:
\begin{equation}
  M(q)\ddot{q}+C(q,\dot{q})=u+J^T(q)w
  \label{equation_motion}
\end{equation}
where $u \in \mathbb{R}^n$ is the vector of joint forces and torques, $M(q) \in \mathbb{R}^{n \times n}$ is a symmetric positive-definite \textit{Mass Matrix}, and $C(q,\dot{q}) \in \mathbb{R}^n$ are forces that lumped together centripetal, Coriolis, gravity and friction terms that depend solely on $q$ and $\dot{q}$ \cite{eleven}.\\
Given the nature of the problem (direct or inverse), solving these equations allows us to find the motion or the torques.\\
Different methods exist to find the equations of motion, such as the Newton-Euler method and the Lagrangian one. In this thesis, the latter will be used, both in a "classic" scalar approach and in the Homogeneous Matrix approach shown in \cite{ten}.
\newpage
\section{Classic Approach}
The Lagrangian approach is an energy-based one, which allows to find the dynamic equations in a symbolic closed form. Particularly, the method involves the calculation of the kinetic and potential energy of the system.\\
For a point mass in $\mathbb{R} ^3$, the kinetic energy is expressed as:
\begin{equation}
  T=\frac{1}{2}mv^Tv
\end{equation}
and for a system of point masses:
\begin{equation}
  T=\frac{1}{2}\sum_{i=1}^N m_iv_i^Tv_i
\end{equation}
A rigid body that moves in space has:
\begin{itemize}
  \item $v_c \in \mathbb{R} ^3$: linear velocity (of the centre of mass);
  \item $\omega_c \in \mathbb{R} ^3$: angular velocity (all points of the body).
\end{itemize}
Hence, the kinetic energy of a rigid body of volume $V$ is:
\begin{equation}
  \begin{split}
  T&=\frac{1}{2}\int_{V}v^Tv\,dm=\frac{1}{2}\int_{V}(v_c+\omega\times P)^T(v_c+\omega \times P)\,dm\\
  & =\frac{1}{2}\int_{V}v_c^Tv_c\,dm+\frac{1}{2}\int_{V}v_c^T[\omega]_{\times}P\,dm+\frac{1}{2}\int_{V}(\omega \times P)^T(\omega \times P)\,dm
\end{split}
\label{kinetic_body}
\end{equation}
where $P$ is the position of the infinitesimal mass $\,dm$ with respect to the centre of mass.\\
From the first term of equation (\ref{kinetic_body}) the velocity vectors can be taken out of the integral; from the second term the velocity vector and the skew matrix of the angular velocity can be taken out and the integral becomes zero, because of the centre of mass theroem (i.e. $\int_{V}P\,dm=0$). Hence, the kinetic energy becomes:
\begin{equation}
  \begin{split}
    T&=\frac{1}{2}v_c^Tmv_c+\frac{1}{2}\int_{V}(-[P]_{\times}\omega)^T(-[P]_{\times}\omega)\,dm\\
    &=\frac{1}{2}v_c^Tmv_c+\frac{1}{2}\int_{V}-\omega^T[P]_{\times}[P]_{\times}\omega\,dm\\
    &=\frac{1}{2}v_c^Tmv_c+\frac{1}{2}\omega^T\int_{V}-[P]_{\times}[P]_{\times}\,dm \ \omega\\
    &=\frac{1}{2}v_c^Tmv_c+\frac{1}{2}\omega^T I \omega
  \end{split}
  \label{final_kinetic_body}
\end{equation}
since $(-[P]_{\times}\omega)^T=\omega^T-[P]_{\times}^T=\omega^T[P]_{\times}$.\\
The first term of equation (\ref{final_kinetic_body}) refers to the translational part (i.e. the kinetic energy of the point mass at the centre of mass), while the second to the rotational kinetic energy of the whole body, which takes into account the inertial distribution through the \textit{Tensor of Inertia} with respect to the centre of mass: $I \in \mathbb{R}^{3\times 3}$.\\

The potential energy, on the other hand, will not be taken into consideration in this Chapter since in outer space there is no gravity and we are assuming the system to be composed only of rigid bodies: no elastic deformation is taken into account. This assumption will be removed in the next Chapter when dealing with elastic arms.\\

Finally, it is possible to write the Lagrangian formulation:
\begin{equation}
  \mathcal{L} (q,\dot{q}) \triangleq \sum_{i=1}^NT_i-U_i
\label{energy_sum}
\end{equation}
where $N$ is the number of bodies and $L$ is the \textit{Lagrangian Function}.\\
The equations of motion can now be expressed in terms of the Lagrangian as follows \cite{eleven}:
\begin{equation}
  \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_i}-\frac{\partial \mathcal{L} }{\partial q_i}=f_i
  \label{lagrangian} 
\end{equation}
with $f_i$ the non-lagrangian, non-conservative forces (external/dissipative) performing work on $q_i$. The number of equations obtained is equal to the number of DoFs of the system.\\

Regarding the planar VMS seen in Section~\ref{planar_VMS} it is possible to write the position of the centre of mass of each body using the same approach of equation (\ref{EE_position}): $p_{c_b}=O_b=\prescript{f}{b}{M}\{0,0,0,1\}^T$, $p_{c_1}=\prescript{b}{1}{M}\{-\frac{l_1}{2},0,0,1\}^T$ and $p_{c_2}=\prescript{1}{2}{M}\{-\frac{l_2}{2},0,0,1\}^T$, since the position of the centre of mass of each arm is located in its middle point and the local frame is located at the end of the arm.\\
Now, $v_{c_b}$, $v_{c_1}$, and $v_{c_2}$ can be found by derivation of the position vectors, and the translational part of the kinetic energy (\ref{final_kinetic_body}) can be computed.\\
In order to find the rotational part, the tensors of inertia of the disk and the two arms are needed. Table~\ref{inertia_moments} reports the moments of inertia.\\
\begin{table}
  \caption{Moments of inertia of the planar VMS' bodies, with respect to their centre of mass (in the centre of the base and the arms), with $i=\{1,2\}$.}
  \label{inertia_moments}
  \begin{center}
  \begin{tabular}{lccc}
    \toprule
  \textbf{Body} & \textbf{Tensor of Inertia}\\
  \midrule
  Base&$\begin{bmatrix}
    \frac{1}{4}m_br^2&0&0\\
    0&\frac{1}{4}m_br^2&0\\
    0&0&\frac{1}{2}m_br^2
  \end{bmatrix}$\\
  \\
  Arms&$\begin{bmatrix}
    0&0&0\\
    0&\frac{1}{12}m_il_i^2&0\\
    0&0&\frac{1}{12}m_il_i^2
  \end{bmatrix}$\\
  \bottomrule
  \end{tabular}
  \end{center}
  \end{table}
Since the rotation happens to be only around the orthogonal axis of the plane (following the Denavit-Hartenberg formulation, the z-axis), we will use only $I_z$:
\begin{equation}
  \begin{array}{l}
  T_b=v_{c_b}m_bv_{c_b}^T+\frac{1}{2}I_{b_z}\omega_{b_z}^2\\
  T_1=v_{c_1}m_1v_{c_1}^T+\frac{1}{2}I_{1_z}\omega_{1_z}^2\\
  T_2=v_{c_2}m_2v_{c_2}^T+\frac{1}{2}I_{2_z}\omega_{2_z}^2
  \end{array}
  \label{kin_energy}
\end{equation}
with $\omega_{b_z}$, $\omega_{1_z}$ and $\omega_{2_z}$ the angular velocities extrapolated from the Velocity Matrices in equations (\ref{arm_1_vel}, \ref{arms_velocity}).\\
As already said, $\mathcal{L}$ is only the sum of the three contribution of equation (\ref{kin_energy}) and, since we have five DoFs ($p \in \mathbb{R} ^5$), there will be five lagrangian equations, one for each genralized coordinate.\\
The non-lagrangian are called this way because they are not captured by the Lagrange equation: if the conservative part of the forces is captured by $\mathcal{L}$, the non-lagrangians are the ones which are not captured by any energy.\\ 
\begin{figure}[h]
  \centering
  \input{tikz/forces.tikz}
  \caption{Forces and torques applied to the base ($F_x,F_y,\tau_0$) and to the links ($\tau_1,\tau_2$). Note that the torque of the first arm affects the base, and the torque of the second arm affects the first arm.}
  \label{forces}
\end{figure}
In this case, they are the torques and forces applied to the base and the manipulator's links (see Figure~\ref{forces}):
\begin{equation}
  \begin{array}{l}
  f_1=F_x\cos{\theta_0}-F_y\sin{\theta_0}\\
  f_2=F_x\sin{\theta_0}+F_y\cos{\theta_0}\\
  f_3=\tau_0\\
  f_4=\tau_1\\
  f_5=\tau_2
  \end{array}
  \label{non_lagrangian}
\end{equation}
Since the kinetic energy is written with respect to the fixed frame, the forces are projected in that frame through $\theta_0$.\\
Equation (\ref{lagrangian}) can now be written as:
\begin{equation}
  \begin{cases}
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{x}_b}-\frac{\partial \mathcal{L} }{\partial x_b}=F_x\cos{\theta_0}-F_y\sin{\theta_0}\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{y}_b}-\frac{\partial \mathcal{L} }{\partial y_b}=F_x\sin{\theta_0}+F_y\cos{\theta_0}\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{\theta}_0}-\frac{\partial \mathcal{L} }{\partial \theta_0}=\tau_0\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_1}-\frac{\partial \mathcal{L} }{\partial q_1}=\tau_1\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_2}-\frac{\partial \mathcal{L} }{\partial q_2}=\tau_2
  \end{cases}
\end{equation}
After having solved these five equations, it is possible to gather them together in a vectorial form, such as in (\ref{equation_motion}), with $M\in\mathbb{R}^{5\times 5}$, $C\in \mathbb{R}^5$ and $u\in\mathbb{R}^{5\times 5}$. The mass and Coriolis matrices can be seen in Appendix~\ref{appendix_matrices}.
\newpage
\subsection{Object's Dynamics}\label{object_dynamics}
The same approach can be implemented for the object to be captured: since it is approximated as a disk, its moment of inertia is equal to the base's one.\\
The kinetic energy is then:
\begin{equation}
  T_O=v_Om_Ov_O^T+\frac{1}{2}I_{O_z}\theta_O^2
\end{equation}
and the non-lagrangian components:
\begin{equation}
  \begin{array}{l}
  f_{O_1}=F_{O_x}\cos{\theta_O}-F_{O_y}\sin{\theta_O}\\
  f_{O_2}=F_{O_x}\sin{\theta_O}+F_{O_y}\cos{\theta_O}\\
  f_{O_3}=\tau_O
  \end{array}
\end{equation}
supposing to have, as the VMS' base, two translational forces acting on the centre of mass and a torque around its inertial frame. However, since we are not really interested in the control of the external object, these are not necessary, and we will use only the mass and Coriolis matrices.\\
By solving equation (\ref{lagrangian}), we get the mass, Coriolis' and torques matrices:
\begin{equation}
  \begin{array}{c}
    M_O=\begin{bmatrix}
      m_O&0&0\\
      0&m_O&0\\
      0&0&\frac{m_Or^2}{2}
    \end{bmatrix}\quad
    C_O=\begin{bmatrix}
      0\\0\\0
    \end{bmatrix}\\
    \\
    u_O=\begin{bmatrix}
      \cos{\theta_O}&-\sin{\theta_0}&0\\
      \sin{\theta_O}&\cos{\theta_0}&0\\
      0&0&1
    \end{bmatrix}
  \end{array}
  \label{object_matrices}
\end{equation}
\newpage
\section{Homogeneous Matrices Approach}
The Homogeneous Matrices Approach introduced in \cite{nine, ten} offers a quick, intuitive, and scalable (for higher DoFs) method for robotic dynamics.\\
It is based, as the name suggests, on the Homogeneous Matrices shown in Section~\ref{Homogeneous} and on other characteristic matrices that will be presented here.\\
The goal of this approach is to write the Lagrangian in a matrix form, and to do so, we need to define matrices for the inertia of the system, for the non-lagrangian actions present in the system, and the velocity of the bodies.\\
The latter ones have already been discussed in Section~\ref{velocity_section}, while the inertia and non-lagrangian forces need to be introduced.\\

The mass distribution of a body $k$, projected in the frame $i$, can be described through the \textit{Pseudo Inertia Tensor} $J$:
\begin{equation}
  \prescript{i}{}{J_k}=\begin{bmatrix}
    J_{xx}&J_{xy}&J_{xz}&m_kx_G\\
    J_{yx}&J_{yy}&J_{yz}&m_ky_G\\
    J_{zx}&J_{zy}&J_{zz}&m_kz_G\\
    m_kx_G&m_ky_G&m_kz_G&m
  \end{bmatrix}
\end{equation}
where $m_k$ is the mass of the $k$th body, $\{x_G,y_G,z_G\}$ is the position of the centre of mass, and the pseudo moments of inertia are defined as:
\begin{equation}
  \begin{array}{c}
    J_{xx}=\int x^2\,dm\quad J_{yy}=\int y^2\,dm\quad J_{zz}=\int z^2\,dm\\
    J_{xy}=\int xy\,dm\quad J_{xz}=\int xz\,dm\quad J_{yz}=\int yz\,dm
  \end{array}
  \label{pseudo_moments}
\end{equation}
These are differents from the well known moments of inertia ($I_{xx},I_{yy},I_{zz},I_{xy},I_{xz},I_{yz}$) and their relation is shown in equation (\ref{moments_convertion}):
\begin{equation}
  \begin{array}{c}
    \begin{cases}
      J_{xx}=\frac{-I_{xx}+I_{yy}+I_{zz}}{2}\\
      J_{yy}=\frac{-I_{yy}+I_{xx}+I_{zz}}{2}\\
      J_{zz}=\frac{-I_{zz}+I_{xx}+I_{yy}}{2}
    \end{cases}
    \quad
    \begin{cases}
      J_{xy}=-I_{xy}\\
      J_{yz}=-I_{yz}\\
      J_{zz}=-I_{zx}
    \end{cases}
  \end{array}
\label{moments_convertion}
\end{equation}
\\
In order to evaluate the non-lagrangian components of equation (\ref{lagrangian}), \cite{nine} introduces the \textit{Action Matrix}:
\begin{equation}
  \prescript{i}{}{\phi}_k=\begin{bmatrix}
    0&-c_z&c_y&f_x\\
    c_z&0&-c_x&f_y\\
    -c_y&c_x&0&f_z\\
    -f_x&-f_y&-f_z&0
  \end{bmatrix}
  \label{action_matrix}
\end{equation}
where $\{f_x,f_y,f_z\}$ is the resultant of the forces applied to a body $k$, $\{c_x,c_y,c_z\}$ are the torques calculated with respect to the origin of the frame $i$.\\
The pseudo-scalar product (see equation~(\ref{pseudo_scalar}) in the Appendix) between the action matrix of a body and its velocity matrix gives the power developed by the actions included in $\phi$ as the object moves according to the velocities described by $W$:
\begin{equation}
  P=\prescript{f}{}{\phi}\otimes \prescript{f}{}{W}
\end{equation}
Notice that both the action and velocity matrix have been projected in the fixed frame.\\
A manipulator with two revolute links will have two contributions to the overall power, one for each link:
\begin{equation}
  \begin{split}
  P&=\prescript{f}{}{\phi_1}\otimes \prescript{f}{}{W_{f1}}+\prescript{f}{}{\phi_2}\otimes \prescript{f}{}{W_{f2}}\\
   &=\prescript{f}{}{\phi_1}\otimes \prescript{f}{}{L_{f1}}\dot{\theta_1}+\prescript{f}{}{\phi_2}\otimes \Big(\prescript{f}{}{W_{f1}}+\prescript{f}{}{W_{12}}\Big)\\
   &=\Big(\prescript{f}{}{\phi_1}+\prescript{f}{}{\phi_2}\Big)\otimes\prescript{f}{}{L_{f1}}\dot{\theta_1}+\prescript{f}{}{\phi_2}\otimes \prescript{f}{}{L_{12}}\dot{\theta_2}\\
   &=f_{\theta_1}\dot{\theta_1}+f_{\theta_2}\dot{\theta_2}
  \end{split}
\end{equation}
with $f_{\theta_1}$ and $f_{\theta_2}$ the non-lagrangian components of links one and two, respectively.\\
It is now clear the importance of the $L$ matrix, introduced in Section~\ref{velocity_section}: we can write the non-lagrangian components as a pseudo-scalr product between the overall set of action applied to the system downstream and the relative motion permitted by the joint $i$:
\begin{equation}
  f_{q_i}=\Big(\sum_{j=1}^N\prescript{f}{}{\phi_j}\Big)\otimes \prescript{f}{}{L_{q_i}}
\label{non_lagrangian_matrix}
\end{equation}
It can be proved that ideal constraints between links don't affect the Lagrange equation: we can neglect the constraint forces in $\phi$.\\

Finally, we can write the kinetic energy of the body $j$ as follows:
\begin{equation}
  T_j=\frac{1}{2}\Tr{\Big(\prescript{f}{}{W_{fj}}\prescript{f}{}{J_j}\prescript{f}{}{W_{fj}^T}\Big)}
  \label{kinetic_matrix}
\end{equation}
and, from equation (\ref{energy_sum}), we still get (\ref{lagrangian}).\\

Regarding the planar VMS system, it is useful to write the pseudo-inertial tensor starting from the local frame: since the body is rigid, the mass is supposed to remain in the same position with respect to the local frame.\\
The pseudo moments of inertia are found starting from the moments of inertia (Table \ref{inertia_moments}) and following equation (\ref{moments_convertion}), as shown in Table~\ref{pseudo_moments_table}. Thus:
\begin{equation}
  \begin{array}{c}
  \prescript{0}{}{J_b}=\begin{bmatrix}
    \frac{m_br^2}{4}&0&0&0\\
    0&\frac{m_br^2}{4}&0&0\\
    0&0&0&0\\
    0&0&0&m_b
  \end{bmatrix} \quad
    \prescript{1}{}{J_1}=\begin{bmatrix}
    \frac{l_1^2m_1}{3}&0&0&0\\
    0&0&0&-\frac{l_1m_1}{2}\\
    0&0&0&0\\
    \frac{l_1m_1}{2}&0&0&m_1
  \end{bmatrix}\\
  \\
  \prescript{2}{}{J_2}=\begin{bmatrix}
    \frac{l_2^2m_2}{3}&0&0&0\\
    0&0&0&-\frac{l_2m_2}{2}\\
    0&0&0&0\\
    \frac{l_2m_2}{2}&0&0&m_2
  \end{bmatrix}
  \end{array}
\end{equation}
\begin{table}
  \caption{Moments of inertia of the planar VMS' bodies, with respect to their centre of mass (in the centre of the base and the arms), with $i=\{1,2\}$.}
  \label{pseudo_moments_table}
  \begin{center}
  \begin{tabular}{lccc}
    \toprule
  \textbf{Body} & \textbf{Tensor of Pseudo Inertia}\\
  \midrule
  Base&$\begin{bmatrix}
    \frac{1}{4}m_br^2&0&0\\
    0&\frac{1}{4}m_br^2&0\\
    0&0&0
  \end{bmatrix}$\\
  \\
  Arms&$\begin{bmatrix}
    \frac{1}{3}m_il_i^2&0&0\\
    0&0&0\\
    0&0&0
  \end{bmatrix}$\\
  \bottomrule
  \end{tabular}
  \end{center}
  \end{table}
Then, following equation (\ref{change_frame}), we can project $\prescript{0}{}{J_b}$, $\prescript{1}{}{J_1}$ and $\prescript{2}{}{J_2}$ in the fixed frame, obtaining $\prescript{f}{}{J_b}$, $\prescript{f}{}{J_1}$ and $\prescript{f}{}{J_2}$.\\
It is already possible to write the kinetic energy (\ref{kinetic_matrix}) for every body since we have both the velocity matrices and the tensors of pseudo-inertia projected in the fixed frame:
\begin{equation}
  \begin{array}{l}
    T_b=\frac{1}{2}\Tr{\Big(\prescript{f}{}{W_{f0}}\prescript{f}{}{J_0}\prescript{f}{}{W_{f0}^T}\Big)}\\
    T_1=\frac{1}{2}\Tr{\Big(\prescript{f}{}{W_{f1}}\prescript{f}{}{J_1}\prescript{f}{}{W_{f1}^T}\Big)}\\
    T_2=\frac{1}{2}\Tr{\Big(\prescript{f}{}{W_{f2}}\prescript{f}{}{J_2}\prescript{f}{}{W_{f2}^T}\Big)}
  \end{array}
\end{equation}
To find the non-lagrangian components, the action and the $L$ matrices need to be calculated.\\
We have already found the $L$ matrices associated with the permitted motion of each body in Chapter~\ref{kinematics} (see equation (\ref{L_matrices})). The action matrices can be easily found by looking at the definition of $\phi$ (\ref{action_matrix}) and confronting it with Figure~\ref{forces}:
\begin{equation}
  \begin{array}{c}
    \prescript{0}{}{\phi_b}=\begin{bmatrix}
      0&-\tau_0+\tau_1&0&F_x\\
      \tau_0-\tau_1&0&0&F_y\\
      0&0&0&0\\
      -F_x&-F_y&0&0
    \end{bmatrix} \quad
    \prescript{1}{}{\phi_1}=\begin{bmatrix}
      0&-\tau_1+\tau_2&0&0\\
      \tau_1-\tau_2&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}\\
    \\
    \prescript{2}{}{\phi_2}=\begin{bmatrix}
      0&-\tau_3&0&0\\
      \tau_2&0&0&0\\
      0&0&0&0\\
      0&0&0&0
    \end{bmatrix}
  \end{array}
\end{equation}
After the projection of the action matrices in the fixed frame, it is possible to find the non-lagrangian components:
\begin{equation}
  \begin{array}{l}
  f_1=\Big(\prescript{f}{}{\phi_b}+\prescript{f}{}{\phi_1}+\prescript{f}{}{\phi_2}\Big)\otimes \prescript{f}{}{L_{fb_x}}=F_x\cos{\theta_0}-F_y\sin{\theta_0}\\
  f_2=\Big(\prescript{f}{}{\phi_b}+\prescript{f}{}{\phi_1}+\prescript{f}{}{\phi_2}\Big)\otimes \prescript{f}{}{L_{fb_y}}=F_x\sin{\theta_0}+F_y\cos{\theta_0}\\
  f_3=\Big(\prescript{f}{}{\phi_b}+\prescript{f}{}{\phi_1}+\prescript{f}{}{\phi_2}\Big)\otimes \prescript{f}{}{L_{f0}}=\tau_0\\
  f_4=\Big(\prescript{f}{}{\phi_b}+\prescript{f}{}{\phi_1}\Big)\otimes \prescript{f}{}{L_{01}}=\tau_1\\
  f_5=\prescript{f}{}{\phi_b}\otimes \prescript{f}{}{L_{12}}=\tau_2
  \end{array}
\end{equation}
which are the same of (\ref{non_lagrangian}).\\
It is now possible to solve the Lagrange equation, 
with $\mathcal{L}=T_b+T_1+T_2$:
\begin{equation}
  \begin{cases}
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{x}_b}-\frac{\partial \mathcal{L}}{\partial x_b}=f_1\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{y}_b}-\frac{\partial \mathcal{L}}{\partial y_b}=f_2\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{\theta}_0}-\frac{\partial \mathcal{L}}{\partial \theta_0}=f_3\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_1}-\frac{\partial \mathcal{L}}{\partial q_1}=f_4\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_2}-\frac{\partial \mathcal{L}}{\partial q_2}=f_5\\
  \end{cases}
\end{equation}
\newpage
\subsection{Object's Dynamics}
The object's pseudo-inertia tensor follows the same structure of the base's one:
\begin{equation}
  \prescript{O_1}{}{J_{O_1}}=\begin{bmatrix}
    \frac{m_br^2}{4}&0&0&0\\
    0&\frac{m_br^2}{4}&0&0\\
    0&0&0&0\\
    0&0&0&m_b
  \end{bmatrix}
\end{equation}
and $\prescript{f}{}{J_b}=\prescript{f}{O_1}{M}\prescript{O_1}{}{J_{O_1}}\prescript{O_1}{f}{M}$.\\
The velocity and $L$ matrices have already been found in the previous chapter; the action matrix can be written with the same assumption made for the classic method approach:
\begin{equation}
  \prescript{O_1}{}{\phi_{O_1}}=\begin{bmatrix}
    0&-\tau_O&0&F_{O_x}\\
    \tau_O&0&0&F_{O_y}\\
    0&0&0&0\\
    -F_{O_x}&-F_{O_y}&0&0
  \end{bmatrix}
\end{equation}
and $\prescript{f}{}{\phi_{O_1}}=\prescript{f}{O_1}{M}\prescript{O_1}{}{\phi_{O_1}}\prescript{O_1}{f}{M}$.
Finally:
\begin{equation}
  T_O=\frac{1}{2}\Tr{\Big(\prescript{f}{}{W_{fO_1}}\prescript{f}{}{J_b}\prescript{f}{}{W_{fO_1}^T}\Big)}
\end{equation}
and:
\begin{equation}
  \begin{array}{l}
    f_{O_1}=\prescript{f}{}{\phi_{O_1}}\otimes \prescript{f}{}{L_{fO_x}}=F_{O_x}\cos{\theta_O}-F_{O_y}\sin{\theta_O}\\
    f_{O_2}=\prescript{f}{}{\phi_{O_1}}\otimes \prescript{f}{}{L_{fO_y}}=F_{O_y}\cos{\theta_O}+F_{O_x}\sin{\theta_O}\\
    f_{O_3}=\prescript{f}{}{\phi_{O_1}}\otimes \prescript{f}{}{L_{O_0O_1}}=\tau_O
  \end{array}
\end{equation}
By solving (\ref{lagrangian}), we get the same matrices in (\ref{object_matrices}).
\newpage
\chapter{Impact Analysis}\label{impact_analysis}
Once the Kinematics and the Dynamics of both the VMS and the external object are analysed, the impact analysis between the two is here performed.\\
Two basic assumptions are made in the formulation of the impact model:
\begin{enumerate}
  \item "although the generalized velocities change substantially, the generalized coordinates of the system remain the same over the impact duration. This is justified not only for the rotational coordinates but for the elastic ones as well \cite{fifteen}. The latter conclusion can also be implied by reasoning that since the duration of impact (approximately \SI{d-4}{\second}) is very small compared with the period of the fundamental mode of vibration of the links (several seconds), the change in deflection of a flexible beam during impact is negligible"~\cite{fourteen};
  \item "at the contact point between the end-defector and the target there are forces but not moments. Impact occurs at a single point, which is unable to transmit a local moment"\cite{fourteen}.
\end{enumerate}
Another assumption that has already been made in the previous chapters is that we know the inertia and dynamic properties of the payload in advance, as well as the position of the contact point on the payload.\\
Following the second assumption, during the impact, the equations of motion of the VMS and the object can be expressed in a form similar to equation (\ref{equation_motion}) except for the impact force $f_I$:
\begin{equation}
  \begin{cases}
    M\ddot{p}+C=u+J^Tf_I\\
    M_O\ddot{\psi}+C_O=-J_O^Tf_I
  \end{cases}
  \label{initial_impact}
\end{equation}
where $J^Tf_I$ and $J_O^Tf_I$ are the torques and forces applied to the VMS and object's generalized coordinates, respectively, following the relation shown in (\ref{force_jacobian}). For the second assumption, the wrench is now composed of the force $f_I$ only.\\
Notice that $u_O$ has been omitted in the second equation, since, as already mentioned in Section~\ref{object_dynamics}, we are not interested in controlling the object.\\
From the second equation of (\ref{initial_impact}), we can write:
\begin{equation}
  f_I=-(J_O^T)^+(M_O\ddot{\psi}_O+C_O)
  \label{impact_force}
\end{equation}
with $(J_O^T)^+$ the pseudoinverse of the transposed object's jacobian; in fact, since as found in (\ref{object_jacobian}) this jacobian is not squared, we can use the pseudoinverse to invert it and, by having linearly indipendent rows, it is defined accordingly to (\ref{pseudoinverse}).\\
By substuting (\ref{impact_force}) in the first equation of (\ref{initial_impact}), one obtaines:
\begin{equation}
  \begin{split}
  M\ddot{p}+C&=u-J^T(J_O^T)^+(M_O\ddot{\psi}_O+C_O)\\
  &=u-J^T(J_O^+)^T(M_O\ddot{\psi}_O+C_O)
  \end{split}
\end{equation}
Now, integrating the above equation over the period of impact $\pi$:
\begin{equation}
  \int_{0}^{\pi}M\ddot{p}\,dt+\int_{0}^{\pi}C\,dt =-\int_{0}^{\pi}J^T(J_O^+)^TM_O\ddot{\psi}_O\,dt+\int_{0}^{\pi}(u-J^T(J_O^+)^TC_O)\,dt
\end{equation}
Under the first assumption of no change of the generalized coordinates during the impact (but only of their velocities), all the contributions that depend only on the velocities and positions (i.e. $C,u,J^T(J_O^+)^TC_O$) can be ignored:
\begin{equation}
  M(\dot{p}_f-\dot{p}_i)+J^T(J_O^+)^TM_O(\dot{\psi}_f-\dot{\psi_i})=0
  \label{general_impact}
\end{equation}
This equation can be used for all collisions ranging from plastic to perfectly elastic \cite{fifteen,ten}. It is, in fact, the general property of conservation of momentum:  given two point masses $m_1$ and $m_2$, with linear initial velocity $v_{1,i}$ and $v_{2,i}$, the conservation of momentum law states:
\begin{equation}
  m_1v_{i,1}+m_2v_{i,2}=m_1v_{f,1}+m_2v_{f,2}
\end{equation}
or, equivalently:
\begin{equation}
  m_1(v_{f,1}-v_{i,1})+m_2(v_{f,2}-v_{i,2})=0
  \label{momentum_conservation}
\end{equation}
Equation (\ref{momentum_conservation}) is very similar to (\ref{general_impact}), with the difference that $M\dot{p}\in \mathbb{R}^{5\times 1}$ and $M_O\dot{\psi}\in \mathbb{R}^{3\times 1}$: they cannot be summed. That is why the object's mass matrix is multiplied by the two Jacobians, which comes directly from the equation of motion.\\
In the following sections, two different scenarios will be analyzed by assuming the manipulator's arms as rigid or elastic bodies.
\newpage
\section{Rigid Bodies}\label{rigid}
In a plastic impact, the velocity of the contact point of each system is the same after the impact:
\begin{equation}
  J\dot{p_f}=J_O\dot{\psi_f}
  \label{kinematic_constraint}
\end{equation}
where the left-hand side term of the equation is the velocity of the contact point written as a function of the final VMS generalized coordinates and velocities $p_f,\dot{p}_f$ (see (\ref{task_dimension})) and the right-hand side term is the velocity of the same point written with respect to the object generalized final coordinates and velocities $\psi_f,\dot{\psi}_f$.\\
From (\ref{kinematic_constraint}), the velocities of the object can be expressed in terms of those of the VMS as:
\begin{equation}
  \dot{\psi}_f=J_O^+J\dot{p}_f
  \label{composition}
\end{equation}
By substituting equation (\ref{composition}) in equation (\ref{general_impact}), the following is obtained:
\begin{equation}
  \dot{p}_f=G^{-1}H
  \label{final_velocities}
\end{equation}
where:
\begin{equation}
  \begin{array}{l}
    G=M+J^T(J_O^+)^TM_OJ_O^+J\\
    H=M\dot{p}_i+J^T(J_O^+)^TM_O\dot{\psi}_i
  \end{array}
\end{equation}
We can confront this result with the one obtained starting from equation (\ref{momentum_conservation}) in the case of two point masses; since the final velocity in a plastic impact would have been the same $v_f$ for both masses, we can write:
\begin{equation}
  \begin{array}{l}
  m_1v_{i,1}+m_2v_{i,2}=(m_1+m_2)v_f\\
  \Rightarrow v_f=g^{-1}h
  \end{array}
\end{equation}
with:
\begin{equation}
  \begin{array}{l}
    g=m_1+m_2\\
    h=m_1v_{i,1}+m_2v_{i,2}
  \end{array}
\end{equation}
Notice that $G,H$ are very similar to $g,h$, the difference is still due to the Jacobians matrices, which come from the kinematic relation.\\
Once the initial velocities $\dot{p}_i,\dot{\psi}_i$ have been determined, $\dot{p}_f$ can be evaluated according to (\ref{final_velocities}) and $\dot{\psi}_f$ can be solved from (\ref{composition}). These final values are used as the initial velocity conditions for the post-impact dynamical simulation of the system, whose model will be the combination of the equations of robot and object, so that equation (\ref{composition}) will always hold, and we can get rid of the subscripts:
\begin{equation}
  \dot{\psi}=J_O^+J\dot{p}
\end{equation}
While in [14] the post-impact analysis is not fully covered, \cite{sixteen} offers an intuitive procedure to write the dynamics of the new VMS, composed now by the object too, with respect to the VMS generalized coordinates alone (i.e. $p$).\\ 
By differentiating the above equation, we can obtain:
\begin{equation}
  \ddot{\psi}=J_O^+J\ddot{p}+\frac{\partial J_O^+}{\partial t}J\dot{p}+J_O^+\frac{\partial J}{\partial t}\dot{p}
  \label{composition_diff}
\end{equation}
We can now substitute (\ref{composition_diff}) in the second equation of (\ref{initial_impact}) (i.e. the dynamics of the object), obtaining:
\begin{equation}
  M_O\Big(J_O^+J\ddot{p}+\frac{\partial J_O^+}{\partial t}J\dot{p}+J_O^+\frac{\partial J}{\partial t}\dot{p}\Big)+C_O=-J_O^Tf_I
\end{equation}
from which $f_I$ can be written as:
\begin{equation}
  f_I=-\Big(J_O^{-T}M_OJ_O^+J\ddot{p}+J_O^{-T}M_O\frac{\partial J_O^+}{\partial t}J\dot{p}+J_O^{-T}M_OJ_O^+\frac{\partial J}{\partial t}\dot{p}+J_O^{-T}C_O\Big)
\end{equation}
Now, $f_I$ can be substituted in the first equation of (\ref{initial_impact}) (i.e. the VMS dynamics), and by doing so, we can write the overall dynamics with respect to $p$ only:
\begin{equation}
  M'\ddot{p}+C'=u
  \label{final_equation_motion}
\end{equation}
where:
\begin{equation}
  \begin{array}{l}
    M'=M+J^T(J_O^T)^+M_OJ_O^+J\\
    C'=C+J^T(J_O^T)^+M_O\frac{\partial J_O^+}{\partial t}J\dot{p}+J^T(J_O^T)^+M_OJ^+\frac{\partial J}{\partial t}\dot{p}+J^T(J_O^T)^+C_O
  \end{array}
  \label{VMS_dynamics}
\end{equation}
Equation (\ref{VMS_dynamics}) is the post-impact dynamic model of the VMS containing the object. Both $M'$ and $C'$ are still dependent on $J_O$, which depends on the object's coordinates, but since the object is now captured by the manipulator, its coordinated coincide with the end-effector ones, and its velocities are found by differentization.
\newpage
\FloatBarrier
\subsection{Free Motion}
A simulation has been performed by means of the Wolfram software (version 14.2) with VMS parameters shown in Table~\ref{VMS_parameters} and the initial conditions shown in Tables~\ref{initial_positions}, \ref{initial_velocities}.\\
The VMS parameters have been chosen following a real case scenario: the lenghts, radiuses and masses of the manipulator's arms are the ERA ones (see Table~\ref{SRMs_comparison} and \cite{four}); the base mass is the mass of the ISS, on top of which the ERA is attached; the payload mass is the mass of a medium-size satellite; $\gamma$ is an arbitrary value.\\
Regarding the VMS initial positions, the choice of the values will be explained in the next section. For this analysis, every initial position is valid. The initial velocities are zero for almost every VMS generalized coordinate (i.e we assume the base and manipulator still before the impact) and small initial velocities for the payload, as the case of satellite docking is taken into consideration: the ideal condition would be a null relative velocities, however, in a real case scenario, non-zero relative velocities are present.\\
\begin{table}
  \caption{VMS parameters.}
  \label{VMS_parameters}
  \begin{center}
  \begin{tabular}{cccccccc}
    \toprule
    $l_1$&$l_2$&$m_b$&$m_1$&$m_2$&$m_O$&$r$&$\gamma$\\
  \midrule
    \SI{5.59}{\metre}&\SI{5.59}{\metre}&\SI{419725}{\kilogram}&\SI{300}{\kilogram}&\SI{300}{\kilogram}&\SI{3000}{\kilogram}&\SI{0.12}{\metre}&\SI{0.5}{\radian}\\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}
\begin{table}
  \caption{Simulation's initial positions.}
  \label{initial_positions}
  \begin{center}
  \begin{tabular}{cccccccc}
    \toprule
    $x_b$&$y_b$&$\theta_0$&$q_1$&$q_2$&$x_O$&$y_O$&$\theta_O$\\
  \midrule
    \SI{4}{\metre}&\SI{2}{\metre}&\SI[parse-numbers = false]{\pi/2}{\radian}&\SI{0}{\radian}&\SI[parse-numbers = false]{\pi/2}{\radian}&\SI{-1.71}{\metre}&\SI{7.59}{\metre}&\SI{5.78}{\radian}\\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}
\begin{table}
  \caption{Simulation's initial velocities.}
  \label{initial_velocities}
  \begin{center}
  \begin{tabular}{lcc}
    \toprule
    &\textbf{Simulation 1}&\textbf{Simulation 2}\\
  \midrule
  $\dot{\theta_0}$&\SI{0}{\radian\per\second}&\SI{0}{\radian\per\second}\\
  $\dot{x_b}$&\SI{0}{\metre\per\second}&\SI{0}{\metre\per\second}\\
  $\dot{y_b}$&\SI{0}{\metre\per\second}&\SI{0}{\metre\per\second}\\
  $\dot{q_1}$&\SI{0}{\radian\per\second}&\SI{0}{\radian\per\second}\\
  $\dot{q_2}$&\SI{0}{\radian\per\second}&\SI{0}{\radian\per\second}\\
  $\dot{x_O}$&\SI{1}{\metre\per\second}&\SI{0}{\metre\per\second}\\
  $\dot{y_O}$&\SI{0}{\metre\per\second}&\SI{-1}{\metre\per\second}\\
  $\dot{\theta}_O$&\SI{0.01}{\radian\per\second}&\SI{0.01}{\radian\per\second}\\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}
The position of the object in the pre-impact has been found by imposing that the contact point coincides with the initial end-effector position, while its orientation $\theta_O$ has been chosen as follows:
\begin{equation}
  \theta_O=\theta_{0,0}+q_{1,0}+q_{2,0}+\pi-\gamma
  \label{contact_rotation}
\end{equation}
which is, the orientation of the object is such that it is rotated of the same end-effector angle ($\theta_{0,0}+q_{1,0}+q_{2,0}$) minus $\gamma$ to align the x-axis with the EE's one. In order to make the contact point coincide with the EE, \SI{180}{\degree} have been added.\\
As shown in Table~\ref{initial_velocities}, two simulations have been performed, with the only difference in the object's initial velocities: in the first simulation, the payload moved only in the positive x-direction, in the second, it moves only in the negative y-direction.\\
Given these initial conditions, the final velocities $\dot{p}_f$ in (\ref{final_velocities}) can be calculated.\\

For the post-impact analysis, the position of the object has been imposed again as a function of the EE position, but now as a function of time, and its orientation similarly to equation (\ref{contact_rotation}):
\begin{equation}
  \theta_O(t)=\theta_0(t)+q_1(t)+q_2(t)+\pi-\gamma
\end{equation}
Having now the new post-impact $\psi_p$ generalized coordinates as a function of $p$, the object's jacobian can be expressed as a function of the VMS generalized coordinates too, and $M'$ and $C'$ can be found according to (\ref{VMS_dynamics}).\\
A control-free dynamics has been performed using as initial conditions the initial positions in Table~\ref{initial_positions} and the final velocities $\dot{p}_f$ found in the pre-impact analysis. As already stated at the beginning of this chapter, in fact, during the impact, only the rates change, while the positions remain the same.\\
A quick and intuitive visual result can be seen in Figure~\ref{no_control_result}, while the evolution of the generalized coordinates over time are reported in Figures~\ref{free_motion_1}, \ref{free_motion_2}.\\
It is interesting to notice that, in both cases, $\theta_0$ does not change over time: the absence of a torque applied to the base allows free rotation of $q_1$ around $z_b$, since the manipulator is directly attached to the CoM of the base (i.e. the arm does not apply any torque) and the base does not rotate.\\
Furthermore, given the higher mass of the base with respect to the payload and manipulator masses, it moves very little, and we can approximate it as still in the next calculations.\\
\begin{figure}[!htb]
  \centering
  \subfloat[][\emph{Simulation 1.}]
  {\input{tikz/no_control_sol1.tikz}}
\subfloat[][\emph{Simulation 2.}]
  {\input{tikz/no_control_sol2.tikz}} 
  \caption{Initial and final (dashed) position of the VMS after the impact for the two different simulations, ten seconds long. In the left image, the satellite approaches the VMS with a west to east motion, while in the right one, with a north to south motion.}
  \label{no_control_result}
\end{figure}
\begin{figure}[!htb]
  \centering
  \subfloat
  {\includesvg[scale=0.37]{free_motion_x.svg}} \quad
\subfloat
  {\includesvg[scale=0.37]{free_motion_y.svg}} \\
  \subfloat
  {\includesvg[scale=0.37]{free_motion_theta.svg}} \quad
  \subfloat
  {\includesvg[scale=0.37]{free_motion_q1.svg}}\\
  \subfloat
  {\includesvg[scale=0.37]{free_motion_q2.svg}}
  \caption{VMS generalized coordinates' displacement after the catching of the payload when no control is performed, Simulation~1.}
  \label{free_motion_1}
\end{figure}
\begin{figure}[!htb]
  \centering
  \subfloat
  {\includesvg[scale=0.37]{free_motion_x2.svg}}\quad
\subfloat
  {\includesvg[scale=0.37]{free_motion_y2.svg}} \\
  \subfloat
  {\includesvg[scale=0.37]{free_motion_theta2.svg}}\quad
  \subfloat
  {\includesvg[scale=0.37]{free_motion_q12.svg}}\\
  \subfloat
  {\includesvg[scale=0.37]{free_motion_q22.svg}}
  \caption{VMS generalized coordinates' displacement after the catching of the payload when no control is performed, Simulation~2.}
  \label{free_motion_2}
\end{figure}
\newpage
\FloatBarrier
\subsection{Control Based Motion}\label{control_motion}
A typical control block diagram is shown in Figure~\ref{block_diagram}. The sensors allow to keep track of the robot configuration $q,\dot{q}$ such that the controller can provide a control law to follow a desired behaviour.\\
\begin{figure}[b]
  \centering
  \includegraphics[scale=0.4]{control_diagram.png}
  \caption{A typical robot control system. An inner control loop is used to help the amplifier and actuator to achieve the desired force or torque [11].}
  \label{block_diagram}
\end{figure}
A remark needs to be made about the control of the translation of the base. It is highly improbable that it would be possible to calculate the exact displacement of the spacecraft where the manipulator is attached, considering also the too little displacement from Figures~\ref{free_motion_1}, \ref{free_motion_2}. Hence, the control law is applied to $\theta_0, q_1$ and $q_2$ only. The base is free to move, but, as already mentioned, it can be approximate as still, given the huge inertia of the spacecraft.\\ 
Thus, we can rewrite the final equation of motion (\ref{final_equation_motion}):
\begin{equation}
  \begin{bmatrix}
    M'_{tt}&M'_{tr}\\
    M'_{rt}&M'_{rr}
  \end{bmatrix}
  \begin{bmatrix}
    \ddot{p}_t\\
    \ddot{p}_r
  \end{bmatrix}+\begin{bmatrix}
    C'_{t}\\
    C'_{r}
  \end{bmatrix}=\begin{bmatrix}
    \textbf{0}\\
      u
    \end{bmatrix}
    \label{one_control}
\end{equation}
where $p_t=\{x_b,y_b\}$ refers to the translational coordinates, $p_r=\{\theta_0,q_1,q_2\}$ to the rotational ones and $\textbf{0}\in \mathbb{R}^2$.\\
By writing the translational coordinate as a function of the rotational ones
\begin{equation}
  \ddot{p}_t=-{M'}_{tt}^{-1}(M'_{tr}\ddot{p}_r+C'_t)
\end{equation}
and by plugging it in the second row of (\ref{one_control}):
\begin{equation}
  \ddot{p}_r\tilde{M}+\tilde{C}=u
  \label{rotation_equation_motion}
\end{equation}
with
\begin{equation}
\begin{array}{c}
  \tilde{M}=M_{rr}'-M_{rt}'{M'}_{tt}^{-1}M_{tr}', \quad \tilde{C}=C_r'-M_{rt}'{M'}_{tt}^{-1}C'_t
\end{array}
\end{equation}
If we knew the robot dynamics perfectly, we could use the following input (\textit{feed-forward}) to move the robot:
\begin{equation}
  \hat{u}=\hat{M}\ddot{q}_d+\hat{C}(q_d,\dot{q}_d)
\end{equation}
where the RHS of the equation is the estimated robot dynamics.\\
Upon substitution in (\ref{rotation_equation_motion}), we would have, supposing $\hat{M}=\tilde{M}$ and $\hat{C}=\tilde{C}$:
\begin{equation}
  \tilde{M}(\ddot{q}_d-\ddot{q})=0
\end{equation}
which is true when the desired configuration is reached.\\
Since, in practice, it is not possible to know the exact dynamics, a PD controller is often used in addition to the feed-forward term to compensate for inaccuracy and disturbances:
\begin{equation}
  u=\hat{u}+K_p(q_d-q)+K_d(\dot{q}_d-\dot{q})
\end{equation}
with $K_p$ and $K_d$ the proportional and derivative positive definite gain matrices.\\
Assuming then $\hat{M}\approx\tilde{M}$ and $\hat{C}\approx\tilde{C}$ and substituting in (\ref{rotation_equation_motion}):
\begin{equation}
  \tilde{M}(\ddot{q}_d-\ddot{q})+K_d(\dot{q}_d-\dot{q})+K_p(q_d-q)=0
\end{equation}
However, the above equation is coupled by the mass matrix. In order to have an uncoupled control scheme, a \textit{feedback linearization} can be implemented, as suggested by \cite{sixteen}:
\begin{equation}
  u=\hat{M}[\ddot{q}_d+K_d(\dot{q}_d-\dot{q})+K_p(q_d-q)]+\hat{C}
  \label{feedback_linearization}
\end{equation}
such that the final equation of motion for the rotational coordinates becomes:
\begin{equation}
  \ddot{e}+K_d\dot{e}+K_pe=0
  \label{controlled_dynamics}
\end{equation}
The tracking error $e$ is governed by second-order dynamics that can be arbitrarily assigned (on each joint) by suitably selecting gains ($K_p,K_d$).\\
The dynamics is now:
\begin{itemize}
  \item decoupled: each joint coordinate evolves indipendently from others $\Rightarrow$ $K_p,K_d$ are diagonal matrices.
  \item linear: we have global asymptothic ($e\rightarrow 0$) stability for any $K_p\succ 0,K_d\succ 0$. This is a sufficient and necessary condition since the state-space equation is given by:
    \begin{equation}
      x=\begin{bmatrix}
        e\\\dot{e}
      \end{bmatrix}\quad \Rightarrow \quad \dot{x}=\begin{bmatrix}
        \mathbf{0}&I_{2\times 2}\\
        -K_p&-K_d
      \end{bmatrix}
    \end{equation}
    and, for second order differential equations, if $K_{p_i}>0$ and $K_{d_i}>0$, the dynamics is stable [11].
  \item the time evolution is governed by the eigenvalues that are the roots of the polynomial:
    \begin{equation}
      s^2+K_{d_i}s+K_{p_i}=0 \quad \Rightarrow \quad s_{1,2}=\frac{-K_{d_i}\pm \sqrt{K_{d_i}^2-4K_{p_i}}}{2}
    \end{equation}
    with $\omega_n=\sqrt{K_{p_i}}$ and $\xi=\frac{K_{d_i}}{2\sqrt{K_{p_i}}}$.
\end{itemize}

The control law shown in equation (\ref{feedback_linearization}) has been chosen with zero desired velocities $\dot{p}_d$ and with the initial positions (Table~\ref{initial_positions}) as desired coordinates $p_d$.\\
$K_p$ has been chosen as the identity matrix (i.e. $I_{5\times 5}$) and $K_d$ has been calculated following the relation of the damping term shown above and choosing a critically damped behaviour so that there are no overshoots of the links while reaching the desired position:
\begin{equation}
  \xi=1 \quad \Rightarrow \quad K_d=2\sqrt{K_p}
  \label{critically_damped}
\end{equation}
The final results are shown in Figures~\ref{controlled_motion_1}, \ref{controlled_motion_2}, where underdamped and overdamped behaviours have been plotted as well.
\begin{figure}
  \centering
  \subfloat
  {\includesvg[scale=0.37]{controlled_motion_x.svg}}\quad
\subfloat
  {\includesvg[scale=0.37]{controlled_motion_y.svg}} \\
  \subfloat
  {\includesvg[scale=0.37]{controlled_motion_theta.svg}}\quad
  \subfloat
  {\includesvg[scale=0.37]{controlled_motion_q1.svg}
  \label{q1_real}}\\
  \subfloat
  {\includesvg[scale=0.37]{controlled_motion_q2.svg}}
  \caption{VMS generalized coordinates' displacement after the catching of the payload when control is performed, Simulation~1 In yellow, an underdamped behaviour ($\xi=0.5$), in blue a critically damped behaviour ($\xi=1$), in green an overdamped behaviour ($\xi=1.5$).}
  \label{controlled_motion_1}
\end{figure}
\begin{figure}
  \centering
  \subfloat
  {\includesvg[scale=0.37]{controlled_motion_x2.svg}}\quad
\subfloat
  {\includesvg[scale=0.37]{controlled_motion_y2.svg}} \\
  \subfloat
  {\includesvg[scale=0.37]{controlled_motion_theta2.svg}}\quad
  \subfloat
  {\includesvg[scale=0.37]{controlled_motion_q12.svg}}\\
  \subfloat
  {\includesvg[scale=0.37]{controlled_motion_q22.svg}}
  \caption{VMS generalized coordinates' displacement after the catching of the payload when control is performed, Simulation~2.}
  \label{controlled_motion_2}
\end{figure}
\newpage
\section{Elastic Bodies}
In this section, a more realistic scenario is developed, and the assumption of rigid bodies will be discarded: the links of the manipulator will be considered flexible.\\
Robotic systems with "flexible links are continuous dynamical systems characterized by an infinite number of degrees of freedom and are governed by nonlinear, coupled, ordinary, and partial differential equations. The exact solution of such a mathematical model is normally not feasible, and the infinite dimensional model imposes severe constraints on the design of controllers as well. Hence, it is necessary that these continuous systems are discretized"\cite{seventeen}. \\
The discretization can be performed using so-called \textit{modes}, finite elements, or lumped parameters. A common assumption is to assume the links' deflections are small, such that a linear theory can be selected \cite{seventeen,eighteen,twentyfive}. The Euler-Bernoulli beam theory is the one selected for this work, as it is quite straightforward and not too computationally demanding.\\
The lateral vibration of a beam can be studied by considering it as a continuous system characterized by an infinite number of degrees of freedom. The equation of motion is carried out by considering the forces and moments acting on an infinitesimal piece of the body (Figure~\ref{elementary}), whose mass can be written as:
\begin{equation}
\,dm=\rho Adx
\end{equation}
where $\rho$ is the beam density and $A$ its cross-section area, which is considered constant along the beam.\\
\begin{figure}[h]
\centering
\includegraphics[scale=0.25]{elementary}
\caption{Forces acting on the infinitesimal piece of the beam.}
\label{elementary}
\end{figure}
The equations of motion are:
\begin{equation}
\begin{cases}
f(x,t)dx-(V+dV)+V=\rho A \,dx \frac{\partial^2w(x,t)}{\partial t^2}\\
(M+dM)-(V+\,dV)dx+f(x,t)dx\frac{dx}{2}-M=0
\end{cases}
\end{equation}
where $V$ is the shear force, $M$ the bending moment and $f(x,t)$ the distributed force. The dominant motion is assumed to be the lateral one, which is true when the beam is thin.\\
By defining $\,dV=\frac{\partial V}{\partial x}\,dx$ and $\,dM=\frac{\partial M}{\partial x}\,dx$, and using the Euler-Bernoulli definition of moment $M(x,t)=ES\frac{\partial^2 w(x,t)}{\partial x^2}$, where $E$ is the Young's modulus and $S$ is the area moment of inertia (not to be confused with the mass moment of inertia $I$), the equation of motion becomes:
\begin{equation}
  ES\frac{\partial^4w(x,t)}{\partial x^4}+\rho A\frac{\partial^2w(x,t)}{\partial t^2}=f(x,t)
\end{equation}
and, by defining $c=\sqrt{\frac{ES}{\rho A}}$ as the speed of longitudinal deformation, we get:
\begin{equation}
c^2\frac{\partial^4w(x,t)}{\partial x^4}+\frac{\partial^2w(x,t)}{\partial t^2}=f(x,t)
\label{forced}
\end{equation}
$ES$ can also be referred to \textit{flexural rigidity} of the beam.\\
The free vibration equation is obtained by imposing $f(x,t)=0$:\\
 \begin{equation}
c^2\frac{\partial^4w(x,t)}{\partial x^4}+\frac{\partial^2w(x,t)}{\partial t^2}=0
\label{free}
\end{equation}
which is also reported in \cite{eighteen}: we assume that no control is applied to the tips' deformations. This assumption will be tackled in the next sections.\\
The solution of the equation (\ref{free}) needs two initial conditions and four boundary conditions to be found. It can be calculated by separation of variables, writing the solution as the product of a function depending on time and another one depending on space:
\begin{equation}
w(x,t)=W(x)Q(t)
\label{separability}
\end{equation}
It is now possible to rewrite the equation (\ref{free}) as:
\begin{equation}
\frac{c^2}{W(x)}\frac{\,d^4W(x)}{\,dx^4}=-\frac{1}{Q(t)}\frac{\,d^2Q(t)}{\,dt^2}=const
\end{equation}
and by choosing as the constant $\omega^2$, the time equation becomes the one degree of freedom oscillator, whose solution is known (\ref{time}), while the space equation solution can be written as (\ref{space}), where $\beta^4=\frac{\rho A}{EI}\omega^2$.
\begin{equation}
Q(t)=A\cos{\omega t}+B\sin{\omega t}
\label{time}
\end{equation}
\begin{equation}
W(x)=c_1\cos(\beta x)+c_2\sin{\beta x}+c_3\cosh{\beta x}+c_4\sinh{\beta x}
\label{space}
\end{equation}
The four coefficients of the space solution can be found with the boundary condition of the system. Every natural frequency of the system is associated with one space solution (mode shape) and time solution and can be found imposing the boundary conditions.\\
The displacement of the beam is the sum of the product between the $n$ mode shapes selected and their time solutions \cite{sixteen,seventeen,eighteen}:
\begin{equation}
w(x,t)=\sum_{n=1}^\infty W_n(x)Q_n(t)
\label{overall}
\end{equation}
As already mentioned, the assumption for the Euler-Bernoulli beam model is of small deformations. The kinematic analysis can be carried out in the same way we did in Section~\ref{planar_VMS}, with the only addition of a homogeneous elasticity matrix, which accounts for the elastic deformation of the link \cite{seventeen}. Assuming null rotation and small tip deformation, we can write the elasticity matrix from link $i$ to $i+1$ as:
\begin{equation}
  \prescript{i}{i+1}{E}=\begin{bmatrix}
    1&0&0&u(x,t)\\
    0&1&0&w(x,t)\\
    0&0&1&v(x,t)
  \end{bmatrix}
\end{equation}
with $u(x,t),w(x,t),v(x,t)$ elastic deformations in the $x,y,z$ direction respectively.\\
Since the deformation is calculated at the arm's tip and only in the y-direction (following the Denavit-Hartenberg notation), we can rewrite the matrix:
\begin{equation}
  \prescript{i}{i+1}{E}=\begin{bmatrix}
    1&0&0&0\\
    0&1&0&W_i(x)Q_i(t)\\
    0&0&1&0
  \end{bmatrix}
\end{equation}
where $W_i(x)=\{W_{i,1},W_{i,2},\dots,W_{i,n}\}$ and $Q_i(t)=\{Q_{i,1},Q_{i,2},\dots,Q_{i,n}\}^T$ \cite{sixteen}.\\
The joints' homogeneous transformation matrices, for the analyzed planar case, will be given as:
\begin{equation}
  \begin{array}{l}
  \prescript{f}{1}{T}=\prescript{f}{b}{M}\prescript{b}{0}{M}\prescript{0}{1}{M}\prescript{0}{1}{E}\\
  \prescript{f}{2}{T}=\prescript{f}{b}{M}\prescript{b}{0}{M}\prescript{0}{1}{M}\prescript{0}{1}{E}\prescript{1}{2}{M}\prescript{1}{2}{E}\\
  \end{array}
  \label{new_kinematics}
\end{equation}
Hence, the time-varying part of the free-vibration solution $Q(t)$ can be found by following the Lagrangian approach as in the previous sections, where the genetalized coordinate vector of the system is now:
\begin{equation}
  p=\{x_b,y_b,\theta_b,q_1,q_2,Q_1,Q_2\}
  \label{new_coordinates}
\end{equation}
and its dimension depends on the number of modeshapes chosen (e.g. for $n=1$, $p\in\mathbb{R}^7$).\\

Four boundary conditions need to be imposed regarding the space-varying part of the free vibration solution $W(x)$. Supposing "that the inertia of a lightweight link is small compared to the hub inertia", "then constrained mode shapes can be used. In particular, we assume each link to be clamped at the base"\cite{eighteen}:
\begin{equation}
  w_i(0,t)=0, \quad w_i'(0,t)=0
\end{equation} 
In addition, "experiments and recent analytical studies have shown that the clamped assumption is even enforced when choosing a feedback control loop around the joint"\cite{eighteen}.\\
Concerning the remaining boundary conditions, we "consider mass boundary conditions representing balance of moment and shearing force owing to other links of the serial structure of robot manipulators and the payload"\cite{seventeen,eighteen}:
\begin{equation}
  \begin{array}{c}
  (ES)_i\frac{\partial^2w_i(l_i,t)}{\partial x^2}=-J_{L_i}\frac{d^2}{dt^2}\Big(\frac{\partial w_i(l_i,t)}{\partial x}\Big)-M_{D_i}\frac{d^2}{dt^2}w_i(l_i,t)\\
  (ES)_i\frac{\partial^3w_i(l_i,t)}{\partial x^3}=-M_{L_i}\frac{d^2}{dt^2}w_i(l_i,t)+M_{D_i}\frac{d^2}{dt^2}\frac{\partial w_i(l_i,t)}{\partial x}
  \end{array}
  \label{boundary_conditions}
\end{equation}
where $M_{L_i}$, and $J_{L_i}$, are the actual mass and moment of inertia at the end of link~$i$. Moreover, $M_{D_i}$ accounts for the contributions of masses of distal links, i.e., noncollocated at the end of link $i$, weighted by the relative distance from axis $y$, (shearing axis at the end of link $i$). According to \cite{eighteen}, "these contributions are often not included in mode shape analyses: if the arm has only one link, $M_{L_i}$  and $J_{L_i}$ are directly the payload mass and inertia, while the additional terms on the right-hand side of (\ref{boundary_conditions}) vanish ($M_{D_i}=0$) only when the payload is balanced at the tip".\\ 
Given the $i$th link in an open kinematic chain, "$M_{L_i}$ is the constant sum of all masses beyond link $i$, but $J_{L_i}$, and $M_{D_i}$, depend on the position of successive links"\cite{eighteen}. The problem would be that, to have an exact computation, $J_{L_i}$, and $M_{D_i}$ should be written as functions of the joints, i.e., functions of time. The complexity would increase, and the computational power demanded would not allow online execution. Furthermore, writing $M_{D_i}$ as a function of time would go against the assumption of separation of variables (\ref{separability}): the spatial function cannot be a function of time too. Therefore, "some practical approximation leading to constant-although nonzero-boundary conditions at the link end might be in order. For instance, a convenient position is to set $M_{D_i}=0$ and compute $J_{L_i}$, for a fixed arm configuration"\cite{eighteen}.\\
In the case of a planar RR manipulator, like the one used in this thesis, we would have:
\begin{equation}
  \begin{array}{l}
    M_{L_1}=m_2+m_p\\
    J_{L_1}=I_{2,z}+I_{O,z}+m_Ol_2^2\\
    M_{D_1}=(m_2\frac{l_2}{2}+m_Ol_2)\cos{q_2}-\chi\sin{q_2}
  \end{array}
\end{equation}
where $\chi$ is a term of an order of magnitude smaller than the first one, hence can be neglected~\cite{eighteen}.\\
Notice that in the considered case of only two links, $J_{L_1}$ is a constant; for more than two links, $J_{L_1}$ will become a function of the generalized coordinate of link three and the following ones.\\
On the other hand for link 2:
\begin{equation}
  \begin{array}{l}
    M_{L_2}=m_p\\
    J_{L_2}=I_{O,z}\\
    M_{D_2}=0
  \end{array}
\end{equation}
However, $M_{D_1}$ can be rendered constant for a fixed arm configuration: assuming small displacement and initial position $q_{2,0}=\pi/2$, leads to $M_{D_1}=0$. That is why this has been chosen as the initial condition in both Section~\ref{rigid} and this one.\\
By substituting in the boundary conditions equations the solutions (\ref{time},\ref{space}), the homogeneous solution for link $i$ and mode shape $j$ is \cite{seventeen,eighteen}:
\begin{equation}
  W_{i,j}(x)=C_{i,j}[\cos{(\beta_{i,j} x)}-\cosh{(\beta_{i,j} x)}+\nu_i(\sin{(\beta_{i,j} x)}-\sinh{(\beta_{i,j} x)})]
  \label{lateral_solution}
\end{equation}
where:
\begin{equation}
  \nu_{i,j}=\frac{\sin{(\beta_{i,j}l_i)}-\sinh{(\beta_{i,j}l_i)}+M\beta_{i,j}[\cos{(\beta_{i,j}l_i)}-\cosh{(\beta_{i,j}l_i)}]}{\cos{(\beta_{i,j}l_i)}+\cosh{(\beta_{i,j}l_i)}-M\beta_{i,j}[\sin{(\beta_{i,j}l_i)}-\sinh{(\beta_{i,j}l_i)}]}
\end{equation}
with: 
\begin{equation}
  M=\frac{M_L}{\rho A l}, \quad J=\frac{J_L}{\rho Al^3}
\end{equation}
and $\beta_{i,j}$ are solutions of the frequency equation:
\begin{equation}
  \begin{split}
  1+\cos{(\beta_{i,j}l_i)}\cosh{(\beta_{i,j}l_i)}&-M\beta_{i,j}[\cosh{(\beta_{i,j}l_i)}\sin{(\beta_{i,j}l_i)}-\sinh{(\beta_{i,j}l_i)}\cos{(\beta_{i,j}l_i)}]\\
  &-J\beta_{i,j}^3[\cosh{(\beta_{i,j}l_i)}\sin{(\beta_{i,j}l_i)}+\sinh{(\beta_{i,j}l_i)}\cos{(\beta_{i,j}l_i)}]\\
  &+MJ\beta^4[1-\cosh{(\beta_{i,j}l_i)}\cos{(\beta_{i,j}l_i)}]=0
  \end{split}
  \label{freq_equation}
\end{equation}
The remaining constant in equation (\ref{lateral_solution}) (i.e. $C_{i,j}$) is found by mass normalizing the mode shape \cite{nineteen,twenty}:
\begin{equation}
  \int_{0}^{l_i}\rho_i A_i W_{i,j}^2(x)dx=1
\end{equation}
where the RHS of the equation is the modal mass of the $j$th mode of the $i$th link and $\rho_i=m_i/l_i$.\\
Mode shapes, in fact, can be normalized in different ways (normalization to the unit length vector, normalization to the largest component equal to unity), but the mass normalization is the most common one \cite{nineteen,twenty}, since it allows to have modal displacements with a physical meaning, since they are related to the modal mass.\\
The choice of the normalization, however, does not affect the value of the natural frequencies, which are the same for all the normalizations and depend only on equation (\ref{freq_equation}).\\

Once $W_{i,j}(x)$ are known, the kinematics can be evaluated through (\ref{new_kinematics}), and the dynamics can be calculated as in the previous sections, with the awareness that it is not possible to neglect the potential energy anymore.\\
If, in the previous sections, the absence of gravity and the rigidity of the bodies allowed them to be ignored, now the manipulators' arms are modeled as elastic bodies. Thus, the elastic potential energy needs to be taken into account.\\
The elastic energy for unit length stored in a bent beam can be written as \cite{book}:
\begin{equation}
  \frac{dU}{dx}=\frac{1}{2}\frac{M^2}{ES}
  \label{partial_elastic}
\end{equation}
with $M$ torque moment, which can be expressed as:
\begin{equation}
  M=ES\kappa
  \label{torque_moment}
\end{equation}
where $\kappa$ is the curvature of the deformation, defined as the derivative of the deformation angle $\varphi$:
\begin{equation}
  \kappa=\frac{d\varphi}{dx}=\frac{d}{dx}\frac{\partial w(x,t)}{\partial x}=\frac{\partial^2 w(x,t)}{\partial x^2}
  \label{curvature}
\end{equation}
By substituting (\ref{curvature}) in (\ref{torque_moment}) and then in (\ref{partial_elastic}), by integration along the beam direction, we get:
\begin{equation}
  \begin{split}
  U&=\frac{1}{2}\int_{0}^{l_i}ES\Big(\frac{\partial^2 w(x,t)}{\partial x^2}\Big)^2\,dx\\
   &=\frac{1}{2}\int_{0}^{l_i}ES\Big(\frac{\partial^2 W(x)}{\partial x^2}Q(t)\Big)^2\,dx
  \end{split}
\end{equation}
which is the same equation reported in \cite{seventeen,eighteen}.\\
The new Lagrangian will be now:
\begin{equation}
  \mathcal{L}_i = T_i-U_i
\end{equation}
and the dynamics of the system is given by:
\begin{equation}
  \begin{cases}
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{x}_b}-\frac{\partial \mathcal{L} }{\partial x_b}=F_x\cos{\theta_0}-F_y\sin{\theta_0}\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{y}_b}-\frac{\partial \mathcal{L} }{\partial y_b}=F_x\sin{\theta_0}+F_y\cos{\theta_0}\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{\theta}_0}-\frac{\partial \mathcal{L} }{\partial \theta_0}=\tau_0\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_1}-\frac{\partial \mathcal{L} }{\partial q_1}=\tau_1\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{q}_2}-\frac{\partial \mathcal{L} }{\partial q_2}=\tau_2\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{Q}_1}-\frac{\partial \mathcal{L} }{\partial Q_1}=0\\
    \frac{d}{dt}\frac{\partial \mathcal{L} }{\partial \dot{Q}_2}-\frac{\partial \mathcal{L} }{\partial Q_2}=0
  \end{cases}
\end{equation}
since no torque is applied to control the vibrations at the arm's end.\\
We can directly find the stiffness matrix of the system without calculating from scratch the equations of motion through the following considerations:
\begin{equation}
  \frac{d}{dt}\frac{\partial U}{\partial \dot{Q}_i}-\frac{\partial U}{\partial Q_i}=0-Q(t)\int_{0}^{l_i}ES\frac{\partial^2 W(x)}{\partial x^2}\,dx
\end{equation}
Hence, as reported in \cite{sixteen}, the new set of dynamical equation is obtained in the form:
\begin{equation}
  M\ddot{p}+C+Kp=u+J^Tf_I
\end{equation}
which is similar to the equation of motion of Chapter~\ref{impact_analysis} (\ref{initial_impact}), with the addition of the stiffnes matrix $K=\operatorname{diag}(\textbf{0},K_1,K_2)$ where:
\begin{equation}
  K_i=\int_{0}^{l_i}E_iS_i\frac{\partial^2 W_i(x)}{\partial x^2}\,dx
\end{equation}
Following the same procedure shown in the previous Chapter and in Section~\ref{rigid}, under the assumption that during the impact no change in the VMS' positions happens (i.e. we can neglet matrix $K$ and follow the exact same calculus), the dynamic equation of the whole system VMS plus payload becomes \cite{sixteen}:
\begin{equation}
  M'\ddot{p}+C'+Kp=u
\end{equation}
similar to (\ref{VMS_dynamics}) and with $p$ as in (\ref{new_coordinates}).
\newpage
\subsection{Free Motion}
The frequency equation (\ref{freq_equation}) is a transcendental equation, so it has been solved with a finding-root algorithm (Mathematica provides it with a built-in command \texttt{FindRoot}).\\
A free motion simulation has been performed with the same initial conditions and parameters of the previous section, adding the new ones exposed in Table~\ref{elastic_parameters}. The arms flexural rigidity $ES_i$ has been calculated by considering a circular cross section with diameter $d$, which gives us the value of the area moment of inertia:
\begin{equation}
  S=\frac{\pi}{64}d^4
\end{equation}
and as material aluminum, which has a Young's modulus $E\approx \SI{70}{\giga\pascal}$.\\
Only one mode has been taken into consideration for the complexity of the calculations (i.e. $n=1$).\\
The joints' evolution can be seen in Figure~\ref{free_elastic_1} and \ref{free_elastic_2}.\\
As it can be seen, the rigid coordinates have the same behaviour as in the rigid case, as they should be, with the only difference being that a little vibration is present.\\
Furthermore, the initial velocity of the elastic coordinates has the same sign (direction) of the rigid ones. This makes sense since when the arm starts to move, it starts to vibrate in the same direction.\\
It is interesting to notice that for both simulations, one arm's vibration seems to diverge. To better inspect this phenomenon, a longer temporal window of the two joints in the first simulation has been analyzed in Figure~\ref{beat}. For some instants, such as for $t=\SI{40}{\second}$, the two arms reach the highest amplitude at the same time, while for others, like $t=\SI{50}{\second}$, one's amplitude increases while the other's reaches its minimum.\\
If we look at the configuration of the arm at those instant, we would see that in the first case the manipulator is fully streched, meaning that it reaches its singular configuration, while in the second case the angle between the two arms is \SI{90}{\degree}. Given the non-constant relative position between the manipulator's arms, the vibration of one influences the second's and when they are aligned, they enforce each other's vibration, whereas when they are orthogonal, one vibration is suppressed by the other.
\begin{table}[h]
  \caption{VMS elastic parameters.}
  \label{elastic_parameters}
  \begin{center}
  \begin{tabular}{cccccccc}
    \toprule
    $\rho_1$&$\rho_2$&$ES_1$&$ES_2$&$A_1$&$A_2$\\
  \midrule
    \SI{53.67}{\kilogram\over\metre}&\SI{53.67}{\kilogram\over\metre}&\SI{1.14e7}{\newton\over\metre^2}&\SI{1.14e7}{\newton\over\metre^2}&\SI{4.52e-2}{\metre^2}&\SI{4.52e-2}{\metre^2}\\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}
\begin{figure}[h]
  \centering
  \subfloat{\includesvg[scale=0.35]{elastic_free_x.svg}} \quad
  \subfloat{\includesvg[scale=0.35]{elastic_free_y.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_free_theta.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_free_q1.svg}}\quad
  \subfloat{\includesvg[scale=0.35]{elastic_free_q2.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_free_QQ1.svg}}\quad
  \subfloat{\includesvg[scale=0.35]{elastic_free_QQ2.svg}}\\
  \caption{VMS generalized coordinates’ displacement after the catching of the payload
  when no control is performed, Simulation 1. Arms modeled as Euler-Bernoulli beams.}
  \label{free_elastic_1}
\end{figure}
\begin{figure}[h]
  \centering
  \subfloat{\includesvg[scale=0.35]{elastic_free_x2.svg}} \quad
  \subfloat{\includesvg[scale=0.35]{elastic_free_y2.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_free_theta.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_free_q12.svg}}\quad
  \subfloat{\includesvg[scale=0.35]{elastic_free_q22.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_free_QQ12.svg}}\quad
  \subfloat{\includesvg[scale=0.35]{elastic_free_QQ22.svg}}\\
  \caption{VMS generalized coordinates’ displacement after the catching of the payload
  when no control is performed, Simulation 2. Arms modeled as Euler-Bernoulli beams.}
  \label{free_elastic_2}
\end{figure}
\begin{figure}
  \centering
  \subfloat[\emph{First joint.}]{\includesvg[scale=0.6]{beat_1.svg}}\\
  \subfloat[\emph{Second joint.}]{\includesvg[scale=0.6]{beat_2.svg}}\\
  \caption{Extended temporal window of joints' elastic coordinates for Simulation 1. The oscillations change in time due to the movement of the arms.}
  \label{beat}
\end{figure}
\newpage
\section{Control Based Motion}
As mentioned in \cite{thirteen}, "for flexible-link manipulators the control is not straightforward, because it involves the elastic degrees of freedom. Also, measurement of the angle between two links at a joint represent the sum of the angle between the two coordinate frames and the slopes of the elastic deformation at the joints".\\
There can be three approaches for the flexible system control\cite{thirteen}:
\begin{itemize}
  \item Elastic effects are ignored, i.e. the equation of motion is assumed to be as in (\ref{final_equation_motion}). However, "the torque computed by this model would give good results only if the elastic effects are negligible, otherwise it may result in gross inaccuracies in the positioning of the end-effector".
  \item The mathematical model incorporates elastic effects, with their amplitudes estimated from sensor data using an estimator. In this approach, elastic deformations are considered known disturbances but are not explicitly regulated.
  \item Active control of both rotational and bending coordinates is achieved by applying torques and generalized forces. This level of control is feasible only if the system includes actuators capable of exerting "transverse forces on the links"\cite{thirteen}. Furthermore, it requires access to measurements of the elastic generalized coordinates and their rates.
\end{itemize}
Since we have already analyzed the first (rigid) case and the third would require additional sensors and further research in the "vibration control" field, the only feasible model is the second one.\\
Similarly to what has been done in Section~\ref{control_motion} and equation (\ref{one_control}), only the rotational coordinates $q_1$ and $q_2$ are actively controlled. This time, however, the distinction is between translational, rotational and elastic:
\begin{equation}
  \begin{bmatrix}
    M'_{tt}&M'_{tr}&M'_{te}\\
    M'_{rt}&M'_{rr}&M'_{re}\\
    M'_{et}&M'_{er}&M'_{ee}
  \end{bmatrix}
  \begin{bmatrix}
    \ddot{p}_t\\
    \ddot{p}_r\\
    \ddot{p}_e
  \end{bmatrix}+\begin{bmatrix}
    C'_t\\
    C'_r\\
    C'_e
  \end{bmatrix}=\begin{bmatrix}
    \textbf{0}\\
    u\\
    \textbf{0}
    \end{bmatrix}
    +\begin{bmatrix}
      0&0&0\\
      0&0&0\\
      0&0&K
    \end{bmatrix}\begin{bmatrix}
      p_r\\
      p_t\\
      p_e
    \end{bmatrix}
\end{equation}
For simplicity, we move the uncontrolled coordinates together:
\begin{equation}
  \begin{bmatrix}
    M'_{rr}&M'_{rt}&M'_{re}\\
    M'_{tr}&M'_{tt}&M'_{te}\\
    M'_{er}&M'_{et}&M'_{ee}
  \end{bmatrix}
  \begin{bmatrix}
    \ddot{p}_r\\
    \ddot{p}_t\\
    \ddot{p}_e
  \end{bmatrix}+\begin{bmatrix}
    C'_r\\
    C'_t\\
    C'_e
  \end{bmatrix}=\begin{bmatrix}
    u\\
    \textbf{0}\\
    \textbf{0}
    \end{bmatrix}
\end{equation}
with $M'_{jk}=M'_{kj}$ for the symmetry property of the mass matrix and its submatrices.\\
Now, by setting:
\begin{equation}
  \begin{bmatrix}
    p_t\\
    p_e
  \end{bmatrix}=p_{nc}, \quad \quad \bar{K}=\begin{bmatrix}
    0&0\\
    0&K
  \end{bmatrix}
\end{equation}
where $nc$ stands for "non-controlled", we get to the following equation:
\begin{equation}
  \begin{bmatrix}
    M'_{rr}&M'_{r,nc}\\
    M'_{nc,r}&M'_{nc,nc}
  \end{bmatrix}\begin{bmatrix}
    \ddot{p}_r\\
    \ddot{p}_{nc}
  \end{bmatrix}+\begin{bmatrix}
    C'_r\\
    C'_{nc}
  \end{bmatrix}+\begin{bmatrix}
    0&0\\
    0&\bar{K}
  \end{bmatrix}\begin{bmatrix}
    p_r\\
    p_{nc}
  \end{bmatrix}=\begin{bmatrix}
    u\\
    \textbf{0}
  \end{bmatrix}
\end{equation}
In this way, we have arrived at a similar formulation as the one in (\ref{one_control}). By writing the uncontrolled coordinate as a function of the rotational ones:
\begin{equation}
  \ddot{p}_{nc}=-{M'}_{nc}^{-1}({M'}_{nc,r}\ddot{p}_r+{C'}_{nc}+\bar{K})
\end{equation}
and pluggin it in the first row:
\begin{equation}
  \bar{M}\ddot{p}_r+\bar{C}=u
\end{equation}
with:
\begin{equation}
  \bar{M}=M'_{rr}-M'_{nc,r}{M'}_{nc,nc}^{-1}M'_{nc,r}, \quad \bar{C}=C'_r-M'_{r,nc}{M'}_{nc,nc}^{-1}C'_{nc}-{M'}_{r,nc}{M'}_{nc,nc}^{-1}\bar{K}p_{nc}
\end{equation}
Through a feedback linearization (\ref{feedback_linearization}), we can control the manipulator's joints $p_r=\{q_1,q_2\}$ letting $p_{nc}=\{x_b,y_b,\theta_0,Q_1,Q_2\}$ free to move.\\
Figures~\ref{contolled_elastic_1} and \ref{controlled_elastic_2} show the VMS behaviour after the impact. Now, since the arms do not move anymore after the system has reached the equilibrium position, the oscillations of the arms are constant in time (and do not damp out since no damping has been considered, see Figure~\ref{no_beat}).\\
Again, the rigid coordinates behave in a similar way as for the rigid case.
\begin{figure}[h]
  \centering
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_x.svg}} \quad
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_y.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_theta.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_q1.svg}}\quad
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_q2.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_QQ1.svg}}\quad
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_QQ2.svg}}\\
  \caption{VMS generalized coordinates’ displacement after the catching of the payload
  when control is performed, Simulation~1. Arms modeled as Euler-Bernoulli beams.}
  \label{contolled_elastic_1}
\end{figure}
\begin{figure}[h]
  \centering
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_x2.svg}} \quad
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_y2.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_theta.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_q12.svg}}\quad
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_q22.svg}}\\
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_QQ12.svg}}\quad
  \subfloat{\includesvg[scale=0.35]{elastic_controlled_QQ22.svg}}\\
  \caption{VMS generalized coordinates’ displacement after the catching of the payload
  when control is performed, Simulation~2. Arms modeled as Euler-Bernoulli beams.}
  \label{controlled_elastic_2}
\end{figure}
\begin{figure}
  \centering
  \subfloat[\emph{First joint.}]{\includesvg[scale=0.6]{no_beat_1.svg}}\\
  \subfloat[\emph{Second joint.}]{\includesvg[scale=0.6]{no_beat_2.svg}}\\
  \caption{Extended temporal window of joints' elastic coordinates for Simulation 1. The oscillations are constant since the arms do not move after the impact.}
  \label{no_beat}
\end{figure}
\chapter{Inertial and Kinetics Properties Retrieval}
In the previous chapter, the captured object has been considered as a deterministic disturbance, i.e. the inertia and dynamic properties have been supposed known.\\
However, in real case scenarios, the payload mass can be unknown (e.g., a small meteorite's capture or a satellite's estimated mass).\\
In this chapter, the same problem of payload docking will be analyzed supposing unknown mass, trying to retrieve it from the manipulator post-impact dynamics together with its initial velocities, which are not known a priori.\\
Only the rigid-bodies scenario will be taken into account, as the elastic-bodies scenario would require a lot of computational power and is very similar.\\
When the mass is not known, an estimate of the mass has to be injected in the control law (\ref{feedback_linearization}). This value can be estimated by visual techniques or thanks to previous knowledge.\\
Before starting to calculate the real mass, some approximations have to be taken into account:
\begin{itemize}
  \item the spacecraft does not move; this has already been shown as a good approximation in the previous chapter;
  \item the spacecraft does not rotate; this has also been shown in the previuos calculations (see Figures~\ref{controlled_motion_1}, \ref{controlled_motion_2});
  \item given the little displacements after the impact, the dynamic can be linearized around the equilibrium position.
\end{itemize}
The following equation describes the VMS dynamics:
\begin{equation}
  M'\ddot{p}+C'=u
\end{equation}
but under these assumptions, it can be rewritten as:
\begin{equation}
  M'(q_1,q_2)\begin{bmatrix}
    \ddot{q}_1\\
    \ddot{q}_2
  \end{bmatrix}+C'(q_1,q_2,\dot{q}_1,\dot{q}_2)=u(q_1,q_2,\dot{q}_1,\dot{q}_2)
\end{equation}
Furthermore, the dynamics can be linearized around the equilibrium position (i.e. the initial one) through a Taylor expansion up to the first order \cite{twentyone}:
\begin{equation}
  D(\textbf{x})=D(q_1,q_2,\dot{q}_1,\dot{q}_2,\ddot{q}_1,\ddot{q}_2)=M'(q_1,q_2)\begin{bmatrix}
    \ddot{q}_1\\
    \ddot{q}_2
  \end{bmatrix}+C'(q_1,q_2,\dot{q}_1,\dot{q}_2)
\end{equation}
\begin{equation}
  D(\textbf{x})\approx D(\bar{\textbf{x}})+(\textbf{x}-\bar{\textbf{x}})^T\nabla T(\textbf{x})
\end{equation}
where $\bar{\textbf{x}}=\{q_{1,0},q_{2,0},0,0,0,0\}$ is the equilibrium point and $\nabla T(\bar{\textbf{x}})$ is the gradient of $T(\textbf{x})$ evaluated at $\textbf{x}=\bar{\textbf{x}}$. The code used in Wolfram is available in the Appendix~\ref{code}.\\
The control can now be found as in equation (\ref{feedback_linearization}):
\begin{equation}
  u=\hat{M}[\ddot{q}_d+K_d(\dot{q}_d-\dot{q})+K_p(q_d-q)]+\hat{C}
\end{equation}
with $q=\{q_1,q_2\}$, but now the mass inside the control is a guessed mass, different from the actual one and thus $\hat{M}\neq M'$, $\hat{C}\neq C'$, where the "hat" matrices are the ones where the real mass of the captures satellite has been substitute with the initial guess mass.\\
However, after linearization $C'=0$, the only error in the new equation is due to the mass matrix (along with the linearization error). The input becomes then:
\begin{equation}
  u_{lin}=\hat{M}_{lin}[\ddot{q}_d+K_d(\dot{q}_d-\dot{q})+K_p(q_d-q)]
\end{equation}
and the final coupled dynamics:
\begin{equation}
  M_{lin}\ddot{q}+C_{lin}\dot{q}+K_{lin}q-\delta=0
\end{equation}
where $C_{lin}$ and $K_{lin}$ come from the linearized control input $u_{lin}$ and $\delta$ from the desired final positions.\\
Different approaches have been investigated to find the actual mass, and they will be hereafter investigated, from the worst to the best one.
\newpage
\section{Mass Extraction: Joints' Decoupling} \label{decoupling}
The first method requires another strong assumption that will be validated a posteriori: the displacement of one arm in the controlled dynamics is negligible for the displacement of the other arm. From Figures~\ref{controlled_motion_1}, \ref{controlled_motion_2} it can be seen that also the arms displacement is little, so we can approximate them to zero when analyzing the other arm's dynamics.\\
This is true when $\hat{M}=M'$, for the input control has been designed to uncouple the equations automatically, so when the error is small, we can approximate the real mass matrix with the guessed one and decouple the equation. The nearer to the true mass the guessed one is, the more accurate will be its retrieval.\\
Conceptually, we can see the input control as follows:
\begin{equation}
  u=-M'[K_d\dot{q}+K_p(q-q_d)]+C-dM[K_d\dot{q}+K_p(q-q_d)]+dC=u_e+du
\end{equation}
where the effective control $u_e$ is the one which decouples the equations and the error input $du$ couples them again due to the error matrices $dM$ and $dC$.\\
After linearization, however, we can make use of one fundamental property of linear systems, which is the superposition principle (i.e. a linear combination of inputs produces a linear combination of the outputs):
\begin{equation}
  \begin{cases}
    M_{lin}\ddot{q}=u_{lin,e}\\
    M_{lin}\ddot{q}=du_{lin}
  \end{cases}
\end{equation}
The assumption made is then to neglect $du_{lin}$ and consider only the effective one and 
\begin{equation}
\lim_{\hat{m} \to m}du_{lin}=0
\end{equation}
With these suppositions, we can uncouple the dynamics of the two arms since the accelerations and velocities of all the other coordinates are set to zero.
\begin{figure}[h]
  \centering
  \subfloat[\emph{$q_1$ time evolution.}]
  {\includesvg[scale=0.4]{approximation1_pi2.svg}} \\
\subfloat[\emph{$q_2$ time evolution.}]
  {\includesvg[scale=0.4]{approximation2_pi2.svg}}
  \caption{Arms behaviours with estimated mass \SI{2000}{\kilogram}, with (blue) and without (orange) approximations for the first simulation.}
  \label{approximations}
\end{figure}\\
Figure~\ref{approximations} shows two time evolutions of the displacement of both arms with and without applying the approximation made above for the configuration assumed in the previous Chapter (i.e. $q_{1,0}=0,q_{2,0}=\pi/2$). The error is minimal.\\
We can now rewrite the controlled dynamics (\ref{controlled_dynamics}) of the two arms as follows:
\begin{equation}
  \begin{array}{l}
    \tilde{m}_1\ddot{q}_1+\hat{m_1}k_d\dot{e_1}+\hat{m_1}k_p e_1=0\\
    \tilde{m}_2\ddot{q}_2+\hat{m_2}k_d\dot{e_2}+\hat{m_2}k_p e_2=0
  \end{array}
\end{equation}
where $\tilde{m}(m,\hat{m})$.\\
Since the real mass is unknown, the approximation $M'=\hat{M'}$ is not possible anymore, that is why the supposed mass $\hat{m}$ appears in the equation.\\
We can divide for $m_1$ and $m_2$ to get:
\begin{equation}
  \begin{array}{l}
    \ddot{q}_1+\frac{\hat{m_1}}{\tilde{m}_1}k_d\dot{e}_1+\frac{\hat{m_1}}{\tilde{m}_1}k_p e_1=0\\
    \ddot{q}_2+\frac{\hat{m_2}}{\tilde{m}_2}k_d\dot{e}_2+\frac{\hat{m_2}}{\tilde{m}_2}k_p e_2=0
  \end{array}
  \label{approx_dynamics}
\end{equation}
When the new control law with the estimated mass is applied, the behaviour is not critically damped anymore, as we can see from equations (\ref{approx_dynamics}): the new damping coefficient is now given by:
\begin{equation}
  \xi'=\frac{\hat{m}k_v}{2\omega_n \tilde{m}}=\frac{\hat{m}2\sqrt{k_p}}{2\sqrt{\frac{\hat{m}}{\tilde{m}}k_p} \tilde{m}}=\sqrt{\frac{\hat{m}}{\tilde{m}}}
  \label{mass_relation}
\end{equation}
\newpage
\subsection{Direct Solution}
\subsubsection{Position Roots}
Given the simplicity of the equation of motions, a direct symbolic solution, containing $\hat{m}$ as a parameter, can be easily found (i.e. $q(t,\hat{m})$).\\
Figure~\ref{parametric_plot} shows how the time response of the first joint for the first simulation changes according to the estimated mass. It is of particular interest that the first peak increases as the estimated mass increases.
\begin{figure}[h]
  \centering
  \includesvg[scale=0.45]{parametric_plot.svg}
  \caption{Parametric plot of the first joint's time evolution, first simulation. The real mass is $\SI{3000}{\kilogram}$. A visual parameter setting can be possible by confronting this plot with the real one (see Figure~\ref{q1_real}).}
  \label{parametric_plot}
\end{figure}\\
Hence, once the peak time $t^*$ is found, the real mass can be calculated by solving the following equation:
\begin{equation}
  q(t^*,\tilde{m})=q^*
\end{equation}
with $q^*$ the peak value.
\subsubsection{Mass Fit}
Furthermore, a minimization problem can be written to make the solution fit the available data. In the Wolfram software, the \texttt{NonLinearModelFit} command is available, allowing for nonlinear regression of a function by varying its parameters. In this case, the function to be optimized is the joint time evolution, and its parameter is the satellite mass.\\
An essential aspect of this approach is that it allows us to work with noisy data since the regression tries to minimize the overall error, whereas noise in the previous method seen above could disturb the overshoot's amplitude and time instant too much. Figure~\ref{noise} shows the time evolution of the first joint in the first simulation with a white noise $w(t)\sim \mathcal{N} (0,0.005)$.
\begin{figure}[h]
  \centering
  \includesvg[scale=0.3]{noisy_data.svg}
  \caption{Noisy data to simulate a real scenario in orange.}
  \label{noise}
\end{figure}
\newpage
\subsection{Closed Form Solution}
Now that we have linear second-order differential equations (\ref{approx_dynamics}), two methods have been introduced to retrieve the inertial properties of the payload (i.e. its mass). The first one, exposed in this section, is based on the fact that the solution of equations (\ref{approx_dynamics}) is known.
\subsubsection{Derivative Roots}
Given zero initial velocities, from equation (\ref{approx_dynamics}) one gets the generic equation for one joint:
\begin{equation}
  \tilde{m}\ddot{q}+\hat{m}k_d\dot{q}+\hat{m}k_p (q-q_d)=0
\end{equation}
The desired position is not zero in the general case. However, by moving the term on the RHS of the equation, we get a forced differential equation with constant external input:
\begin{equation}
  \tilde{m}\ddot{q}+\hat{m}k_d\dot{q}+\hat{m}k_p q=\hat{m}k_pq_d
  \label{new_q}
\end{equation}
Equation (\ref{new_q}) can be considered as a system subjected to a step function of amplitude $F_0=\hat{m}k_pq_d$. The particular solution of such system is also known:
\begin{equation}
  \begin{split}
  q_f(t)&=\frac{F_0}{k}\Big[1-\frac{e^{-\xi\omega_nt}}{\sqrt{1-\xi^2}}\sin{(\omega_dt+\theta)}\Big]\\
  &=q_d\Big[1-\frac{e^{-\xi\omega_nt}}{\sqrt{1-\xi^2}}\sin{(\omega_dt+\theta)}\Big]
\end{split}
\end{equation}
with $\theta=\arccos{\xi}$ and $k=\hat{m}k_p$ elastic coefficient.\\
The total solution will be given by the sum of the homogeneous and the particular solution, which are both known:
\begin{equation}
  q(t)=q_d\Big[1-\frac{e^{-\xi\omega_nt}}{\sqrt{1-\xi^2}}\sin{(\omega_dt+\theta)}\Big]+\Big[q_0\cos{(\omega_d)t}+\frac{\dot{q}_0+\xi\omega_n q_0}{\omega_d}\sin{(\omega_dt)}\Big]e^{-\xi \omega_n t}
  \label{closed_form}
\end{equation}
where $q_0,\dot{q}_0$ are the initial position and velocity of the joint and $\omega_d=\sqrt{1-\xi^2}\omega_n$. Notice that $\dot{q}_0$ is now given by the velocity of the joint after the impact, which can be retrieved as the derivative of the data at the time $t=0$.\\
It is easier to find a relationship between the real mass and the peak time $t^*$ by differentiating equation (\ref{closed_form}), so that the RHS term becomes zero since the peak is a stationary point:
\begin{equation}
  \sqrt{1-\xi^2}\cos{(\sqrt{1-\xi^2}\omega_nt^*)-\xi\sin{(\sqrt{1-\xi^2\omega_nt^*})}}=0
  \label{time_solution}
\end{equation}
which can be rearranged as:
\begin{equation}
  \begin{array}{l}
  \tan{(\sqrt{1-\xi^2}\omega_nt^*)}=\frac{\sqrt{1-\xi^2}}{\xi}\\
  \Rightarrow \tan{(\sqrt{1-\xi^2}\omega_nt^*)}=\beta(\xi)
\end{array}
\end{equation}
The intersection of the two functions allows us to calculate the damping coefficient of the equation and thus the actual mass from relation (\ref{mass_relation}).\\
Note that equation (\ref{time_solution}) does not depend on the equilibrium position; hence, it holds for the general case.
\subsubsection{Damping Coefficient and Natural Frequency Fit}
Similarly at what has been done for the mass fit, the same built-in command \texttt{NonLinearModelFit} is used inserting as interpolating function equation (\ref{closed_form}), with parameters $\xi$ and $\omega_n$, which are both equal to $\sqrt{\frac{\hat{m}}{\tilde{m}}}$ (see Section~\ref{decoupling}).
\newpage
\section{Mass Extraction: Coupled Solution}
The problem with the joints' decoupling assumption is that it depends on the joints' configuration, as will be better exposed in the next Chapter.\\
Without decoupling them, it would not be easy to find a closed-form solution, and, given the computational power available, different approaches can be evaluated.\\
This section will explore two methods by solving the coupled linear equation directly and performing a minimization of a cost function.
\subsection{Continuous Domain}
Wolfram has a built-in command, \texttt{ParametricNDSolve}, which allows one to solve numerically differential equations with uknown values (e.g. the actual mass $m$).\\
The output is a parametric function $q(m,t)$ that, given a mass value, returns a continuous function in time.\\
A cost function $\Gamma$ can be written as the integral along the simulation period $T$ of the squared residuals between the found solution and the actual evolution of the joint in time (given from the satellite captured):
\begin{equation}
  \Gamma(m)=\int_{0}^{T}\Big[q(m,t)-q_{data}(t)\Big]^2
\end{equation}
By setting the gradient of $\Gamma$ to zero, we can find the mass that minimizes the cost function, i.e. the true mass:
\begin{equation}
  m^*=\min_{m}\Gamma(m)
\end{equation}
Even if this method gives better and more consistent results than the previous ones (as shown in the next Chapter), the computational power required to solve a minimization of an integral could be too demanding. That is why a second, more efficient approach has been explored.
The actual code used in Wolfram is available in Appendix~\ref{code}.
\newpage
\subsection{Discrete Domain}
The same problem can be described by discretizing the available data and the differential equations solutions in a finite number of points in time.\\
However, to do so, a symbolic parametric solution of the coupled equations needs to be available, and Wolfram does not manage to solve them.\\
For this section, another software has been used to solve the equations directly, Maple 2024.2, whose commands are reported in Appendix~\ref{code} as well.\\
Maple manages to solve the joints' motion as a function of time and mass (the results are listed in Appendix~\ref{maple_q1}, \ref{maple_q2}); it is now possible to discretize the solution:
\begin{equation}
  \varGamma(m)=\sum_{k=0}^{N_p}\Big[q(m,\frac{T}{N_p}k)-q_{data}(\frac{T}{N_p}k)\Big]^2
\end{equation}
where $N_p$ is the number of discretization points.\\
In the same way as for the continuous case, the gradient of the cost function is set to zero, and the optimal mass can be calculated.\\
The number of discretization points should not be too low in order not to have a huge discretization error, nor too high to avoid great computational resources.\\
For this thesis, it has been found that $N_p=5$ gives better results than the Joints' Decoupling method. Conceptually, it is very similar to the Position Root one, with the difference that no input error $du$ is introduced, and the function is evaluated on more than one point.
\begin{figure}[h]
  \centering
  \subfloat[\emph{$N_p=5$.}]
  {\includesvg[scale=0.16]{discrete_5p.svg}} \quad
\subfloat[\emph{$N_p=25$.}]
  {\includesvg[scale=0.16]{discrete_25p.svg}}\\
  \subfloat[\emph{$N_p=50$.}]
  {\includesvg[scale=0.16]{discrete_50p.svg}}
  \caption{In blue is the continous solution, in red is the discretized one.}
\end{figure}
\newpage
\section{Velocity Extraction}
Once the mass is found, it would be interesting to ask what the satellite's velocity was before the impact.\\
Equation (\ref{final_velocities}) sets an important relation between final and initial velocities of the VMS and the satellite as well. In particular, the initial velocity of the VMS is known (since it is supposed to be still), and the velocities after the impact of the VMS (i.e. $\dot{p}_f$) can be found by derivating $p_{data}$ in $t=0$.\\
We can therefore isolate $\dot{\psi}_i$:
 
but since the VMS is at rest before the impact:
\begin{equation}
  \dot{\psi}_i=M_O^{-1}J_O^T(J^+)^TG\dot{p}_f
\end{equation}
On Wolfram, solving this system of equations gives excellent results regarding the translation velocity, while the angular velocity error is quite big due to numerical approximations.\\
In this thesis, however, the assumption that has been made is that the relative velocity between the satellite and the VMS is small, so by setting $\dot{\theta}_O=0$ the output is consistent (notice that the actual velocity in the simulation was set $\dot{\theta}_O=\SI{0.01}{\radian\per\second}$, see Table~\ref{initial_velocities}).
\chapter{Results and Conclusion}
In this Chapter, a comparison between the methods suggested in the previous sections will be displayed as well as plots with the results found for each approach.\\
The first section will focus on the mass outputs and considerations about the validity and efficiency of each method; the second section will focus on the error in finding the initial velocity given different guessed masses; the third one will contain the final considerations of this work and possible future improvements.
\newpage
\section{Mass Retrieval}\label{mass_retrieval}
The joints' decoupling method, as already mentioned, relies on three assumptions:
\begin{enumerate}
  \item Little displacement from initial position (linearization error);
  \item When the guessed mass is near to the true one, we can decouple the differential equations (approximation error);
  \item The guessed mass is not the real one (mass error).
\end{enumerate}
The first two errors depend on the VMS arms' configuration, i.e. on the direction of impact of the satellite and its inclination with respect to the manipulator.\\
In Chapter~\ref{impact_analysis} only one configuration and two different directions of impact (respectively called Simulation 1 and Simulation 2) have been analyzed. Here, different arms' configurations are studied.\\
However, $M_{lin}$, $C_{lin}$ and $K_{lin}$ do not depend on $q_{1,0}$, but on $q_{2,0}$ and $\hat{m}$ only: we can study different scenarios by changing the second joint's initial position and the guess mass only.\\
Figures~\ref{linear_error_1} and \ref{approximation_error_1} show the behaviour of the first joint for the study case Simulation 1 (i.e. the satellite approaches the manipulator with positive linear velocity in the $x$ direction and null velocity in the $y$ direction) for different values of $q_{2,0}$ with $\hat{m}=\SI{2000}{\kilogram}$ (the true satellite's mass is $m=\SI{3000}{\kilogram}$, as shown in Table~\ref{VMS_parameters}). The plots for the second joint follow the same behaviour and are listed in Appendix~\ref{appendix_plots}.\\
As it can be seen, when the displacement of one arm is little (e.g. when $q_{2,0}=\SI[parse-numbers = false]{\pi/2}{\radian}$ the second arm is almost still for the first simulation) the linear error is almost zero, while when there is a greater displacement (e.g. $q_{2,0}=\SI{0}{\radian}$) it is more relevant.\\
Similarly, the more the behaviour of one arm affects the movement of the other, the greater the approximation error is.\\
However, the linear error can be reduced by enabling a stronger control input, for example, by increasing the proportional gain $K_p$, which assures faster convergence to the desired value but could enhance overshoots (if not critically damped). On the other hand, the approximation error relies on the geometry of the impact, and it is more difficult to control.\\
Figures~\ref{q201},~\ref{q261},~\ref{q241},~\ref{q231}, and \ref{q221} show the mass found with the joints' decoupling methods for different guessed masses $\hat{m}$ for the first simulation. Since for each joint, we can evaluate one mass (i.e. two retrieved masses), its final value was obtained as the mean of the two. However, there are cases where the joint does not move and it is not possible to find the real mass: in those cases only the final mass found with the other joint is used (e.g. for the first simulation and $q_{2,0}=\SI[parse-numbers = false]{\pi/2}{\radian}$, the second joint, which lies on the satellite velocity direction does not move or very little).\\
Furthermore, there could be cases where no arm moves: in the singular configuration ($q_{1,0}=\SI{0}{\radian}$ and $q_{2,0}=\SI{0}{\radian}$), for the second simulation (i.e. when the satellite approaches with zero velocity in the $x$ direction) both arms remain still and only translation of the VMS occurs (see Figure~\ref{controlled_motion_2}). This is why in the Appendix~\ref{appendix_plots}, where the same Figures are shown for the second simulation, there is no plot of the configuration $q_{2,0}=\SI{0}{\radian}$.\\
With the uncoupled method, only the mass and linearization error hold since no approximation has been done. As a consequence, the results are much more reliable and consistent, as Figures~\ref{uncoupled_1} and \ref{uncoupled_2} show for both simulations and all considered configurations.\\
As already mentioned, for the second simulation, no mass can be retrieved when the manipulator's configuration is singular.\\
The method shown here is the continuous one only, since the discrete one gives similar results, as shown in Tables~\ref{uncoupled_comparison_1} and \ref{uncoupled_comparison_2}.
\begin{figure}
  \centering
  \input{tikz/singular_conf.tikz}
  \caption{When the manipulator is in its singular configuration, no displacement at the joints happens if the payload approaches with a north-to-south direction.}
\end{figure}
\begin{figure}[h]
  \centering
  \subfloat[\emph{$q_{2,0}=\SI{0}{\radian}$}]{\includesvg[scale=0.35]{lin_err1_0.svg}} \quad
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/6}{\radian}$}]{\includesvg[scale=0.35]{lin_err1_pi6.svg}}\\
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/4}{\radian}$}]{\includesvg[scale=0.35]{lin_err1_pi4.svg}}\quad
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/3}{\radian}$}]{\includesvg[scale=0.35]{lin_err1_pi3.svg}}\\
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/2}{\radian}$}]{\includesvg[scale=0.35]{lin_err1_pi2.svg}}
  \caption{Linearization error for different first arm's configuration, Simulation 1: non-linear solution in blue, linearized solution in orange, with $\hat{m}=\SI{2000}{\kilogram}$.}
  \label{linear_error_1}
\end{figure}
\begin{figure}[!h]
  \centering
  \subfloat[\emph{$q_{2,0}=\SI{0}{\radian}$}]{\includesvg[scale=0.35]{approximation1_0.svg}} \quad
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/6}{\radian}$}]{\includesvg[scale=0.35]{approximation1_pi6.svg}}\\
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/4}{\radian}$}]{\includesvg[scale=0.35]{approximation1_pi4.svg}}\quad
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/3}{\radian}$}]{\includesvg[scale=0.35]{approximation1_pi3.svg}}\\
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/2}{\radian}$}]{\includesvg[scale=0.35]{approximation1_pi2.svg}}
  \caption{Approximation error for different first arm's configuration, Simulation 1: non-approximated linearized solution in orange, approximated solution in blue, with $\hat{m}=\SI{2000}{\kilogram}$.}
  \label{approximation_error_1}
\end{figure}
\begin{figure}[!h]
  \centering
  \includesvg[scale=0.4]{masses0_1.svg}
  \caption{}
  \label{q201}
\end{figure}
\begin{figure}[h!]
  \centering
  \includesvg[scale=0.4]{massespi6_1.svg}
  \caption{}
  \label{q261}
\end{figure}
\begin{figure}[h!]
  \centering
  \includesvg[scale=0.4]{massespi4_1.svg}
  \caption{}
  \label{q241}
\end{figure}
\begin{figure}[h!]
  \centering
  \includesvg[scale=0.4]{massespi3_1.svg}
  \caption{}
  \label{q231}
\end{figure}
\begin{figure}[h!]
  \centering
  \includesvg[scale=0.4]{massespi2_1.svg}
  \caption{}
  \label{q221}
\end{figure}\\
\begin{figure}[h]
  \centering
  \includesvg[scale=0.38]{masses_uncoupled_1.svg}
  \caption{}
  \label{uncoupled_1}
\end{figure}
\begin{figure}[h]
  \centering
  \includesvg[scale=0.38]{masses_uncoupled_2.svg}
  \caption{}
  \label{uncoupled_2}
\end{figure}
\begin{table}[b]
  \caption{Uncoupled methods comparison for Simulation 1 and $q_{2,0}=\SI[parse-numbers = false]{\pi/2}{\radian}$.}
  \label{uncoupled_comparison_1}
  \begin{center}
  \begin{tabular}{lcc}
    \toprule
    \textbf{Guess Mass}&\textbf{Discrete Method}&\textbf{Continuous Method}\\
  \midrule
  \SI{500}{\kilogram}&\SI{2866.06}{\kilogram}&\SI{2864.48}{\kilogram}\\
  \SI{1000}{\kilogram}&\SI{2920.21}{\kilogram}&\SI{2920.38}{\kilogram}\\
  \SI{1500}{\kilogram}&\SI{2949.45}{\kilogram}&\SI{2949.72}{\kilogram}\\
  \SI{2000}{\kilogram}&\SI{2970.11}{\kilogram}&\SI{2969.52}{\kilogram}\\
  \SI{2500}{\kilogram}&\SI{2986.09}{\kilogram}&\SI{2986.22}{\kilogram}\\
  \SI{3000}{\kilogram}&\SI{2999.16}{\kilogram}&\SI{2997.87}{\kilogram}\\
  \SI{3500}{\kilogram}&\SI{3010.29}{\kilogram}&\SI{3010.44}{\kilogram}\\
  \SI{4000}{\kilogram}&\SI{3020.04}{\kilogram}&\SI{3018.57}{\kilogram}\\
  \SI{4500}{\kilogram}&\SI{3028.79}{\kilogram}&\SI{3028.93}{\kilogram}\\
  \SI{5000}{\kilogram}&\SI{3036.77}{\kilogram}&\SI{3035.47}{\kilogram}\\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}
\begin{table}[b]
  \caption{Uncoupled methods comparison for Simulation 2 and $q_{2,0}=\SI[parse-numbers = false]{\pi/2}{\radian}$.}
  \label{uncoupled_comparison_2}
  \begin{center}
  \begin{tabular}{lcc}
    \toprule
    \textbf{Guess Mass}&\textbf{Discrete Method}&\textbf{Continuous Method}\\
  \midrule
  \SI{500}{\kilogram}&\SI{2770.30}{\kilogram}&\SI{2759.61}{\kilogram}\\
  \SI{1000}{\kilogram}&\SI{2862.58}{\kilogram}&\SI{2874.43}{\kilogram}\\
  \SI{1500}{\kilogram}&\SI{2913.02}{\kilogram}&\SI{2881.21}{\kilogram}\\
  \SI{2000}{\kilogram}&\SI{2949.30}{\kilogram}&\SI{2918.53}{\kilogram}\\
  \SI{2500}{\kilogram}&\SI{2977.09}{\kilogram}&\SI{2996.60}{\kilogram}\\
  \SI{3000}{\kilogram}&\SI{2999.18}{\kilogram}&\SI{3017.16}{\kilogram}\\
  \SI{3500}{\kilogram}&\SI{3017.32}{\kilogram}&\SI{2957.75}{\kilogram}\\
  \SI{4000}{\kilogram}&\SI{3032.64}{\kilogram}&\SI{3028.08}{\kilogram}\\
  \SI{4500}{\kilogram}&\SI{3045.89}{\kilogram}&\SI{2992.76}{\kilogram}\\
  \SI{5000}{\kilogram}&\SI{3057.56}{\kilogram}&\SI{3144.85}{\kilogram}\\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}
\newpage
\section{Velocity Retrieval}
The velocity retrieval error has been calculated in two different ways since, for both simulations, the satellite's initial velocity is zero in one direction:
\begin{itemize}
  \item As a relative error for the non-zero initial velocity: \begin{equation}
    e_{\%}=\frac{|\dot{\psi}_{i,t}-\dot{\psi}_{i,r}|}{\dot{\psi}_{i,t}}*100
  \end{equation}
  where the subscripts $t$ and $r$ stand for "true" and "retrieved," respectively;
  \item As an absolute error for the zero initial velocity (as it is not possible to divide by zero):\begin{equation}
    e_{\%}=|\dot{\psi}_{i,t}-\dot{\psi}_{i,r}|*100
  \end{equation}
\end{itemize}
Figures~\ref{velocity_1} and \ref{velocity_2} show the error for two configurations only, which are the best and worst working scenarios according to the linearization and approximation error (see Figures~\ref{linear_error_1} and \ref{approximation_error_1}).\\

\begin{figure}[h]
  \centering
  \subfloat{\includesvg[scale=0.35]{velpi2_1.svg}} \quad
  \subfloat{\includesvg[scale=0.35]{velpi6_1.svg}}\\
  \caption{Velocity error for Simulation 1.}
  \label{velocity_1}
\end{figure}
\begin{figure}[h]
  \centering
  \subfloat{\includesvg[scale=0.35]{velpi2_2.svg}} \quad
  \subfloat{\includesvg[scale=0.35]{velpi6_2.svg}}\\
  \caption{Velocity error for Simulation 2.}
  \label{velocity_2}
\end{figure}
\section{Results' Analysis}
Different methods have been explored, each one with its strengths and weaknesses. Here, some considerations on the aforeshown results are made:
\begin{itemize}
  \item The joints' decoupling approach allows one to obtain a closed-form equation and a simple time-dependent solution and can be used with different methods, such as the fitting ones or the position/derivative roots ones.\\
    On the other hand, they depend significantly on the VMS configuration, and the more the configuration allows displacements, the less near the new mass is from the actual one.
  \item Among the decoupling methods, the damping coefficient and natural frequency fit seems to be the best one, as it gives the higher values when $\hat{m}<m$.\\
    When $\hat{m}>m$, all the methods give better results: since the initial guessed mass is higher, the control is more aggressive, and the displacement after the impact is smaller, reducing the linearization error.
  \item The coupled methods give far more interesting results, as the final mass error is usually very small. The same consideration regarding the error linearization made above is valid. Hence, a higher initial mass is generally more preferable than a smaller one (i.e. an overestimation is preferable over an underestimation).
    Furthermore, these methods are less susceptible to the VMS configuration, allowing for more freedom in the satellite docking.
  \item The continuous method and the discrete one give similar results for a sufficiently high number of discretization points, even though we have already seen that less than ten points give already a better result than the other methods. Furthermore, the discrete method is faster: in Wolfram, on a MacBook Air M3 with 16 GB of RAM, the mean execution time of the continuous minimization of the cost function take approximately $\SI{1.5}{\second}$, while the minimization of the discrete cost function only $\SI{0.03}{\second}$, which is $\approx 50$ times faster.\\
    Hence, a discrete method is more suitable in an environment with no substantial computational power, as it could be in space.
  \item The velocity error is lower for mass overestimation too, and it is low for not too smaller initial guess as well.
\end{itemize}
\newpage
\section{Final Considerations}
In this thesis, a planar VMS has been modeled, starting with the kinematics, then the dynamics through both the classic Lagrangian approach and the homogeneous matrices method.\\
The impact analysis of a satellite docking has been explored, introducing assumptions on the joints' displacement during the impact and contact-point forces/moments. After having found a relation between the initial satellite's velocities and final VMS velocities, two scenarios have been studied: a rigid bodies ones, where the manipulator's arms were considered as perfectly rigid, and an elastic and more realistic one, where the arms were approximated as Euler-Bernoulli Beams. This introduces the stiffness matrix in the equations of motion and more degrees of freedom related to the elastic vibration. The number of DoFs depends on the number of modes considered.\\
For both scenarios, both free and control-based motion simulations have been performed, considering as intial conditions a still VMS and a slow relative velocity between the VMS and the payload, with almost null angular velocity (since in the real case a null relative velocity is preferable, even though that is never the case and a non-zero verlocity is always present.)\\
Regarding the control input, a feedback linearization was chosen along with a feed-forward term to account for the mass and Coriolis matrices. Furthermore, critically damped behaviors have been selected to have a smooth convergence.\\
Only the rigid rotational coordination has been controlled since the base's mass is far greater than the manipulator's arms and the satellite combined, so it can be considered as still, as the motion plots show. Moreover, the elastic coordinates for the elastic bodies scenario have been considered as uncontrollable noise and let free to evolve.\\
Finally, in the last chapters, we tried to solve the problem of the unknown satellite's mass and initial velocities. Different methods have been proposed, which can be gathered in two main approaches: an approximated one, where linearization, mass and approximation error have been considered and closed form solution could be found, thanks to the simplicity of the final equations; a coupled one, where only linearization and mass error were considered and more reliable solution have been found, with different strengths and weaknesses.\\
Regarding velocity retrieval, the theoretical relation between final and initial velocities from impact theory has been used.\\
The VMS's configuration plays an important role in these calculations since the linearization error is as much smaller as the displacement after the impact is small, which may not be the case for some configurations where the initial displacement is bigger than others'. This can be controlled by regulating the control proportional and derivative parameters. \\
However, for singular configurations, the joints do not move, and no method aforeshown can be used to retrieve the mass. Those configurations should be avoided in general since the system loses a degree of freedom, as already seen in Section~\ref{jacobian_matrix}.\\
The final results suggest that an overestimate of the satellite's mass is usually preferable over an underestimation and that discrete methods are to be chosen when a lack of computation power is present.
\subsection{Further Developments}
There is still a lot of room for improvements and deeper analysis, such as:
\begin{itemize}
  \item The chosen geometry is a planar (2D) RR manipulator. In the Chapter~\ref{overview}, real space manipulators are shown, and they are redundant, meaning that they have more joints than degrees of freedom. On one hand, this allows for more manoeuvrability, e.g. to have more options when moving the EE to be able to avoid obstacles, and that is the reason why they are designed in that way. On the other hand, this means more complex direct kinematics and, most importantly, a complex inverse kinematics since there are infinite solutions to realize one EE position. There are a lot of possible solutions, such as secondary tasks in the control law, which lies on the null-space of the EE and thus do not interfere with the main task, but allow to select, among the infinite solutions, the more appropriate one for he specific case. Other methods, such as the project gradient or the reduced gradient ones, can be inspected \cite{twentysix}.\\
    Furthermore, a 3D model would be preferable, but it would have increased even more the complexity of the calculation which, given the available software and the aim of the thesis (i.e. to find mass retrieval methods), would not have affected the result significantly.\\
    All of this has not been considered in this work, and an improvement like this would benefit a more realistic and implementable study case.
  \item The dynamics has been developed with a Lagrangian-based approach; however, a Newton-Euler algorithm could be faster and more useful in space.
  \item The satellite has been modeled as a disk, but in reality, satellites have different shapes and are usually not symmetric. A 3D real model of a medium-dimensions satellite would improve the study.
  \item In the elastic case, null rotation has been assumed to simplify the calculations: a more realistic model could be introduced. Furthermore, \cite{eighteen} simplifies the frequency equation by considering $M_{D_1}=0$ for $q_{2,0}=\pi/2$. There are more complex time-dependent frequency equations that can be studied to describe a more realistic case, as suggested by \cite{seventeen}.\\
    The arms have been modeled as Euler-Bernoulli beams, but a finite-element method could lead to better results \cite{fifteen}.
  \item Only plastic impact has been considered in this thesis, while in reality, a perfectly anelastic or elastic impact does not exist; a general non-plastic case lies between these two. A more realistic scenario has been analyzed in \cite{fourteen}, where two parameters are used to characterize the impact: the energy loss parameter and the friction parameter, which represent fractions of the loss of kinetic energy and friction impulse, respectively, of the plastic case.
  \item Closed form solution of the linearized joints' equation can be solved as a function of not only the unknown mass but also the initial joints' position, which is better for inspecting the relation between mass error and chosen configuration.
  \item Other control laws other than the feedback linearization can be implemented. A conservation of momenta during pre-impact and post-impact phases control law would allow not only to control the joints but also the base orientation: it is possible to transfer the whole angular momentum from the base toward the free-floating manipulator and in the same time reducing the joints' velocities \cite{twentythree}.\\
    In \cite{twentyfour}, an optimal control law is developed to bring the tumbling non-cooperative satellite to rest in minimum time while ensuring that the magnitude of the interaction torque between the manipulator and target remains below a prescribed value.\\
    Authors in \cite{twentyfive} present a combined prediction and motion-planning scheme for the robotic capturing of a drifting and tumbling object with unknown dynamics using visual feedback. A Kalman filter estimates the states and a set of dynamics parameters of the object needed for long-term prediction of the motion from noisy measurements of a vision system.
  \item The software used was Wolfram, which is very intuitive and free for students but lacks computational power and allows only for short and simple symbolic equations. Maple has been used in the final part to get a symbolic closed-form solution of the coupled second-order linearized equation of motions.\\
    This study would benefit from a more robust software with a built-in function for robotic simulations (working entirely on Maple or Simulink could be a solution).
\end{itemize}

\section{Acknowledgements}
An overview of space manipulators and their functionality has been studied. \\
I want to thank Professor Bortoluzzi for the proposed topic and the attention, availability, and help given during these months.\\
Thank you also to all my friends and family who always supported my choices and constantly reminded me that there is always a good opportunity to improve ourselves no matter how hard the path is.\\
With this work, I conclude my experience as a student. I close a huge chapter in my life, which began twenty years ago, and I am about to begin the next one.\\
A special thanks goes to God, who believed in me in the first place, guided me through all the difficult decisions and lonely moments, and showed me that, no matter what, "tribulation produces perseverance; perseverance, character; and character, hope. Now hope does not disappoint, because the love of God has been poured out in our hearts by the Holy Spirit who was given to us" (Rm 5, 3-5).\\
Consequently, thank you to my St. Peter's community for their friendship and affinity, which helped me change my ideas and always be open-minded.\\
Lastly, the University of Trento taught me so many lessons these years that it would take too long to list them all (as if this thesis were not already too long). Still, one thing that is for sure is that I learned to face problems I have never encountered before and to take the good from bad situations. I learned how to manage stress and future uncertainty, and I will bring all these soft skills in my upcoming working life with enthusiasm and curiosity.\\
As my grandfather always says, \textit{ad maiora!}
\newpage
\begin{appendices}
\chapter{Matrices}\label{appendix_matrices}
\pagestyle{plain} % Usa lo stile di default per i capitoli, senza header
\fancyhf{} % Cancella tutte le intestazioni e i piè di pagina
\renewcommand{\headrulewidth}{0pt} % Rimuove la linea orizzontale
The VMS mass and Coriolis matrices are listed.

\begin{tiny}
\begin{flalign*}
\clipbox*{0pt {-1.1\depth} {.44\width} {1.1\height}}{$
    \left(
\begin{array}{ccccc}
 \text{m1}+\text{m2}+\text{mb} & 0 & \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & -\frac{1}{2} \text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) \\
 0 & \text{m1}+\text{m2}+\text{mb} & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} \text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) \\
 \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{6} \left(2 \text{l1}^2 (\text{m1}+3 \text{m2})+6 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+2 \text{l2}^2 \text{m2}+3 \text{mb} r^2\right) & \frac{1}{3} \left(\text{l1}^2 (\text{m1}+3 \text{m2})+3 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+\text{l2}^2 \text{m2}\right) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) \\
 \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{3} \left(\text{l1}^2 (\text{m1}+3 \text{m2})+3 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+\text{l2}^2 \text{m2}\right) & \frac{1}{3} \left(\text{l1}^2 (\text{m1}+3 \text{m2})+3 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+\text{l2}^2 \text{m2}\right) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) \\
 -\frac{1}{2} \text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) & \frac{1}{2} \text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) & \frac{\text{l2}^2 \text{m2}}{3} \\
\end{array}
\right)$}\\
\clipbox*{{.44\width} {-1.1\depth} {.88\width} {1.1\height}}{$
    \left(
\begin{array}{ccccc}
 \text{m1}+\text{m2}+\text{mb} & 0 & \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & -\frac{1}{2} \text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) \\
 0 & \text{m1}+\text{m2}+\text{mb} & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} \text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) \\
 \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{6} \left(2 \text{l1}^2 (\text{m1}+3 \text{m2})+6 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+2 \text{l2}^2 \text{m2}+3 \text{mb} r^2\right) & \frac{1}{3} \left(\text{l1}^2 (\text{m1}+3 \text{m2})+3 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+\text{l2}^2 \text{m2}\right) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) \\
 \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{3} \left(\text{l1}^2 (\text{m1}+3 \text{m2})+3 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+\text{l2}^2 \text{m2}\right) & \frac{1}{3} \left(\text{l1}^2 (\text{m1}+3 \text{m2})+3 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+\text{l2}^2 \text{m2}\right) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) \\
 -\frac{1}{2} \text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) & \frac{1}{2} \text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) & \frac{\text{l2}^2 \text{m2}}{3} \\
\end{array}
\right)$}\\
\clipbox*{{.88\width} {-1.1\depth} {\width} {1.1\height}}{$
    \left(
\begin{array}{ccccc}
 \text{m1}+\text{m2}+\text{mb} & 0 & \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & -\frac{1}{2} \text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) \\
 0 & \text{m1}+\text{m2}+\text{mb} & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} \text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) \\
 \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{6} \left(2 \text{l1}^2 (\text{m1}+3 \text{m2})+6 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+2 \text{l2}^2 \text{m2}+3 \text{mb} r^2\right) & \frac{1}{3} \left(\text{l1}^2 (\text{m1}+3 \text{m2})+3 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+\text{l2}^2 \text{m2}\right) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) \\
 \frac{1}{2} (-\text{l1} (\text{m1}+2 \text{m2}) \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{2} (\text{l1} (\text{m1}+2 \text{m2}) \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t))) & \frac{1}{3} \left(\text{l1}^2 (\text{m1}+3 \text{m2})+3 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+\text{l2}^2 \text{m2}\right) & \frac{1}{3} \left(\text{l1}^2 (\text{m1}+3 \text{m2})+3 \text{l1} \text{l2} \text{m2} \cos (\text{q2}(t))+\text{l2}^2 \text{m2}\right) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) \\
 -\frac{1}{2} \text{l2} \text{m2} \sin (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) & \frac{1}{2} \text{l2} \text{m2} \cos (\text{q1}(t)+\text{q2}(t)+\text{$\theta $0}(t)) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) & \frac{1}{6} \text{l2} \text{m2} (3 \text{l1} \cos (\text{q2}(t))+2 \text{l2}) & \frac{\text{l2}^2 \text{m2}}{3} \\
\end{array}
\right)$}
\end{flalign*}
\end{tiny}
\begin{sidewaysfigure}
  \begin{tiny}
  \clipbox*{0pt {-1.1\depth} {\width} {1.1\height}}{$\left(
    \begin{array}{c}
     \frac{1}{2} \left(-\text{l1} (\text{m1}+2 \text{m2}) \left(\text{q1}'(t)+\text{$\theta $0}'(t)\right)^2 \cos (\text{q1}(t)+\text{$\theta $0}(t))+\text{l2} \text{m2} \sin (\text{q2}(t)) \sin (\text{q1}(t)+\text{$\theta $0}(t)) \left(\text{q1}'(t)+\text{q2}'(t)+\text{$\theta $0}'(t)\right)^2-\text{l2} \text{m2} \cos (\text{q2}(t)) \cos (\text{q1}(t)+\text{$\theta $0}(t)) \left(\text{q1}'(t)+\text{q2}'(t)+\text{$\theta $0}'(t)\right)^2\right) \\
     \frac{1}{2} \left(-\text{l1} (\text{m1}+2 \text{m2}) \left(\text{q1}'(t)+\text{$\theta $0}'(t)\right)^2 \sin (\text{q1}(t)+\text{$\theta $0}(t))-\text{l2} \text{m2} \sin (\text{q2}(t)) \cos (\text{q1}(t)+\text{$\theta $0}(t)) \left(\text{q1}'(t)+\text{q2}'(t)+\text{$\theta $0}'(t)\right)^2-\text{l2} \text{m2} \cos (\text{q2}(t)) \sin (\text{q1}(t)+\text{$\theta $0}(t)) \left(\text{q1}'(t)+\text{q2}'(t)+\text{$\theta $0}'(t)\right)^2\right) \\
     -\frac{1}{2} \text{l1} \text{l2} \text{m2} \text{q2}'(t) \sin (\text{q2}(t)) \left(2 \text{q1}'(t)+\text{q2}'(t)+2 \text{$\theta $0}'(t)\right) \\
     -\frac{1}{2} \text{l1} \text{l2} \text{m2} \text{q2}'(t) \sin (\text{q2}(t)) \left(2 \text{q1}'(t)+\text{q2}'(t)+2 \text{$\theta $0}'(t)\right) \\
     \frac{1}{2} \text{l1} \text{l2} \text{m2} \sin (\text{q2}(t)) \left(\text{q1}'(t)+\text{$\theta $0}'(t)\right)^2 \\
    \end{array}
    \right)$}
  \end{tiny}
\end{sidewaysfigure}
\chapter{Code}\label{code}
Taylor expansion used to linearized the joints' equation of motions:
\begin{small}
\begin{verbatim}
  series[f_,v_,v_0,_order]:=Module[{e},Expand[Normal[Series[f/.Thread[v->v0+e*v],
  {e,0,order}]]/.e->1]]
\end{verbatim}
\end{small}
Cost function for the continous coupled method:
\begin{small}
\begin{verbatim}
  errorFunction[q_, data_] := NIntegrate[(q - data)^2, {t, 0, 10}]
\end{verbatim}
\end{small}
Cost function for the discrete coupled method:
\begin{small}
  \begin{verbatim}
  FindMinimum[Sum[(DiscreteSol11[[k]] - DiscreteData11[[k]])^2, {k, 0, NP}],
   {mO,test}]
  \end{verbatim}
  \end{small}
Maple code for copuled equations solution:
\begin{small}
  \begin{verbatim}
    dsolve(eqns union {q1(0)=q__10,q2(0)=q__20,D(q1)(0)=vq__10,D(q2)(0)=vq__20},
    {q1(t),q2(t)},method=laplace) assuming mO>0:
  \end{verbatim}
  \end{small}
Coupled linearized joints' equations:
\begin{small}
  \begin{verbatim}
  (3124.81 + 30.3704*mO)*diff(diff(q1(t), t), t) + (3124.81 + 30.3704*mO)*
  *diff(diff(q2(t), t), t) - 171878.0000 + 109421.0000*q1(t) + 109421.0000*q2(t) +
  + 218733.0000*diff(q1(t), t) + 218733.0000*diff(q2(t), t);
  (15624.1 + 61.6185*mO)*diff(diff(q1(t), t), t) + (3124.81 + 30.3704*mO)*
  *diff(diff(q2(t), t), t) - 171878.0000 + 231289.0000*q1(t) + 109421.0000*q2(t) + 
  + 462346.0000*diff(q1(t), t) + 218733.0000*diff(q2(t), t)
  \end{verbatim}
  \end{small}
Given the following force matrix $\phi$ and velocity matrix $W$:
\begin{equation}
  \phi=\begin{bmatrix}
    0&-c_z&c_y&f_x\\
    c_z&0&-c_x&f_y\\
    -c_y&c_x&0&f_z\\
    -f_x&-f_y&-f_z&0
  \end{bmatrix} \quad W=\begin{bmatrix}
    0&-\omega_z&\omega_y&v_x\\
    \omega_z&0&-\omega_x&v_y\\
    -\omega_y&\omega_x&0&v_z\\
    -v_x&-v_y&-v_z&0
  \end{bmatrix}
\end{equation}
the \textit{pseudo-scalar product} (i.e. the power developed by the actions included in $\phi$ as the object moves according to the velocities described by $W$) is defined as:
\begin{equation}
  P=\phi\otimes W=c_x\omega_x+c_y\omega_y+c_z\omega_z+f_xv_x+f_yv_y+f_zv_z
  \label{pseudo_scalar}
\end{equation}
In Wolfram this has been written as a function:
\begin{small}
  \begin{verbatim}
    actionMatrix[cx_, cy_, cz_, fx_, fy_,fz_] := {{0, -cz, cy, fx},
     {cz, 0, -cx, fy}, {-cy, cx, 0, fz}, {-fx, -fy, -fz, 0}}
  \end{verbatim}
\end{small}
Solution of the coupled joints’ equations obtained with Maple (next pages).
    \begin{sidewaysfigure}
    \begin{scriptsize}
    \begin{equation}
      \begin{split}
      \mathit{q1} \! \left(t \right)=&\frac{312481 \left(\frac{1218065000 \sinh \left(\frac{200 t \sqrt{33283899921325-9520358627 \mathit{mO}}}{312481 \mathit{mO} +124992900}\right)}{312481 \sqrt{33283899921325-9520358627 \mathit{mO}}}+\frac{200 \cosh \left(\frac{200 t \sqrt{33283899921325-9520358627 \mathit{mO}}}{312481 \mathit{mO} +124992900}\right)}{312481}\right) {\mathrm e}^{-\frac{1218065000 t}{312481 \mathit{mO} +124992900}} q_{\mathit{10}}}{200}\\
      &+\frac{312481 \sinh \! \left(\frac{200 t \sqrt{33283899921325-9520358627 \mathit{mO}}}{312481 \mathit{mO} +124992900}\right) \left(\mathit{mO} +\frac{124992900}{312481}\right) {\mathrm e}^{-\frac{1218065000 t}{312481 \mathit{mO} +124992900}} \mathit{vq}_{\mathit{10}}}{200 \sqrt{33283899921325-9520358627 \mathit{mO}}}
      \end{split}
      \label{maple_q1}
    \end{equation}
  \end{scriptsize}
\end{sidewaysfigure}
      \begin{sidewaysfigure}
        \begin{tiny}
        \begin{equation}
        \begin{split}
          \mathit{q2}\! \left(t\right)=&\frac{171878}{109421}-q_{\mathit{10}} {\mathrm e}^{-\frac{1218065000 t}{312481 \mathit{mO}+124992900}} \cosh\! \left(\frac{200 t \sqrt{33283899921325-9520358627 \mathit{mO}}}{312481 \mathit{mO}+124992900}\right)\\
          &+\frac{1}{25 \sqrt{29047778718100-8307898846 \mathit{mO}}}37963 \sinh\! \left(\frac{50 t \sqrt{29047778718100-8307898846 \mathit{mO}}}{75926 \mathit{mO}+7812025}\right) \left(\left(\mathit{vq}_{\mathit{10}}+\mathit{vq}_{\mathit{20}}\right) \mathit{mO}+\frac{136708125 q_{\mathit{10}}}{37963}+\frac{136708125 q_{\mathit{20}}}{37963}+\frac{7812025 \mathit{vq}_{\mathit{10}}}{75926}+\frac{7812025 \mathit{vq}_{\mathit{20}}}{75926}-\frac{23497119108750}{4153949423}\right) {\mathrm e}^{-\frac{273416250 t}{75926 \mathit{mO}+7812025}}\\
          &+\frac{\left(\left(-312481 \mathit{mO}-124992900\right) \mathit{vq}_{\mathit{10}}-1218065000 q_{\mathit{10}}\right) {\mathrm e}^{-\frac{1218065000 t}{312481 \mathit{mO}+124992900}} \sinh\! \left(\frac{200 t \sqrt{33283899921325-9520358627 \mathit{mO}}}{312481 \mathit{mO}+124992900}\right)}{200 \sqrt{33283899921325-9520358627 \mathit{mO}}}+\frac{\cosh\! \left(\frac{50 t \sqrt{29047778718100-8307898846 \mathit{mO}}}{75926 \mathit{mO}+7812025}\right) {\mathrm e}^{-\frac{273416250 t}{75926 \mathit{mO}+7812025}} \left(109421 q_{\mathit{10}}+109421 q_{\mathit{20}}-171878\right)}{109421}
        \end{split}
        \label{maple_q2}
      \end{equation}
    \end{tiny}
    \end{sidewaysfigure}
\chapter{Plots}\label{appendix_plots}
Here, the same plots of Section~\ref{mass_retrieval} al listed for Simulation 2 (i.e. when the satellite approaches with a non-zero vertical velocity and zero horizontal velocity with north-to-south direction).
\begin{figure}[h]
  \centering
  \subfloat[\emph{$q_{2,0}=\SI{0}{\radian}$}]{\includesvg[scale=0.35]{lin_err2_0.svg}} \quad
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/6}{\radian}$}]{\includesvg[scale=0.35]{lin_err2_pi6.svg}}\\
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/4}{\radian}$}]{\includesvg[scale=0.35]{lin_err2_pi4.svg}}\quad
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/3}{\radian}$}]{\includesvg[scale=0.35]{lin_err2_pi3.svg}}\\
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/2}{\radian}$}]{\includesvg[scale=0.35]{lin_err2_pi2.svg}}
  \caption{Linearization error for different first arm's configuration, Simulation 2: non-linear solution in blue, linearized solution in orange, with $\hat{m}=\SI{2000}{\kilogram}$.}
  \label{linear_error_2}
\end{figure}
\begin{figure}[!h]
  \centering
  \subfloat[\emph{$q_{2,0}=\SI{0}{\radian}$}]{\includesvg[scale=0.35]{approximation2_0.svg}} \quad
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/6}{\radian}$}]{\includesvg[scale=0.35]{approximation2_pi6.svg}}\\
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/4}{\radian}$}]{\includesvg[scale=0.35]{approximation2_pi4.svg}}\quad
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/3}{\radian}$}]{\includesvg[scale=0.35]{approximation2_pi3.svg}}\\
  \subfloat[\emph{$q_{2,0}=\SI[parse-numbers = false]{\pi/2}{\radian}$}]{\includesvg[scale=0.35]{approximation2_pi2.svg}}
  \caption{Approximation error for different first arm's configuration, Simulation 2: non-approximated linearized solution in orange, approximated solution in blue, with $\hat{m}=\SI{2000}{\kilogram}$.}
  \label{approximation_error_2}
\end{figure}
\begin{figure}[h!]
  \centering
  \includesvg[scale=0.4]{massespi6_2.svg}
  \caption{}
  \label{q262}
\end{figure}
\begin{figure}[h!]
  \centering
  \includesvg[scale=0.4]{massespi4_2.svg}
  \caption{}
  \label{q242}
\end{figure}
\begin{figure}[h!]
  \centering
  \includesvg[scale=0.4]{massespi3_2.svg}
  \caption{}
  \label{q232}
\end{figure}
\begin{figure}[h!]
  \centering
  \includesvg[scale=0.4]{massespi2_2.svg}
  \caption{}
  \label{q222}
\end{figure}
\end{appendices}
\pagestyle{plain} % Usa lo stile di default per i capitoli, senza header
\fancyhf{} % Cancella tutte le intestazioni e i piè di pagina
\renewcommand{\headrulewidth}{0pt} % Rimuove la linea orizzontale
\nocite{*}
\bibliography{biblio}{}
\bibliographystyle{ieeetr}
\end{document}
